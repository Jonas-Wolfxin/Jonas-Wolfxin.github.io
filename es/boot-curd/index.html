<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ElasticSearch - å¤šæ¡†æ¶é›†æˆ | Jonas Wolfxin Blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <script>var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?267c5680c2ffb468ca29c45ffe6801da"; 
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
          </script>
    <meta name="description" content="Jonas Wolfxinä¸ªäººåšå®¢, VuePressæ­å»º, ä½¿ç”¨äº† Vdoing ä¸»é¢˜, å­¦ä¹ Java, Web, æ¡†æ¶, å¾®æœåŠ¡, å·¥å…·, å‰ç«¯ç­‰ç›¸å…³çŸ¥è¯†, è®°å½•ç”Ÿæ´»å’ŒæŠ€æœ¯è·¯ç¨‹, åŒæ—¶åˆ†äº«ç¼–ç¨‹æŠ€å·§ã€‚">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="Jonas Wolfxinä¸ªäººåšå®¢, VuePressæ­å»º, å­¦ä¹ Javaã€Webã€æ¡†æ¶ã€å¾®æœåŠ¡ã€å·¥å…·ã€å‰ç«¯ç­‰ç›¸å…³çŸ¥è¯†, è®°å½•ç”Ÿæ´»å’ŒæŠ€æœ¯è·¯ç¨‹ã€‚">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.7d3fc896.css" as="style"><link rel="preload" href="/assets/js/app.d858ddbb.js" as="script"><link rel="preload" href="/assets/js/2.309e711a.js" as="script"><link rel="preload" href="/assets/js/102.d5a6dfd2.js" as="script"><link rel="preload" href="/assets/js/16.acd3428d.js" as="script"><link rel="preload" href="/assets/js/8.5b4b6c67.js" as="script"><link rel="preload" href="/assets/js/10.58f97cc7.js" as="script"><link rel="preload" href="/assets/js/17.0b7a5267.js" as="script"><link rel="prefetch" href="/assets/js/100.a245150c.js"><link rel="prefetch" href="/assets/js/101.dc21b366.js"><link rel="prefetch" href="/assets/js/103.7675e438.js"><link rel="prefetch" href="/assets/js/104.08bff44e.js"><link rel="prefetch" href="/assets/js/105.8bf552ad.js"><link rel="prefetch" href="/assets/js/106.b3388dcc.js"><link rel="prefetch" href="/assets/js/107.708d16a8.js"><link rel="prefetch" href="/assets/js/108.8d67c3a1.js"><link rel="prefetch" href="/assets/js/109.adb072ef.js"><link rel="prefetch" href="/assets/js/11.1cff9f55.js"><link rel="prefetch" href="/assets/js/110.6a33e945.js"><link rel="prefetch" href="/assets/js/111.5b6daef7.js"><link rel="prefetch" href="/assets/js/112.30fa856b.js"><link rel="prefetch" href="/assets/js/113.2bea19a6.js"><link rel="prefetch" href="/assets/js/114.78693b98.js"><link rel="prefetch" href="/assets/js/115.24b2f36f.js"><link rel="prefetch" href="/assets/js/116.121c60d7.js"><link rel="prefetch" href="/assets/js/117.c2a343f1.js"><link rel="prefetch" href="/assets/js/118.4f472067.js"><link rel="prefetch" href="/assets/js/119.24255046.js"><link rel="prefetch" href="/assets/js/12.bca3c221.js"><link rel="prefetch" href="/assets/js/120.c049d4ee.js"><link rel="prefetch" href="/assets/js/121.27c7097d.js"><link rel="prefetch" href="/assets/js/122.89ae0c7e.js"><link rel="prefetch" href="/assets/js/123.92ff168d.js"><link rel="prefetch" href="/assets/js/124.42567e10.js"><link rel="prefetch" href="/assets/js/125.3bd92459.js"><link rel="prefetch" href="/assets/js/126.ce3b5ff1.js"><link rel="prefetch" href="/assets/js/127.62073e16.js"><link rel="prefetch" href="/assets/js/128.1e61e62d.js"><link rel="prefetch" href="/assets/js/129.1abfd9a0.js"><link rel="prefetch" href="/assets/js/13.fd509ce7.js"><link rel="prefetch" href="/assets/js/130.fd10656f.js"><link rel="prefetch" href="/assets/js/131.739a70c7.js"><link rel="prefetch" href="/assets/js/132.aead2e49.js"><link rel="prefetch" href="/assets/js/133.c996494c.js"><link rel="prefetch" href="/assets/js/134.3f032f05.js"><link rel="prefetch" href="/assets/js/135.c35c5612.js"><link rel="prefetch" href="/assets/js/136.b1a52d43.js"><link rel="prefetch" href="/assets/js/137.f6c998f0.js"><link rel="prefetch" href="/assets/js/138.5165a511.js"><link rel="prefetch" href="/assets/js/139.84e0898b.js"><link rel="prefetch" href="/assets/js/14.9a0c9450.js"><link rel="prefetch" href="/assets/js/140.f85c3c58.js"><link rel="prefetch" href="/assets/js/141.1b18b352.js"><link rel="prefetch" href="/assets/js/142.61b694c2.js"><link rel="prefetch" href="/assets/js/143.ca56fc45.js"><link rel="prefetch" href="/assets/js/144.634fc96a.js"><link rel="prefetch" href="/assets/js/145.7db28ded.js"><link rel="prefetch" href="/assets/js/146.0e801c74.js"><link rel="prefetch" href="/assets/js/147.26faa263.js"><link rel="prefetch" href="/assets/js/148.927832d5.js"><link rel="prefetch" href="/assets/js/149.8755eb42.js"><link rel="prefetch" href="/assets/js/15.d3755cc5.js"><link rel="prefetch" href="/assets/js/150.906609e5.js"><link rel="prefetch" href="/assets/js/151.7a52439b.js"><link rel="prefetch" href="/assets/js/152.c822b1fb.js"><link rel="prefetch" href="/assets/js/153.593575cc.js"><link rel="prefetch" href="/assets/js/154.2a16d8e7.js"><link rel="prefetch" href="/assets/js/155.6a18c733.js"><link rel="prefetch" href="/assets/js/156.bb65d909.js"><link rel="prefetch" href="/assets/js/157.862f6419.js"><link rel="prefetch" href="/assets/js/158.db76ed26.js"><link rel="prefetch" href="/assets/js/159.0f0b1ee8.js"><link rel="prefetch" href="/assets/js/160.8f421d08.js"><link rel="prefetch" href="/assets/js/161.4a521888.js"><link rel="prefetch" href="/assets/js/162.601dbfca.js"><link rel="prefetch" href="/assets/js/163.d76b166d.js"><link rel="prefetch" href="/assets/js/164.99b00d17.js"><link rel="prefetch" href="/assets/js/165.7809f82c.js"><link rel="prefetch" href="/assets/js/166.b29e508c.js"><link rel="prefetch" href="/assets/js/167.71af6bb1.js"><link rel="prefetch" href="/assets/js/168.aad10cfc.js"><link rel="prefetch" href="/assets/js/169.d807fd76.js"><link rel="prefetch" href="/assets/js/170.8cd1462a.js"><link rel="prefetch" href="/assets/js/171.ecbf63cf.js"><link rel="prefetch" href="/assets/js/172.e75cd345.js"><link rel="prefetch" href="/assets/js/173.1ab612d0.js"><link rel="prefetch" href="/assets/js/174.2366c5d2.js"><link rel="prefetch" href="/assets/js/175.50c5731b.js"><link rel="prefetch" href="/assets/js/176.ac8ad112.js"><link rel="prefetch" href="/assets/js/177.1abcf5d4.js"><link rel="prefetch" href="/assets/js/178.b937dacc.js"><link rel="prefetch" href="/assets/js/179.b6fa0b6d.js"><link rel="prefetch" href="/assets/js/18.64b7e666.js"><link rel="prefetch" href="/assets/js/180.e4a8bc36.js"><link rel="prefetch" href="/assets/js/181.b916da57.js"><link rel="prefetch" href="/assets/js/182.27a2bdb4.js"><link rel="prefetch" href="/assets/js/183.dcb4d635.js"><link rel="prefetch" href="/assets/js/184.820c8f5f.js"><link rel="prefetch" href="/assets/js/185.6654f558.js"><link rel="prefetch" href="/assets/js/186.2749179c.js"><link rel="prefetch" href="/assets/js/187.a301fd95.js"><link rel="prefetch" href="/assets/js/188.3a9e3226.js"><link rel="prefetch" href="/assets/js/189.5f2b0e83.js"><link rel="prefetch" href="/assets/js/19.7a102d25.js"><link rel="prefetch" href="/assets/js/190.76dc6e42.js"><link rel="prefetch" href="/assets/js/191.b6c01ef6.js"><link rel="prefetch" href="/assets/js/192.bd87e976.js"><link rel="prefetch" href="/assets/js/193.e3b20021.js"><link rel="prefetch" href="/assets/js/194.d83d205c.js"><link rel="prefetch" href="/assets/js/195.e53e330d.js"><link rel="prefetch" href="/assets/js/196.1fd35397.js"><link rel="prefetch" href="/assets/js/197.cb0858f8.js"><link rel="prefetch" href="/assets/js/198.651004c0.js"><link rel="prefetch" href="/assets/js/199.4a4a16ae.js"><link rel="prefetch" href="/assets/js/20.2e6fe8d4.js"><link rel="prefetch" href="/assets/js/200.0347a232.js"><link rel="prefetch" href="/assets/js/201.77c9f572.js"><link rel="prefetch" href="/assets/js/202.6f66fc82.js"><link rel="prefetch" href="/assets/js/203.c12f2fd1.js"><link rel="prefetch" href="/assets/js/204.0b74eb4e.js"><link rel="prefetch" href="/assets/js/205.82129b16.js"><link rel="prefetch" href="/assets/js/206.0240cea0.js"><link rel="prefetch" href="/assets/js/207.d2d2dd99.js"><link rel="prefetch" href="/assets/js/208.f1073a08.js"><link rel="prefetch" href="/assets/js/209.3b1e4cbe.js"><link rel="prefetch" href="/assets/js/21.179bedf0.js"><link rel="prefetch" href="/assets/js/210.b8b67413.js"><link rel="prefetch" href="/assets/js/211.455c8e40.js"><link rel="prefetch" href="/assets/js/212.8735e669.js"><link rel="prefetch" href="/assets/js/213.f77fefc5.js"><link rel="prefetch" href="/assets/js/214.97d827be.js"><link rel="prefetch" href="/assets/js/215.bc08fe35.js"><link rel="prefetch" href="/assets/js/216.fa811698.js"><link rel="prefetch" href="/assets/js/217.b965b7c6.js"><link rel="prefetch" href="/assets/js/218.6a91db8b.js"><link rel="prefetch" href="/assets/js/219.fb3d8166.js"><link rel="prefetch" href="/assets/js/22.8268ce6e.js"><link rel="prefetch" href="/assets/js/220.1577cda2.js"><link rel="prefetch" href="/assets/js/221.ceea7cea.js"><link rel="prefetch" href="/assets/js/222.3985b121.js"><link rel="prefetch" href="/assets/js/223.40f0edd0.js"><link rel="prefetch" href="/assets/js/224.bcdfffa8.js"><link rel="prefetch" href="/assets/js/225.13252b88.js"><link rel="prefetch" href="/assets/js/226.2afd6de5.js"><link rel="prefetch" href="/assets/js/227.39e5b8f1.js"><link rel="prefetch" href="/assets/js/228.f24cb5b5.js"><link rel="prefetch" href="/assets/js/229.582f76a9.js"><link rel="prefetch" href="/assets/js/23.3b76f2ef.js"><link rel="prefetch" href="/assets/js/230.50a93474.js"><link rel="prefetch" href="/assets/js/231.063e02af.js"><link rel="prefetch" href="/assets/js/232.08153e5d.js"><link rel="prefetch" href="/assets/js/233.e8a2f480.js"><link rel="prefetch" href="/assets/js/234.4e784ee0.js"><link rel="prefetch" href="/assets/js/235.fe1262b2.js"><link rel="prefetch" href="/assets/js/236.5b6a52cf.js"><link rel="prefetch" href="/assets/js/237.36fae37d.js"><link rel="prefetch" href="/assets/js/238.7369ac7a.js"><link rel="prefetch" href="/assets/js/239.7fff287f.js"><link rel="prefetch" href="/assets/js/24.7c6b119c.js"><link rel="prefetch" href="/assets/js/240.96b67d8a.js"><link rel="prefetch" href="/assets/js/241.6cca43be.js"><link rel="prefetch" href="/assets/js/242.063840f3.js"><link rel="prefetch" href="/assets/js/243.e25e2acc.js"><link rel="prefetch" href="/assets/js/244.6058b76a.js"><link rel="prefetch" href="/assets/js/245.cab0cb5f.js"><link rel="prefetch" href="/assets/js/246.38dba8a1.js"><link rel="prefetch" href="/assets/js/247.58a45597.js"><link rel="prefetch" href="/assets/js/248.5cf1ad4c.js"><link rel="prefetch" href="/assets/js/249.691356bb.js"><link rel="prefetch" href="/assets/js/25.02fab98f.js"><link rel="prefetch" href="/assets/js/250.e2c83a35.js"><link rel="prefetch" href="/assets/js/251.80aa06df.js"><link rel="prefetch" href="/assets/js/252.a3e269d1.js"><link rel="prefetch" href="/assets/js/253.d11f6725.js"><link rel="prefetch" href="/assets/js/26.76ffb425.js"><link rel="prefetch" href="/assets/js/27.ce24313c.js"><link rel="prefetch" href="/assets/js/28.d8dbc96b.js"><link rel="prefetch" href="/assets/js/29.2b3bed04.js"><link rel="prefetch" href="/assets/js/3.d6952836.js"><link rel="prefetch" href="/assets/js/30.26988c7b.js"><link rel="prefetch" href="/assets/js/31.cc5781e4.js"><link rel="prefetch" href="/assets/js/32.80d8b83b.js"><link rel="prefetch" href="/assets/js/33.d97c7068.js"><link rel="prefetch" href="/assets/js/34.962f9100.js"><link rel="prefetch" href="/assets/js/35.23d8a044.js"><link rel="prefetch" href="/assets/js/36.6d349d82.js"><link rel="prefetch" href="/assets/js/37.b08f29c8.js"><link rel="prefetch" href="/assets/js/38.8b2bd27d.js"><link rel="prefetch" href="/assets/js/39.45a0b016.js"><link rel="prefetch" href="/assets/js/4.8b22777d.js"><link rel="prefetch" href="/assets/js/40.e6f6cb43.js"><link rel="prefetch" href="/assets/js/41.c756e119.js"><link rel="prefetch" href="/assets/js/42.bbc17b0f.js"><link rel="prefetch" href="/assets/js/43.8e0ce4ca.js"><link rel="prefetch" href="/assets/js/44.b91517af.js"><link rel="prefetch" href="/assets/js/45.416dfe4d.js"><link rel="prefetch" href="/assets/js/46.c00eeb87.js"><link rel="prefetch" href="/assets/js/47.29d200b3.js"><link rel="prefetch" href="/assets/js/48.7f066ab6.js"><link rel="prefetch" href="/assets/js/49.0e010fee.js"><link rel="prefetch" href="/assets/js/5.e6781b57.js"><link rel="prefetch" href="/assets/js/50.1bb477d0.js"><link rel="prefetch" href="/assets/js/51.66468406.js"><link rel="prefetch" href="/assets/js/52.5cf7fbd0.js"><link rel="prefetch" href="/assets/js/53.d6f04354.js"><link rel="prefetch" href="/assets/js/54.59ca865c.js"><link rel="prefetch" href="/assets/js/55.fb0ad69c.js"><link rel="prefetch" href="/assets/js/56.c47a2d12.js"><link rel="prefetch" href="/assets/js/57.f5d65bb3.js"><link rel="prefetch" href="/assets/js/58.c5761ef2.js"><link rel="prefetch" href="/assets/js/59.9fe56073.js"><link rel="prefetch" href="/assets/js/6.9b07e200.js"><link rel="prefetch" href="/assets/js/60.ee1a5c93.js"><link rel="prefetch" href="/assets/js/61.ed5a91fd.js"><link rel="prefetch" href="/assets/js/62.4c69d23d.js"><link rel="prefetch" href="/assets/js/63.a396c29b.js"><link rel="prefetch" href="/assets/js/64.6f39dd9c.js"><link rel="prefetch" href="/assets/js/65.4cb24e13.js"><link rel="prefetch" href="/assets/js/66.aad4aa20.js"><link rel="prefetch" href="/assets/js/67.36e86f95.js"><link rel="prefetch" href="/assets/js/68.cbcfb2e0.js"><link rel="prefetch" href="/assets/js/69.8f5b0c08.js"><link rel="prefetch" href="/assets/js/7.4d64b8e6.js"><link rel="prefetch" href="/assets/js/70.1e7d144f.js"><link rel="prefetch" href="/assets/js/71.77fb0b43.js"><link rel="prefetch" href="/assets/js/72.bf3bb5b9.js"><link rel="prefetch" href="/assets/js/73.e059a41d.js"><link rel="prefetch" href="/assets/js/74.cae09eb3.js"><link rel="prefetch" href="/assets/js/75.f89a6d2e.js"><link rel="prefetch" href="/assets/js/76.cfb3df08.js"><link rel="prefetch" href="/assets/js/77.f4fa62e6.js"><link rel="prefetch" href="/assets/js/78.464e83f6.js"><link rel="prefetch" href="/assets/js/79.71895252.js"><link rel="prefetch" href="/assets/js/80.58d501fe.js"><link rel="prefetch" href="/assets/js/81.948adca1.js"><link rel="prefetch" href="/assets/js/82.bfd7ff16.js"><link rel="prefetch" href="/assets/js/83.3920a558.js"><link rel="prefetch" href="/assets/js/84.d5b9372a.js"><link rel="prefetch" href="/assets/js/85.3be0afac.js"><link rel="prefetch" href="/assets/js/86.29f7272d.js"><link rel="prefetch" href="/assets/js/87.93a0bc8e.js"><link rel="prefetch" href="/assets/js/88.5be81cc2.js"><link rel="prefetch" href="/assets/js/89.bc9cad5d.js"><link rel="prefetch" href="/assets/js/9.dc7a3982.js"><link rel="prefetch" href="/assets/js/90.5ba7972c.js"><link rel="prefetch" href="/assets/js/91.6ca92166.js"><link rel="prefetch" href="/assets/js/92.cb997f9f.js"><link rel="prefetch" href="/assets/js/93.941f52c6.js"><link rel="prefetch" href="/assets/js/94.c34116e0.js"><link rel="prefetch" href="/assets/js/95.0aa6895c.js"><link rel="prefetch" href="/assets/js/96.fd230ec0.js"><link rel="prefetch" href="/assets/js/97.375c63c2.js"><link rel="prefetch" href="/assets/js/98.5f4889ea.js"><link rel="prefetch" href="/assets/js/99.476bd54f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7d3fc896.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/index/logo.png" alt="Jonas Wolfxin Blog" class="logo"> <span class="site-name can-hide">Jonas Wolfxin Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HomeğŸ </a></div><div class="nav-item"><a href="/navigation/" class="nav-link">NavigationğŸ§­</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><a href="/front/" class="link-title">Front End</a> <span class="title" style="display:none;">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Basics</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/javascript/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>Frame</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database" class="dropdown-title"><a href="/database/" class="link-title">Database</a> <span class="title" style="display:none;">Database</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/postgresql/" class="nav-link">PostgreSQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/es/" class="nav-link router-link-active">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/pythonstrdy/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_basics/" class="nav-link">Python Basics</a></li><li class="dropdown-item"><!----> <a href="/python_advanced/" class="nav-link">Python Advanced</a></li><li class="dropdown-item"><!----> <a href="/python_projects/" class="nav-link">Python Projects</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç½‘ç»œè¿ç»´" class="dropdown-title"><a href="/tool/" class="link-title">ç½‘ç»œè¿ç»´</a> <span class="title" style="display:none;">ç½‘ç»œè¿ç»´</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>CCNA</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/91ab17/" class="nav-link">CCNAçŸ¥è¯†</a></li><li class="dropdown-subitem"><a href="/pages/55766c/" class="nav-link">CCNAé¢˜åº“</a></li><li class="dropdown-subitem"><a href="/pages/f61749/" class="nav-link">Cisco NetAca</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/4f0673/" class="nav-link">Ansible</a></li><li class="dropdown-item"><h4>ç‰ˆæœ¬ç®¡ç†</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>éƒ¨ç½²</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><a href="/archives/" class="link-title">About</a> <span class="title" style="display:none;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>This Blog</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">Archives</a></li></ul></li><li class="dropdown-item"><h4>About Me</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">Collection</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">Introduction</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ˜Ÿæ²³ä¸‡é‡Œ" class="dropdown-title"><a href="/inGermany/" class="link-title">æ˜Ÿæ²³ä¸‡é‡Œ</a> <span class="title" style="display:none;">æ˜Ÿæ²³ä¸‡é‡Œ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å¾·å›½é©¾ç…§Bçº§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8a9dd0/" class="nav-link">ç†è®ºå‡†å¤‡</a></li><li class="dropdown-subitem"><a href="/pages/b79ef5/" class="nav-link">å®è·µå‡†å¤‡</a></li></ul></li><li class="dropdown-item"><h4>æ˜Ÿæ²³ä¸‡é‡Œ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf060/" class="nav-link">Vimæ“ä½œ</a></li><li class="dropdown-subitem"><a href="/pages/c11fcf/" class="nav-link">Gitemoji</a></li><li class="dropdown-subitem"><a href="/pages/055f2e/" class="nav-link">æ— å¦„ç»</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/message-board/" class="nav-link">MessageBoardğŸ“‹</a></div> <a href="https://github.com/Jonas-Wolfxin/Jonas-Wolfxin.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/202206092309359.png"> <div class="blogger-info"><h3>Jonas æ—é£</h3> <span>å¾å¿—æ‰€å‘ï¼Œä¸‡å¤«ä¸å½“ï¼›æŠ«è†æ–©æ£˜ï¼Œå¥‹è€Œç»§å¾€ã€‚</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HomeğŸ </a></div><div class="nav-item"><a href="/navigation/" class="nav-link">NavigationğŸ§­</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><a href="/front/" class="link-title">Front End</a> <span class="title" style="display:none;">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Basics</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/javascript/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>Frame</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database" class="dropdown-title"><a href="/database/" class="link-title">Database</a> <span class="title" style="display:none;">Database</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/postgresql/" class="nav-link">PostgreSQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/es/" class="nav-link router-link-active">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/pythonstrdy/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_basics/" class="nav-link">Python Basics</a></li><li class="dropdown-item"><!----> <a href="/python_advanced/" class="nav-link">Python Advanced</a></li><li class="dropdown-item"><!----> <a href="/python_projects/" class="nav-link">Python Projects</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç½‘ç»œè¿ç»´" class="dropdown-title"><a href="/tool/" class="link-title">ç½‘ç»œè¿ç»´</a> <span class="title" style="display:none;">ç½‘ç»œè¿ç»´</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>CCNA</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/91ab17/" class="nav-link">CCNAçŸ¥è¯†</a></li><li class="dropdown-subitem"><a href="/pages/55766c/" class="nav-link">CCNAé¢˜åº“</a></li><li class="dropdown-subitem"><a href="/pages/f61749/" class="nav-link">Cisco NetAca</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/4f0673/" class="nav-link">Ansible</a></li><li class="dropdown-item"><h4>ç‰ˆæœ¬ç®¡ç†</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>éƒ¨ç½²</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><a href="/archives/" class="link-title">About</a> <span class="title" style="display:none;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>This Blog</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">Archives</a></li></ul></li><li class="dropdown-item"><h4>About Me</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">Collection</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">Introduction</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ˜Ÿæ²³ä¸‡é‡Œ" class="dropdown-title"><a href="/inGermany/" class="link-title">æ˜Ÿæ²³ä¸‡é‡Œ</a> <span class="title" style="display:none;">æ˜Ÿæ²³ä¸‡é‡Œ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å¾·å›½é©¾ç…§Bçº§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8a9dd0/" class="nav-link">ç†è®ºå‡†å¤‡</a></li><li class="dropdown-subitem"><a href="/pages/b79ef5/" class="nav-link">å®è·µå‡†å¤‡</a></li></ul></li><li class="dropdown-item"><h4>æ˜Ÿæ²³ä¸‡é‡Œ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf060/" class="nav-link">Vimæ“ä½œ</a></li><li class="dropdown-subitem"><a href="/pages/c11fcf/" class="nav-link">Gitemoji</a></li><li class="dropdown-subitem"><a href="/pages/055f2e/" class="nav-link">æ— å¦„ç»</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/message-board/" class="nav-link">MessageBoardğŸ“‹</a></div> <a href="https://github.com/Jonas-Wolfxin/Jonas-Wolfxin.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å…³ç³»æ•°æ®åº“ - MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å…³ç³»æ•°æ®åº“ - PostgreSQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç¼“å­˜æ•°æ®åº“ - Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>æœç´¢æ•°æ®åº“ - ElasticSearch</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es/introduce/" class="sidebar-link">ElasticSearch - åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/es/install/" class="sidebar-link">ElasticSearch - å®‰è£…</a></li><li><a href="/es/simple-curd/" class="sidebar-link">ElasticSearch - åŸºæœ¬æ“ä½œ</a></li><li><a href="/es/hight-curd/" class="sidebar-link">ElasticSearch - é«˜çº§æ“ä½œ</a></li><li><a href="/es/java-curd/" class="sidebar-link">ElasticSearch - Javaæ“ä½œ</a></li><li><a href="/es/boot-curd/" aria-current="page" class="active sidebar-link">ElasticSearch - å¤šæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/es/boot-curd/#spring-dataæ¡†æ¶é›†æˆ" class="sidebar-link">Spring Dataæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#spring-data-elasticsearchä»‹ç»" class="sidebar-link">Spring Data Elasticsearchä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#spring-data-elasticsearchç‰ˆæœ¬å¯¹æ¯”" class="sidebar-link">Spring Data Elasticsearchç‰ˆæœ¬å¯¹æ¯”</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ¡†æ¶æ­å»º" class="sidebar-link">æ¡†æ¶æ­å»º</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#å°è£…ç±»æµ‹è¯•" class="sidebar-link">å°è£…ç±»æµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#repositoryç±»åŸç”Ÿæµ‹è¯•" class="sidebar-link">Repositoryç±»åŸç”Ÿæµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#repositoryç±»è‡ªå®šä¹‰æµ‹è¯•" class="sidebar-link">Repositoryç±»è‡ªå®šä¹‰æµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ€»ç»“" class="sidebar-link">æ€»ç»“</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/es/boot-curd/#spring-bootæ¡†æ¶é›†æˆ" class="sidebar-link">Spring Bootæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#spring-bootä»‹ç»" class="sidebar-link">Spring Bootä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#springbootçš„ç‰¹ç‚¹" class="sidebar-link">SpringBootçš„ç‰¹ç‚¹</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#dataæ¡†æ¶å’Œbootæ¡†æ¶é›†æˆåŒºåˆ«" class="sidebar-link">Dataæ¡†æ¶å’ŒBootæ¡†æ¶é›†æˆåŒºåˆ«</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ¡†æ¶æ­å»º-2" class="sidebar-link">æ¡†æ¶æ­å»º</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#è¿æ¥æµ‹è¯•" class="sidebar-link">è¿æ¥æµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#ç´¢å¼•æµ‹è¯•" class="sidebar-link">ç´¢å¼•æµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ–‡æ¡£æµ‹è¯•" class="sidebar-link">æ–‡æ¡£æµ‹è¯•</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#é«˜çº§æŸ¥è¯¢æµ‹è¯•" class="sidebar-link">é«˜çº§æŸ¥è¯¢æµ‹è¯•</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/es/boot-curd/#spark-streamingæ¡†æ¶é›†æˆ" class="sidebar-link">Spark Streamingæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#spark-streamingæ¡†æ¶ä»‹ç»" class="sidebar-link">Spark Streamingæ¡†æ¶ä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ¡†æ¶æ­å»º-3" class="sidebar-link">æ¡†æ¶æ­å»º</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#åŠŸèƒ½å®ç°" class="sidebar-link">åŠŸèƒ½å®ç°</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/es/boot-curd/#flinkæ¡†æ¶é›†æˆ" class="sidebar-link">Flinkæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#flinkæ¡†æ¶ä»‹ç»" class="sidebar-link">Flinkæ¡†æ¶ä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#æ¡†æ¶æ­å»º-4" class="sidebar-link">æ¡†æ¶æ­å»º</a></li><li class="sidebar-sub-header level3"><a href="/es/boot-curd/#åŠŸèƒ½å®ç°-2" class="sidebar-link">åŠŸèƒ½å®ç°</a></li></ul></li></ul></li><li><a href="/es/cluster/" class="sidebar-link">ElasticSearch - æ­å»ºé›†ç¾¤</a></li><li><a href="/es/high-concept/" class="sidebar-link">ElasticSearch - è¿›é˜¶æ¦‚å¿µ</a></li><li><a href="/es/distributed/" class="sidebar-link">ElasticSearch - åˆ†å¸ƒå¼é›†ç¾¤å’Œè·¯ç”±è®¡ç®—</a></li><li><a href="/es/shards-control/" class="sidebar-link">ElasticSearch - åˆ†ç‰‡æ§åˆ¶æµç¨‹</a></li><li><a href="/es/shards-principle/" class="sidebar-link">ElasticSearch - åˆ†ç‰‡æ“ä½œåŸç†</a></li><li><a href="/es/analysis/" class="sidebar-link">ElasticSearch - å¤šç§åˆ†æå™¨</a></li><li><a href="/es/handle/" class="sidebar-link">ElasticSearch - å†²çªé—®é¢˜å¤„ç†</a></li><li><a href="/es/optimization/" class="sidebar-link">ElasticSearch - è¿›é˜¶ä¼˜åŒ–</a></li><li><a href="/es/face-questions/" class="sidebar-link">ElasticSearch - é¢è¯•é¢˜</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>åˆ†å¸ƒå¼æ•°æ®åº“ - MongoDB</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E6%95%B0%E6%8D%AE%E5%BA%93" title="åˆ†ç±»" data-v-06225672>æ•°æ®åº“</a></li><li data-v-06225672><a href="/categories/?category=%E6%90%9C%E7%B4%A2%E6%95%B0%E6%8D%AE%E5%BA%93%20-%20ElasticSearch" title="åˆ†ç±»" data-v-06225672>æœç´¢æ•°æ®åº“ - ElasticSearch</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Jonas-Wolfxin" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>Jonas Wolfxin</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-11-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">ElasticSearch - å¤šæ¡†æ¶é›†æˆ<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#spring-dataæ¡†æ¶é›†æˆ">Spring Dataæ¡†æ¶é›†æˆ</a><ul><li><a href="#spring-data-elasticsearchä»‹ç»">Spring Data Elasticsearchä»‹ç»</a></li><li><a href="#spring-data-elasticsearchç‰ˆæœ¬å¯¹æ¯”">Spring Data Elasticsearchç‰ˆæœ¬å¯¹æ¯”</a></li><li><a href="#æ¡†æ¶æ­å»º">æ¡†æ¶æ­å»º</a></li><li><a href="#å°è£…ç±»æµ‹è¯•">å°è£…ç±»æµ‹è¯•</a></li><li><a href="#repositoryç±»åŸç”Ÿæµ‹è¯•">Repositoryç±»åŸç”Ÿæµ‹è¯•</a></li><li><a href="#repositoryç±»è‡ªå®šä¹‰æµ‹è¯•">Repositoryç±»è‡ªå®šä¹‰æµ‹è¯•</a></li><li><a href="#æ€»ç»“">æ€»ç»“</a></li></ul></li><li><a href="#spring-bootæ¡†æ¶é›†æˆ">Spring Bootæ¡†æ¶é›†æˆ</a><ul><li><a href="#spring-bootä»‹ç»">Spring Bootä»‹ç»</a></li><li><a href="#springbootçš„ç‰¹ç‚¹">SpringBootçš„ç‰¹ç‚¹</a></li><li><a href="#dataæ¡†æ¶å’Œbootæ¡†æ¶é›†æˆåŒºåˆ«">Dataæ¡†æ¶å’ŒBootæ¡†æ¶é›†æˆåŒºåˆ«</a></li><li><a href="#æ¡†æ¶æ­å»º">æ¡†æ¶æ­å»º</a></li><li><a href="#è¿æ¥æµ‹è¯•">è¿æ¥æµ‹è¯•</a></li><li><a href="#ç´¢å¼•æµ‹è¯•">ç´¢å¼•æµ‹è¯•</a></li><li><a href="#æ–‡æ¡£æµ‹è¯•">æ–‡æ¡£æµ‹è¯•</a></li><li><a href="#é«˜çº§æŸ¥è¯¢æµ‹è¯•">é«˜çº§æŸ¥è¯¢æµ‹è¯•</a></li></ul></li><li><a href="#spark-streamingæ¡†æ¶é›†æˆ">Spark Streamingæ¡†æ¶é›†æˆ</a><ul><li><a href="#spark-streamingæ¡†æ¶ä»‹ç»">Spark Streamingæ¡†æ¶ä»‹ç»</a></li><li><a href="#æ¡†æ¶æ­å»º">æ¡†æ¶æ­å»º</a></li><li><a href="#åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</a></li></ul></li><li><a href="#flinkæ¡†æ¶é›†æˆ">Flinkæ¡†æ¶é›†æˆ</a><ul><li><a href="#flinkæ¡†æ¶ä»‹ç»">Flinkæ¡†æ¶ä»‹ç»</a></li><li><a href="#æ¡†æ¶æ­å»º">æ¡†æ¶æ­å»º</a></li><li><a href="#åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</a></li></ul></li></ul></div><p></p> <h2 id="spring-dataæ¡†æ¶é›†æˆ"><a href="#spring-dataæ¡†æ¶é›†æˆ" class="header-anchor">#</a> Spring Dataæ¡†æ¶é›†æˆ</h2> <p>Spring Data æ˜¯ä¸€ä¸ªç”¨äºç®€åŒ–æ•°æ®åº“ã€éå…³ç³»å‹æ•°æ®åº“ã€ç´¢å¼•åº“è®¿é—®ï¼Œå¹¶æ”¯æŒäº‘æœåŠ¡çš„å¼€æºæ¡†æ¶ã€‚å…¶ä¸»è¦ç›®æ ‡æ˜¯ä½¿å¾—å¯¹æ•°æ®çš„è®¿é—®å˜å¾—æ–¹ä¾¿å¿«æ·ï¼Œå¹¶æ”¯æŒ map-reduce æ¡†æ¶å’Œäº‘è®¡ ç®—æ•°æ®æœåŠ¡ã€‚Spring Data å¯ä»¥æå¤§çš„ç®€åŒ– JPAï¼ˆElasticsearch ......ï¼‰çš„å†™æ³•ï¼Œå¯ä»¥åœ¨å‡ ä¹ä¸ç”¨å†™å®ç°çš„æƒ…å†µä¸‹ï¼Œå®ç°å¯¹æ•°æ®çš„è®¿é—®å’Œæ“ä½œã€‚é™¤äº† CRUD å¤–ï¼Œè¿˜åŒ…æ‹¬å¦‚åˆ†é¡µã€æ’åºç­‰ä¸€äº›å¸¸ç”¨çš„åŠŸèƒ½ã€‚</p> <p>Spring Data çš„å®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-data" target="_blank" rel="noopener noreferrer">https://spring.io/projects/spring-data<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211117215542.png" alt="image-20211117215043708"></p> <p>Spring Data å¸¸ç”¨çš„åŠŸèƒ½æ¨¡å—å¦‚ä¸‹ï¼š</p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211117215239.png" alt="image-20211117215238730"></p> <h3 id="spring-data-elasticsearchä»‹ç»"><a href="#spring-data-elasticsearchä»‹ç»" class="header-anchor">#</a> Spring Data Elasticsearchä»‹ç»</h3> <p>Spring Data Elasticsearch åŸºäº spring data API ç®€åŒ– Elasticsearch æ“ä½œï¼Œå°†åŸå§‹æ“ä½œ Elasticsearch çš„å®¢æˆ·ç«¯ API è¿›è¡Œå°è£…ã€‚Spring Data ä¸º Elasticsearch é¡¹ç›®æä¾›é›†æˆæœç´¢å¼•æ“ã€‚Spring Data Elasticsearch POJO çš„å…³é”®åŠŸèƒ½åŒºåŸŸä¸ºä¸­å¿ƒçš„æ¨¡å‹ä¸ Elastichsearch äº¤äº’æ–‡æ¡£å’Œè½»æ¾åœ°ç¼–å†™ä¸€ä¸ªå­˜å‚¨ç´¢å¼•åº“æ•°æ®è®¿é—®å±‚ã€‚</p> <p>å®˜æ–¹ç½‘ç«™: <a href="https://spring.io/projects/spring-data-elasticsearch" target="_blank" rel="noopener noreferrer">https://spring.io/projects/spring-data-elasticsearch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211117215504.png" alt="image-20211117215503729"></p> <h3 id="spring-data-elasticsearchç‰ˆæœ¬å¯¹æ¯”"><a href="#spring-data-elasticsearchç‰ˆæœ¬å¯¹æ¯”" class="header-anchor">#</a> Spring Data Elasticsearchç‰ˆæœ¬å¯¹æ¯”</h3> <p>é€‰æ‹©å…¼å®¹çš„ç‰ˆæœ¬éå¸¸é‡è¦ï¼Œæˆ‘ç»å¸¸å› ä¸ºç‰ˆæœ¬å†²çªè€ŒèŠ±è´¹äº†å¤§é‡æ—¶é—´è°ƒè¯•ã€‚</p> <p>ç‰ˆæœ¬å¯¹æ¯”ä»¥å®˜ç½‘ä¸ºä¸»ï¼ŒæŸ¥çœ‹åœ°å€ï¼š<a href="https://docs.spring.io/spring-data/elasticsearch/docs/4.3.0/reference/html/#preface.requirements" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-data/elasticsearch/docs/4.3.0/reference/html/#preface.requirements<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211117215809.png" alt="image-20211117215743063"></p> <p>æˆ‘çš„ Elasticsearch ç‰ˆæœ¬æ˜¯ 7.15.2ï¼Œæ‰€ä»¥æ‰€æœ‰ç‰ˆæœ¬é€‰æ‹©å¦‚ä¸‹ï¼š</p> <p><img src="https://img.shields.io/badge/Elasticsearch-7.15.2-green" alt=""></p> <p><img src="https://img.shields.io/badge/Spring%20Data%20ES-4.3.0-red" alt=""></p> <p><img src="https://img.shields.io/badge/Spring%20Boot-2.5.5-blue" alt=""></p> <h3 id="æ¡†æ¶æ­å»º"><a href="#æ¡†æ¶æ­å»º" class="header-anchor">#</a> æ¡†æ¶æ­å»º</h3> <ul><li><p>åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®</p></li> <li><p>ä¿®æ”¹ pom.xml æ–‡ä»¶ï¼Œæ·»åŠ ä¾èµ–</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code> <span class="token comment">&lt;!-- Spring Boot --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Spring data ES ä¾èµ– --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>å› ä¸ºåˆ©ç”¨ Test è¿›è¡Œæµ‹è¯•ï¼Œæ‰€ä»¥ä¸éœ€è¦åŠ å…¥ Web ç­‰ä¾èµ–ï¼Œè¯·æ ¹æ®éœ€æ±‚è‡ªè¡Œæ·»åŠ ã€‚</p></li> <li><p>æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œåœ¨ resources ç›®å½•ä¸­å¢åŠ  application.yml æ–‡ä»¶</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>spring:
  application:
    name: es-service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block note"><p class="custom-block-title">æ³¨æ„</p> <p>æ–°ç‰ˆçš„ ip åœ°å€å’Œç«¯å£å·å¯ä»¥åœ¨ã€Œé…ç½®ç±»ã€é‡Œè¿›è¡Œé…ç½®ï¼Œæ— éœ€åœ¨é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®</p> <div class="custom-block right"><p>2021-11-17 @Jonas Wolfxin</p></div></div> <p>æ—§ç‰ˆçš„é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> es<span class="token punctuation">-</span>service
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
      <span class="token key atrule">cluster-nodes</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">9200</span>  <span class="token comment"># ES æœåŠ¡å™¨ä½ç½®</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>Spring Boot å¯åŠ¨ç±»</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kbt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 17:24
 * @description å¯åŠ¨ç±»
 */</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EsApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">EsApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p>æ·»åŠ  ES é…ç½®ç±»ï¼Œè¿›è¡Œåœ°å€å’Œç«¯å£çš„é…ç½®</p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token keyword" data-v-4f1e9d0c>package</span> <span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt<span class="token punctuation" data-v-4f1e9d0c>.</span>config</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>apache<span class="token punctuation" data-v-4f1e9d0c>.</span>http<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>HttpHost</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestClient</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestClientBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Bean</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Configuration</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>config<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>AbstractElasticsearchConfiguration</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token comment" data-v-4f1e9d0c>/**
   * @author Jonas Wolfxin
   * @date 2021/11/17 17:25
   * @description ElasticSearch é…ç½®ç±»
   */</span>
<span class="token annotation punctuation" data-v-4f1e9d0c>@Configuration</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ElasticSearchConfig</span> <span class="token keyword" data-v-4f1e9d0c>extends</span> <span class="token class-name" data-v-4f1e9d0c>AbstractElasticsearchConfiguration</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Override</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Bean</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> <span class="token function" data-v-4f1e9d0c>elasticsearchClient</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

        <span class="token class-name" data-v-4f1e9d0c>RestClientBuilder</span> builder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>RestClient</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>builder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>HttpHost</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;127.0.0.1&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>9200</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;http&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>return</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span><span class="token punctuation" data-v-4f1e9d0c>(</span>builder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

        <span class="token comment" data-v-4f1e9d0c>// å¦‚æœé›†ç¾¤æœ‰å¤šä¸ªåœ°å€</span>
        <span class="token comment" data-v-4f1e9d0c>// HttpHost[] httpHosts = new HttpHost[]{</span>
        <span class="token comment" data-v-4f1e9d0c>//        new HttpHost(&quot;127.2.0.1&quot;, 9200,&quot;http&quot;),</span>
        <span class="token comment" data-v-4f1e9d0c>//        new HttpHost(&quot;127.2.0.2&quot;, 9200,&quot;http&quot;),</span>
        <span class="token comment" data-v-4f1e9d0c>//        new HttpHost(&quot;127.2.0.3&quot;, 9200,&quot;http&quot;)};</span>
        <span class="token comment" data-v-4f1e9d0c>// RestClientBuilder builder = RestClient.builder(httpHosts);</span>
        <span class="token comment" data-v-4f1e9d0c>// return new RestHighLevelClient(builder);</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token keyword" data-v-4f1e9d0c>package</span> <span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt<span class="token punctuation" data-v-4f1e9d0c>.</span>config</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>apache<span class="token punctuation" data-v-4f1e9d0c>.</span>http<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>HttpHost</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestClient</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestClientBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>client<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Bean</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Configuration</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>config<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>AbstractElasticsearchConfiguration</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token comment" data-v-4f1e9d0c>/**
   * @author Jonas Wolfxin
   * @date 2021/11/17 17:25
   * @description ElasticSearch é…ç½®ç±»ï¼Œæ¥æºå®˜ç½‘
   */</span>
<span class="token annotation punctuation" data-v-4f1e9d0c>@Configuration</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ElasticSearchConfig</span> <span class="token keyword" data-v-4f1e9d0c>extends</span> <span class="token class-name" data-v-4f1e9d0c>AbstractElasticsearchConfiguration</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Override</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Bean</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> <span class="token function" data-v-4f1e9d0c>elasticsearchClient</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

        <span class="token keyword" data-v-4f1e9d0c>final</span> <span class="token class-name" data-v-4f1e9d0c>ClientConfiguration</span> clientConfiguration <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>ClientConfiguration</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>builder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
            <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>connectedTo</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;localhost:9200&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span>  <span class="token comment" data-v-4f1e9d0c>// å¤šä¸ªåœ°å€ç”¨é€—å·éš”å¼€</span>
            <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

        <span class="token keyword" data-v-4f1e9d0c>return</span> <span class="token class-name" data-v-4f1e9d0c>RestClients</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>create</span><span class="token punctuation" data-v-4f1e9d0c>(</span>clientConfiguration<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>rest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <p>æˆ‘è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨æœ€æ–°æ¨¡æ¿ï¼Œå¯åŠ¨å¤±è´¥ï¼Œä¼šæŠ¥é”™ï¼Œåªèƒ½ä½¿ç”¨åŸå§‹æ¨¡æ¿ï¼Œå»ºè®®èƒ½ç”¨æœ€æ–°æ¨¡æ¿å°±ç”¨å®ƒï¼Œå› ä¸ºè¿™æ˜¯å®˜æ–¹æ¨èã€‚</p></li> <li><p>å®ä½“ç±»</p> <p>Spring Data ESæ”¯æŒä¸¤ç§å®ä½“æ˜ å°„æ–¹æ¡ˆï¼š</p> <ul><li>Jackson Object Mapping</li> <li>Meta Model Object Mapping</li></ul> <p>æ—©æœŸçš„ç‰ˆæœ¬é»˜è®¤ä½¿ç”¨çš„æ˜¯ jackson çš„æ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨ <code>4.x</code> ä¹‹å Meta Model å°±ä¸Šä½äº†ï¼Œè€Œå‰è€…å·²ç»ä¸å†è¢«æ”¯æŒã€‚æ‰€ä»¥è¿™é‡Œä½¿ç”¨ç¬¬äºŒç§æ–¹æ¡ˆã€‚æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªå®ä½“ç±»ï¼Œå¹¶é€šè¿‡æ³¨è§£æ¥è¡¨æ˜å®ƒè·Ÿ ES å®ä½“ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">FieldType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Setting</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 17:26
 * @description å•†å“å®ä½“ç±»
 */</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Setting</span><span class="token punctuation">(</span>shards <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> replicas <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span> <span class="token comment">// å•†å“å”¯ä¸€æ ‡è¯†</span>
    <span class="token comment">/**
     * type: å­—æ®µæ•°æ®ç±»å‹
     * analyzer: åˆ†è¯å™¨ç±»å‹
     * index: æ˜¯å¦ç´¢å¼•(é»˜è®¤:true)
     * Keyword: çŸ­è¯­,ä¸è¿›è¡Œåˆ†è¯
     */</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span> <span class="token comment">// å•†å“åç§°</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> category<span class="token punctuation">;</span> <span class="token comment">// åˆ†ç±»åç§°</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> price<span class="token punctuation">;</span> <span class="token comment">// å•†å“ä»·æ ¼</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> images<span class="token punctuation">;</span> <span class="token comment">// å›¾ç‰‡åœ°å€</span>
    
    <span class="token keyword">public</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// set </span>
    <span class="token comment">// get </span>
    <span class="token comment">// toString</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>ç´¢å¼•å«åš <code>shopping</code>ã€‚</p> <p>è¯·åŠ å…¥ Set å’Œ Get å’Œ toString æ–¹æ³•ï¼ŒtoString æ–¹æ³•æ˜¯ä¸ºäº†æµ‹è¯•æœŸé—´ç›´æ¥æ‰“å°åœ¨æ§åˆ¶å°ã€‚</p> <blockquote><p><strong>ç±»æ³¨è§£ï¼š@Document æ˜¯æ–‡æ¡£æ³¨è§£ï¼Œ@Setting æ˜¯ ES é…ç½®æ³¨è§£</strong></p></blockquote> <table><thead><tr><th>æ³¨è§£</th> <th>Elasticsearch æ˜ å°„ä¸­çš„æ ¼å¼å­—ç¬¦ä¸²</th></tr></thead> <tbody><tr><td>indexName</td> <td>ç´¢å¼•åç§°</td></tr> <tr><td>type</td> <td>ç´¢å¼•ç±»å‹</td></tr> <tr><td>shards</td> <td>åˆ†ç‰‡çš„æ•°é‡ï¼Œé»˜è®¤ä¸º 1</td></tr> <tr><td>replicas</td> <td>å‰¯æœ¬çš„æ•°é‡ï¼Œé»˜è®¤ä¸º 1</td></tr> <tr><td>refreshInterval</td> <td>åˆ·æ–°é—´éš”ï¼Œé»˜è®¤ä¸º 1 s</td></tr> <tr><td>indexStoreType</td> <td>ç´¢å¼•æ–‡ä»¶å­˜å‚¨ç±»å‹ï¼Œé»˜è®¤ä¸º fs</td></tr></tbody></table> <blockquote><p><strong>å±æ€§æ³¨è§£ï¼š@Field ç”¨æ¥æŒ‡å®šå±æ€§çš„ç±»å‹</strong></p></blockquote> <table><thead><tr><th>æ³¨è§£</th> <th>Elasticsearch æ˜ å°„ä¸­çš„æ ¼å¼å­—ç¬¦ä¸²</th></tr></thead> <tbody><tr><td>analyzer</td> <td>æŒ‡å®šåˆ†è¯å™¨ï¼ŒEs ä¸­é»˜è®¤ä½¿ç”¨çš„æ ‡å‡†åˆ†è¯å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦æŒ‡å®šä¸­æ–‡ IK åˆ†è¯å™¨ï¼Œå¯ä»¥æŒ‡å®šå€¼ä¸º ik_max_word</td></tr> <tr><td>name</td> <td>å­—æ®µåç§°ï¼Œå¯ä»¥åœ¨ ES æ–‡æ¡£ä¸­è¡¨ç¤ºï¼Œè‹¥æœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨ Java å­—æ®µåç§°ã€‚</td></tr> <tr><td>index</td> <td>æŒ‡å®šè¯¥è¯æ˜¯å¦éœ€è¦ç´¢å¼•ï¼Œé»˜è®¤ä¸º true</td></tr> <tr><td>type</td> <td>æŒ‡å®šè¯¥å±æ€§åœ¨ ES ä¸­çš„ç±»å‹ï¼Œå…¶ä¸­çš„å€¼æ˜¯ FileType ç±»å‹çš„å€¼ï¼Œæ¯”å¦‚ FileType.Text ç±»å‹å¯¹åº” ES ä¸­çš„ text ç±»å‹</td></tr> <tr><td>store</td> <td>æŒ‡å®šè¯¥å±æ€§å†…å®¹æ˜¯å¦å­˜å‚¨åœ¨ ESï¼Œé»˜è®¤ä¸º false</td></tr> <tr><td>fielddata</td> <td>æŒ‡å®šè¯¥å±æ€§èƒ½å¦è¿›è¡Œæ’åºï¼Œå› ä¸º ES ä¸­çš„ text ç±»å‹æ˜¯ä¸èƒ½è¿›è¡Œæ’åºï¼ˆå·²ç»åˆ†è¯äº†ï¼‰</td></tr> <tr><td>searchAnalyzer</td> <td>æŒ‡å®šæœç´¢ä½¿ç”¨çš„åˆ†è¯å™¨</td></tr></tbody></table> <blockquote><p><strong>æ—¥æœŸæ ¼å¼æ˜ å°„</strong></p></blockquote> <table><thead><tr><th>æ³¨è§£</th> <th>Elasticsearch æ˜ å°„ä¸­çš„æ ¼å¼å­—ç¬¦ä¸²</th></tr></thead> <tbody><tr><td>@Field(type=FieldType.Date)</td> <td>date_optional_timeepoch_millis</td></tr> <tr><td>@Field(type=FieldType.Date, format=DateFormat.basic_date)</td> <td>åŸºæœ¬æ—¥æœŸ</td></tr> <tr><td>@Field(type=FieldType.Date, format={DateFormat.basic_date, DateFormat.basic_time})</td> <td>åŸºæœ¬æ—¥æœŸ || åŸºæœ¬æ—¶é—´</td></tr> <tr><td>@Field(type=FieldType.Date, pattern=&quot;dd.MM.uuuu&quot;)</td> <td>date_optional_time || epoch_millis || dd.MM.uuu</td></tr> <tr><td>@Field(type=FieldType.Date, format={}, pattern=&quot;dd.MM.uuuu&quot;)</td> <td>dd.MM.uuuu</td></tr></tbody></table></li></ul> <h3 id="å°è£…ç±»æµ‹è¯•"><a href="#å°è£…ç±»æµ‹è¯•" class="header-anchor">#</a> å°è£…ç±»æµ‹è¯•</h3> <p>è¿™é‡Œå…ˆæ¼”ç¤ºä½¿ç”¨ ES å°è£…ç±»è¿›è¡Œæµ‹è¯•ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œåé¢è¿˜æœ‰æ›´åŠ ç®€å•çš„<a href="#repository%E7%B1%BB%E5%8E%9F%E7%94%9F%E6%B5%8B%E8%AF%95">Repositoryç±»åŸç”Ÿæµ‹è¯•</a></p> <p>Spring Data Elasticsearch ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ SearchOperations å·¥å…·æ‰§è¡Œä¸€äº›æ›´å¤æ‚çš„æŸ¥è¯¢ï¼Œè¿™äº›æŸ¥è¯¢æ“ä½œæ¥æ”¶ä¸€ä¸ª Query å¯¹è±¡å°è£…çš„æŸ¥è¯¢æ“ä½œã€‚</p> <p>Spring Data Elasticsearch ä¸­çš„ Query æœ‰ä¸‰ç§ï¼š</p> <ul><li>CriteriaQuery</li> <li>StringQuery</li> <li>NativeSearchQuery</li></ul> <p>NativeSearchQuery å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„æŸ¥è¯¢ï¼Œå¦‚æœæ˜¯å­—æ®µæŸ¥è¯¢æˆ–è€…èŒƒå›´æŸ¥è¯¢ï¼Œéœ€è¦ç”¨åˆ° CriteriaQueryã€‚</p> <p><mark>æ’å…¥æ•°æ®æ—¶ï¼Œå¦‚æœç´¢å¼•ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨ä¼šåˆ›å»ºç´¢å¼•</mark></p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token keyword" data-v-4f1e9d0c>package</span> <span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt<span class="token punctuation" data-v-4f1e9d0c>.</span>pojo<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Product</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>index<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>index<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>TermQueryBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>search<span class="token punctuation" data-v-4f1e9d0c>.</span>fetch<span class="token punctuation" data-v-4f1e9d0c>.</span>subphase<span class="token punctuation" data-v-4f1e9d0c>.</span>highlight<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>junit<span class="token punctuation" data-v-4f1e9d0c>.</span>jupiter<span class="token punctuation" data-v-4f1e9d0c>.</span>api<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Test</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>beans<span class="token punctuation" data-v-4f1e9d0c>.</span>factory<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Autowired</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>boot<span class="token punctuation" data-v-4f1e9d0c>.</span>test<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>SpringBootTest</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>domain<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>PageRequest</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>domain<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Sort</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>SearchHits</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>SearchOperations</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span>mapping<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>IndexCoordinates</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>IndexQuery</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>IndexQueryBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>elasticsearch<span class="token punctuation" data-v-4f1e9d0c>.</span>core<span class="token punctuation" data-v-4f1e9d0c>.</span>query<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>java<span class="token punctuation" data-v-4f1e9d0c>.</span>util<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>List</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token comment" data-v-4f1e9d0c>/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 19:59
 * @description ES å•†å“æµ‹è¯•ç±»
 */</span>
<span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * æ’å…¥æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åä¸ºæ‰‹æœº1&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// indexCoordinates æ˜¯ 4.x æ–°å¢çš„ä¸€ä¸ªå‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥å†æ“ä½œESçš„æ—¶å€™åŒæ—¶æŒ‡å®šå¤šä¸ª indexã€‚</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexCoordinates</span> indexCoordinatesFor <span class="token operator" data-v-4f1e9d0c>=</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndexCoordinatesFor</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getClass</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// ä¸ºç´¢å¼•è®¾ç½®æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexQuery</span> indexQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withId</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>toString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withObject</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ’å…¥ç´¢å¼•å’Œå…¶æ•°æ®ï¼Œè¿”å›ç´¢å¼•å€¼</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span> index <span class="token operator" data-v-4f1e9d0c>=</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span>indexQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> indexCoordinatesFor<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ’å…¥çš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> index<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢å…¨éƒ¨æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢å‚æ•°é…ç½®</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// è·å–æŸ¥è¯¢çš„ç»“æœå‘½ä¸­æ€»æ•°</span>
        <span class="token keyword" data-v-4f1e9d0c>long</span> count <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ€»æ•°ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> count<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * è¯æ¡æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>termQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŒ‡å®šåå­—æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>TermQueryBuilder</span> termQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>TermQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;category&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢å‚æ•°é…ç½®</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>termQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// è·å–æŸ¥è¯¢çš„ç»“æœå‘½ä¸­æ€»æ•°</span>
        <span class="token keyword" data-v-4f1e9d0c>long</span> count <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ€»æ•°ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> count<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæ’åºæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>sortPageQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æ’åº(æ’åºæ–¹å¼ï¼Œæ­£åºè¿˜æ˜¯å€’åºï¼Œæ’åºçš„ id)</span>
        <span class="token class-name" data-v-4f1e9d0c>Sort</span> sort <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>Sort</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>by</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Sort<span class="token punctuation" data-v-4f1e9d0c>.</span>Direction</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DESC<span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;id&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> currentPage <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>//å½“å‰é¡µï¼Œç¬¬ä¸€é¡µä» 0 å¼€å§‹ï¼Œ1 è¡¨ç¤ºç¬¬äºŒé¡µ</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> pageSize <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>3</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>//æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æŸ¥è¯¢åˆ†é¡µ</span>
        <span class="token class-name" data-v-4f1e9d0c>PageRequest</span> pageRequest <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>PageRequest</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>of</span><span class="token punctuation" data-v-4f1e9d0c>(</span>currentPage<span class="token punctuation" data-v-4f1e9d0c>,</span> pageSize<span class="token punctuation" data-v-4f1e9d0c>,</span>sort<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢å‚æ•°é…ç½®</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withPageable</span><span class="token punctuation" data-v-4f1e9d0c>(</span>pageRequest<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>highLightQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢å‚æ•°é…ç½®</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withHighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;price&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>preTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;å‰ç¼€&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>postTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;/åç¼€&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * èŒƒå›´æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>searchByPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Criteria</span> criteria <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Criteria</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;price&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>between</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2000.0</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>2500.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span> criteriaQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteria<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> search <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteriaQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> search<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHit <span class="token operator" data-v-4f1e9d0c>:</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchHit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>42</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>43</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>44</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>45</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>46</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>47</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>48</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>49</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>50</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>51</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>52</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>53</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>54</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>55</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>56</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>57</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>58</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>59</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>60</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>61</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>62</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>63</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>64</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>65</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>66</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>67</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>68</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>69</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>70</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>71</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>72</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>73</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>74</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>75</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>76</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>77</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>78</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>79</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>80</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>81</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>82</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>83</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>84</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>85</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>86</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>87</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>88</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>89</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>90</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>91</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>92</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>93</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>94</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>95</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>96</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>97</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>98</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>99</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>100</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>101</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>102</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>103</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>104</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>105</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>106</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>107</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>108</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>109</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>110</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>111</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>112</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>113</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>114</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>115</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>116</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>117</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>118</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>119</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>120</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>121</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>122</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>123</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>124</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>125</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>126</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>127</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>128</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>129</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>130</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>131</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>132</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>133</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>134</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>135</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>136</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>137</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>138</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>139</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>140</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>141</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>142</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>143</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>144</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>145</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>146</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>147</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>148</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>149</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>150</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>151</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>152</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>153</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>154</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>155</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>156</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>157</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>158</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>159</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>160</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>161</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>162</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>163</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>164</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>165</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * æ’å…¥æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åä¸ºæ‰‹æœº1&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// indexCoordinates æ˜¯ 4.x æ–°å¢çš„ä¸€ä¸ªå‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥å†æ“ä½œESçš„æ—¶å€™åŒæ—¶æŒ‡å®šå¤šä¸ª indexã€‚</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexCoordinates</span> indexCoordinatesFor <span class="token operator" data-v-4f1e9d0c>=</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndexCoordinatesFor</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getClass</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// ä¸ºç´¢å¼•è®¾ç½®æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexQuery</span> indexQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withId</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>toString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withObject</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ’å…¥ç´¢å¼•å’Œå…¶æ•°æ®ï¼Œè¿”å›ç´¢å¼•å€¼</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span> index <span class="token operator" data-v-4f1e9d0c>=</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span>indexQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> indexCoordinatesFor<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ’å…¥çš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> index<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢å…¨éƒ¨æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// è·å–æŸ¥è¯¢çš„ç»“æœå‘½ä¸­æ€»æ•°</span>
        <span class="token keyword" data-v-4f1e9d0c>long</span> count <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ€»æ•°ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> count<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * è¯æ¡æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>termQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŒ‡å®šåå­—æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>TermQueryBuilder</span> termQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>TermQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;category&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>termQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// è·å–æŸ¥è¯¢çš„ç»“æœå‘½ä¸­æ€»æ•°</span>
        <span class="token keyword" data-v-4f1e9d0c>long</span> count <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ€»æ•°ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> count<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæ’åºæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>sortPageQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æ’åº(æ’åºæ–¹å¼ï¼Œæ­£åºè¿˜æ˜¯å€’åºï¼Œæ’åºçš„ id)</span>
        <span class="token class-name" data-v-4f1e9d0c>Sort</span> sort <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>Sort</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>by</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Sort<span class="token punctuation" data-v-4f1e9d0c>.</span>Direction</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DESC<span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;id&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> currentPage <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>//å½“å‰é¡µï¼Œç¬¬ä¸€é¡µä» 0 å¼€å§‹ï¼Œ1 è¡¨ç¤ºç¬¬äºŒé¡µ</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> pageSize <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>3</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>//æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æŸ¥è¯¢åˆ†é¡µ</span>
        <span class="token class-name" data-v-4f1e9d0c>PageRequest</span> pageRequest <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>PageRequest</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>of</span><span class="token punctuation" data-v-4f1e9d0c>(</span>currentPage<span class="token punctuation" data-v-4f1e9d0c>,</span> pageSize<span class="token punctuation" data-v-4f1e9d0c>,</span>sort<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withPageable</span><span class="token punctuation" data-v-4f1e9d0c>(</span>pageRequest<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>highLightQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span> allQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>MatchAllQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>NativeSearchQuery</span> searchQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>NativeSearchQueryBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>allQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>withHighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;price&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>preTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;å‰ç¼€&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>postTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;/åç¼€&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span>
                <span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>build</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> list <span class="token operator" data-v-4f1e9d0c>=</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// éå†æŸ¥è¯¢çš„æ•°æ®</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> hit <span class="token operator" data-v-4f1e9d0c>:</span> list<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èŒƒå›´æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>searchByPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Criteria</span> criteria <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Criteria</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;price&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span> criteriaQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteria<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> search <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteriaQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> search<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHit <span class="token operator" data-v-4f1e9d0c>:</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchHit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ElasticsearchOperations</span> esOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>SearchOperations</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èŒƒå›´æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>searchByPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Criteria</span> criteria <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Criteria</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;price&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>between</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2000.0</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>2500.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span> criteriaQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>CriteriaQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteria<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> search <span class="token operator" data-v-4f1e9d0c>=</span> searchOperations<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>criteriaQuery<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token keyword" data-v-4f1e9d0c>class</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHits <span class="token operator" data-v-4f1e9d0c>=</span> search<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSearchHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> searchHit <span class="token operator" data-v-4f1e9d0c>:</span> searchHits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>searchHit<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <p>ç”±ä»£ç å¯ä»¥çœ‹å‡ºï¼š</p> <ul><li><code>NativeSearchQueryBuilder</code> ç±»å¯ä»¥å¤„ç†å¾ˆå¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬æŸ¥è¯¢ã€åˆ†é¡µã€é«˜äº®ã€æ’åºç­‰ï¼Œå®ƒæ‹¥æœ‰ä¸°å¯Œçš„ <code>withXxx</code> æ–¹æ³•ï¼ŒåŸºæœ¬æ»¡è¶³å…³äº ES çš„æ“ä½œ</li> <li>å¦‚æœæ˜¯èŒƒå›´æŸ¥è¯¢ï¼Œéœ€è¦ç”¨åˆ° <code>Criteria</code> ç±»è¿›è¡ŒèŒƒå›´è®¾ç½®ï¼Œå½“ç„¶è¯¥ç±»ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥è¯¢æŸä¸ªå­—æ®µï¼Œä¸å¸¦èŒƒå›´çš„æŸ¥è¯¢å°±æ˜¯å­—æ®µæŸ¥è¯¢</li></ul> <p>è§£é‡Šï¼š</p> <ul><li><p><code>ElasticsearchOperations</code> æ˜¯ Spring Data ES æ“ä½œ ES çš„ä¸€ä¸ªæ¥å£ï¼Œåœ¨ 4.x çš„ç‰ˆæœ¬å®ƒçš„é»˜è®¤å®ç°ç±»æ˜¯ <code>ElasticsearchRestTemplate</code>ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>ElasticsearchRestTemplate</code> æ›¿æ¢æ‰ <code>ElasticsearchOperations</code>ï¼Œå› ä¸ºæ¥å£å’Œå…¶å®ç°ç±»éƒ½ä¸€æ ·ï¼Œä½¿ç”¨æ¥å£å¯ä»¥å®ç°å¤šæ€</p></li> <li><p><code>ElasticsearchOperations</code> ç»§æ‰¿ <code>SearchOperations</code>ï¼Œ<code>SearchOperations</code> å†…çš„æ–¹æ³•è¶‹å‘äºæœç´¢ï¼Œ<code>ElasticsearchOperations</code> å› ä¸ºç»§æ‰¿ï¼Œæ‰€ä»¥æ‹¥æœ‰ä¸€äº› <code>SearchOperations</code> çš„æœç´¢æ–¹æ³•ï¼Œè‡ªèº«ä¹Ÿæœ‰ä¸€äº›ç´¢å¼•çš„æ“ä½œæ–¹æ³•ã€‚è¿™é‡Œæˆ‘åˆ†å¼€ä½¿ç”¨</p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211130172857.png" alt="image-20211118200444755"></p></li></ul> <p>ç•ªå¤–ï¼š</p> <ul><li>ElasticsearchRestTemplate æ˜¯ Spring-Data-Elasticsearch é¡¹ç›®ä¸­çš„ä¸€ä¸ªç±»ï¼Œå’Œå…¶ä»– Spring é¡¹ç›®ä¸­çš„ Template ç±»ä¼¼</li> <li>é€‰æ‹© ElasticsearchRestTemplate ä»£æ›¿äº†åŸæ¥çš„ ElasticsearchTemplateï¼ŒåŸå› æ˜¯ ElasticsearchTemplate åŸºäº TransportClientï¼ŒTransportClient å³å°†åœ¨ 8.x ä»¥åçš„ç‰ˆæœ¬ä¸­ç§»é™¤</li> <li>ElasticsearchRestTemplate åŸºäº RestHighLevelClient å®¢æˆ·ç«¯çš„ã€‚éœ€è¦è‡ªå®šä¹‰é…ç½®ç±»ï¼Œç»§æ‰¿ AbstractElasticsearchConfigurationï¼Œå¹¶å®ç° elasticsearchClient() æŠ½è±¡æ–¹æ³•ï¼Œåˆ›å»º RestHighLevelClient å¯¹è±¡</li></ul> <h3 id="repositoryç±»åŸç”Ÿæµ‹è¯•"><a href="#repositoryç±»åŸç”Ÿæµ‹è¯•" class="header-anchor">#</a> Repositoryç±»åŸç”Ÿæµ‹è¯•</h3> <p>ç”¨è¿‡ Spring Data çš„äººéƒ½çŸ¥é“ï¼Œå®ƒé‡Œé¢æœ‰ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µå« <code>Repository</code>ã€‚</p> <p>Repository æ¥å£æ˜¯ Spring Data çš„ä¸€ä¸ªæ ¸å¿ƒæ¥å£ï¼Œå®ƒä¸æä¾›ä»»ä½•æ–¹æ³•ï¼Œå¼€å‘è€…éœ€è¦åœ¨è‡ªå·±å®šä¹‰çš„æ¥å£ä¸­å£°æ˜éœ€è¦çš„æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Repository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> ID <span class="token keyword">extends</span> <span class="token class-name">Serializable</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Spring Data å¯ä»¥è®©æˆ‘ä»¬åªå®šä¹‰æ¥å£ï¼Œåªè¦éµå¾ª Spring Data çš„è§„èŒƒï¼Œå°±æ— éœ€å†™å®ç°ç±»ã€‚Repository æœ‰å‡ ä¸ªå¸¸ç”¨çš„å­æ¥å£ï¼š</p> <ul><li>CrudRepositoryï¼š ç»§æ‰¿ Repositoryï¼Œå®ç°äº†ä¸€ç»„ CRUD ç›¸å…³çš„æ–¹æ³•</li> <li>PagingAndSortingRepositoryï¼š ç»§æ‰¿ CrudRepositoryï¼Œå®ç°äº†ä¸€ç»„åˆ†é¡µæ’åºç›¸å…³çš„æ–¹æ³•</li> <li>JpaRepositoryï¼š ç»§æ‰¿ PagingAndSortingRepositoryï¼Œå®ç°ä¸€ç»„ JPA è§„èŒƒç›¸å…³çš„æ–¹æ³•</li></ul> <p>ElasticSearch ä¹Ÿæœ‰ä¸€ä¸ª <code>Repository</code> æ¥å£ï¼š<code>ElasticsearchRepository</code>ï¼Œè¯¥æ¥å£å·²ç»å†…ç½®ä¸€äº›åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿å®ƒï¼Œå°±å¯ä»¥ä½¿ç”¨æ–¹æ³•äº†ï¼Œå½“ç„¶ï¼Œå®ƒåªèƒ½è¿›è¡Œä¸€äº›ç®€å•çš„æ“ä½œï¼Œå¤æ‚çš„æ“ä½œéœ€è¦è‡ªå®šä¹‰å®ç°ï¼Œä¹Ÿä¸éš¾ï¼Œå› ä¸ºå®˜ç½‘æä¾›äº†è§„èŒƒæ¨¡æ¿ã€‚</p> <p>åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿ <code>ElasticsearchRepository</code> æ¥å£</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>repository</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchRepository</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 18:49
 * @description åŸºç¡€ ES å°è£…ç±»ï¼Œè‡ªå¸¦å¾ˆå¤šæ–¹æ³•
 * Productï¼šç´¢å¼•çš„å®ä½“ç±»
 * Integerï¼šä¸»é”® ID ç±»å‹
 */</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>è¯¥æ¥å£æ˜¯ä¸€ä¸ªæ³›å‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç´¢å¼•çš„å®ä½“ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸»é”® Id çš„ç±»å‹ï¼Œç”¨è¿‡ mybatis-plus åº”è¯¥éå¸¸ç†Ÿæ‚‰æ¥ä¸‹æ¥çš„æ“ä½œã€‚</p> <p>æµ‹è¯•ä»£ç ï¼š</p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token keyword" data-v-4f1e9d0c>package</span> <span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt</span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt<span class="token punctuation" data-v-4f1e9d0c>.</span>repository<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>ProductRepository</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>com<span class="token punctuation" data-v-4f1e9d0c>.</span>kbt<span class="token punctuation" data-v-4f1e9d0c>.</span>pojo<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Product</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>junit<span class="token punctuation" data-v-4f1e9d0c>.</span>jupiter<span class="token punctuation" data-v-4f1e9d0c>.</span>api<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Test</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>beans<span class="token punctuation" data-v-4f1e9d0c>.</span>factory<span class="token punctuation" data-v-4f1e9d0c>.</span>annotation<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Autowired</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>boot<span class="token punctuation" data-v-4f1e9d0c>.</span>test<span class="token punctuation" data-v-4f1e9d0c>.</span>context<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>SpringBootTest</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>domain<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Page</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>domain<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>PageRequest</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>org<span class="token punctuation" data-v-4f1e9d0c>.</span>springframework<span class="token punctuation" data-v-4f1e9d0c>.</span>data<span class="token punctuation" data-v-4f1e9d0c>.</span>domain<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>Sort</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>java<span class="token punctuation" data-v-4f1e9d0c>.</span>util<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>ArrayList</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>
<span class="token keyword" data-v-4f1e9d0c>import</span> <span class="token import" data-v-4f1e9d0c><span class="token namespace" data-v-4f1e9d0c>java<span class="token punctuation" data-v-4f1e9d0c>.</span>util<span class="token punctuation" data-v-4f1e9d0c>.</span></span><span class="token class-name" data-v-4f1e9d0c>List</span></span><span class="token punctuation" data-v-4f1e9d0c>;</span>

<span class="token comment" data-v-4f1e9d0c>/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 18:51
 * @description ES Repository æµ‹è¯•ç±»
 */</span>
<span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ–°å¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åä¸ºæ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * ä¿®æ”¹
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>update</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å°ç±³ 2 æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>9999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * æ ¹æ® id æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findById</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findById</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ‰€æœ‰
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Iterable</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> products <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>:</span> products<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>

    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ‰¹é‡æ–°å¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>saveAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> productList <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>ArrayList</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>int</span> i <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span> i <span class="token operator" data-v-4f1e9d0c>&lt;</span> <span class="token number" data-v-4f1e9d0c>10</span><span class="token punctuation" data-v-4f1e9d0c>;</span> i<span class="token operator" data-v-4f1e9d0c>++</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span>i<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;[&quot;</span><span class="token operator" data-v-4f1e9d0c>+</span>i<span class="token operator" data-v-4f1e9d0c>+</span><span class="token string" data-v-4f1e9d0c>&quot;]å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1999.0</span><span class="token operator" data-v-4f1e9d0c>+</span>i<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;http://www.youngkbt/xm.jpg&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            productList<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>saveAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span>productList<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findByPageable</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æ’åº(æ’åºæ–¹å¼ï¼Œæ­£åºè¿˜æ˜¯å€’åºï¼Œæ’åºçš„ id)</span>
        <span class="token class-name" data-v-4f1e9d0c>Sort</span> sort <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>Sort</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>by</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Sort<span class="token punctuation" data-v-4f1e9d0c>.</span>Direction</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DESC<span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;id&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> currentPage <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span>  <span class="token comment" data-v-4f1e9d0c>//å½“å‰é¡µï¼Œç¬¬ä¸€é¡µä» 0 å¼€å§‹ï¼Œ1 è¡¨ç¤ºç¬¬äºŒé¡µ</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> pageSize <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>5</span><span class="token punctuation" data-v-4f1e9d0c>;</span>  <span class="token comment" data-v-4f1e9d0c>//æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æŸ¥è¯¢åˆ†é¡µ</span>
        <span class="token class-name" data-v-4f1e9d0c>PageRequest</span> pageRequest <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>PageRequest</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>of</span><span class="token punctuation" data-v-4f1e9d0c>(</span>currentPage<span class="token punctuation" data-v-4f1e9d0c>,</span> pageSize<span class="token punctuation" data-v-4f1e9d0c>,</span>sort<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//åˆ†é¡µæŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>Page</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> productPage <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span>pageRequest<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span> <span class="token class-name" data-v-4f1e9d0c>Product</span> <span class="token operator" data-v-4f1e9d0c>:</span> productPage<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getContent</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>42</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>43</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>44</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>45</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>46</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>47</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>48</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>49</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>50</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>51</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>52</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>53</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>54</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>55</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>56</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>57</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>58</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>59</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>60</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>61</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>62</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>63</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>64</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>65</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>66</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>67</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>68</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>69</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>70</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>71</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>72</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>73</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>74</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>75</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>76</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>77</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>78</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>79</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>80</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>81</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>82</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>83</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>84</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>85</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>86</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>87</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>88</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>89</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>90</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>91</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>92</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>93</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>94</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>95</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>96</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>97</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>98</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>99</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>100</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>101</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>102</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>103</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>104</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>105</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>106</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>107</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>108</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>109</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>110</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>111</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>112</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>113</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>114</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>115</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>116</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>117</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ–°å¢æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åä¸ºæ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * ä¿®æ”¹æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>update</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å°ç±³ 2 æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>9999.0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>save</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ ¹æ® id æŸ¥è¯¢æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findById</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findById</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ‰€æœ‰æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Iterable</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> products <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>:</span> products<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
   <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ‰¹é‡æ–°å¢æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>saveAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>List</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> productList <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>ArrayList</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>int</span> i <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span> i <span class="token operator" data-v-4f1e9d0c>&lt;</span> <span class="token number" data-v-4f1e9d0c>10</span><span class="token punctuation" data-v-4f1e9d0c>;</span> i<span class="token operator" data-v-4f1e9d0c>++</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>Product</span> product <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setId</span><span class="token punctuation" data-v-4f1e9d0c>(</span>i<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setTitle</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;[&quot;</span><span class="token operator" data-v-4f1e9d0c>+</span>i<span class="token operator" data-v-4f1e9d0c>+</span><span class="token string" data-v-4f1e9d0c>&quot;]å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setCategory</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ‰‹æœº&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setPrice</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>1999.0</span><span class="token operator" data-v-4f1e9d0c>+</span>i<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            product<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setImages</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;http://www.youngkbt/xm.jpg&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            productList<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span>product<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
        productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>saveAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span>productList<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESProductRepositoryTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>

    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>ProductRepository</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæŸ¥è¯¢æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>findByPageable</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æ’åº(æ’åºæ–¹å¼ï¼Œæ­£åºè¿˜æ˜¯å€’åºï¼Œæ’åºçš„ id)</span>
        <span class="token class-name" data-v-4f1e9d0c>Sort</span> sort <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>Sort</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>by</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Sort<span class="token punctuation" data-v-4f1e9d0c>.</span>Direction</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DESC<span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;id&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> currentPage <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>;</span>  <span class="token comment" data-v-4f1e9d0c>//å½“å‰é¡µï¼Œç¬¬ä¸€é¡µä» 0 å¼€å§‹ï¼Œ1 è¡¨ç¤ºç¬¬äºŒé¡µ</span>
        <span class="token keyword" data-v-4f1e9d0c>int</span> pageSize <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token number" data-v-4f1e9d0c>5</span><span class="token punctuation" data-v-4f1e9d0c>;</span>  <span class="token comment" data-v-4f1e9d0c>//æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®æŸ¥è¯¢åˆ†é¡µ</span>
        <span class="token class-name" data-v-4f1e9d0c>PageRequest</span> pageRequest <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>PageRequest</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>of</span><span class="token punctuation" data-v-4f1e9d0c>(</span>currentPage<span class="token punctuation" data-v-4f1e9d0c>,</span> pageSize<span class="token punctuation" data-v-4f1e9d0c>,</span>sort<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//åˆ†é¡µæŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>Page</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> productPage <span class="token operator" data-v-4f1e9d0c>=</span> productRepository<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>findAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span>pageRequest<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span> <span class="token class-name" data-v-4f1e9d0c>Product</span> <span class="token operator" data-v-4f1e9d0c>:</span> productPage<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getContent</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Product</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <h3 id="repositoryç±»è‡ªå®šä¹‰æµ‹è¯•"><a href="#repositoryç±»è‡ªå®šä¹‰æµ‹è¯•" class="header-anchor">#</a> Repositoryç±»è‡ªå®šä¹‰æµ‹è¯•</h3> <p>Spring Data çš„ Repository æ¥å£æä¾›äº†ä¸€ç§å£°æ˜å¼çš„æ•°æ®æ“ä½œè§„èŒƒï¼Œæ— åºç¼–å†™ä»»ä½•ä»£ç ï¼Œåªéœ€éµå¾ª Spring Data çš„æ–¹æ³•å®šä¹‰è§„èŒƒå³å¯å®Œæˆæ•°æ®çš„æ“ä½œã€‚</p> <p>ES çš„ Repository åªæœ‰åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œæ²¡æœ‰èšåˆæŸ¥è¯¢ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®˜æ–¹æä¾›çš„è‡ªå®šä¹‰æ–¹æ³•ã€‚å¹¶ä¸”å®˜æ–¹æœ‰å‘½åè§„èŒƒ</p> <p>è‡ªå®šä¹‰æ•°æ®æ“ä½œæ–¹æ³•éœ€è¦éµå¾ª Repository è§„èŒƒï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <table><thead><tr><th>å…³é”®è¯</th> <th>æ–¹æ³•å</th> <th>Elasticsearch æŸ¥è¯¢å­—ç¬¦ä¸²</th></tr></thead> <tbody><tr><td>And</td> <td>findByNameAndPrice</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;name&quot; ] } }, { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;price&quot; ] } } ] } }}</td></tr> <tr><td>Or</td> <td>findByNameOrPrice</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;should&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;name&quot; ] } }, { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;price&quot; ] } } ] } }}</td></tr> <tr><td>Is</td> <td>findByName</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;name&quot; ] } } ] } }}</td></tr> <tr><td>Not</td> <td>findByNameNot</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must_not&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?&quot;, &quot;fields&quot; : [ &quot;name&quot; ] } } ] } }}</td></tr> <tr><td>Between</td> <td>findByPriceBetween</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?, &quot;to&quot; : ?, &quot;include_lower&quot; : true, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>LessThan</td> <td>findByPriceLessThan</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null, &quot;to&quot; : ?, &quot;include_lower&quot; : true, &quot;include_upper&quot; : false } } } ] } }}</td></tr> <tr><td>LessThanEqual</td> <td>findByPriceLessThanEqual</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null, &quot;to&quot; : ?, &quot;include_lower&quot; : true, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>GreaterThan</td> <td>findByPriceGreaterThan</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?, &quot;to&quot; : null, &quot;include_lower&quot; : false, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>GreaterThanEqual</td> <td>findByPriceGreaterThan</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?, &quot;to&quot; : null, &quot;include_lower&quot; : true, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>Before</td> <td>findByPriceBefore</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null, &quot;to&quot; : ?, &quot;include_lower&quot; : true, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>After</td> <td>findByPriceAfter</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?, &quot;to&quot; : null, &quot;include_lower&quot; : true, &quot;include_upper&quot; : true } } } ] } }}</td></tr> <tr><td>Like</td> <td>findByNameLike</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?*&quot;, &quot;fields&quot; : [ &quot;name&quot; ] }, &quot;analyze_wildcard&quot;: true } ] } }}</td></tr> <tr><td>StartingWith</td> <td>findByNameStartingWith</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;?*&quot;, &quot;fields&quot; : [ &quot;name&quot; ] }, &quot;analyze_wildcard&quot;: true } ] } }}</td></tr> <tr><td>EndingWith</td> <td>findByNameEndingWith</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;*?&quot;, &quot;fields&quot; : [ &quot;name&quot; ] }, &quot;analyze_wildcard&quot;: true } ] } }}</td></tr> <tr><td>Contains/Containing</td> <td>findByNameContaining</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;<em>?</em>&quot;, &quot;fields&quot; : [ &quot;name&quot; ] }, &quot;analyze_wildcard&quot;: true } ] } }}</td></tr> <tr><td>In</td> <td>findByNameIn(Collectionnames)</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;bool&quot; : {&quot;must&quot; : [ {&quot;terms&quot; : {&quot;name&quot; : [&quot;?&quot;,&quot;?&quot;]}} ] } } ] } }}</td></tr> <tr><td>NotIn</td> <td>findByNameNotIn(Collectionnames)</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ {&quot;bool&quot; : {&quot;must_not&quot; : [ {&quot;terms&quot; : {&quot;name&quot; : [&quot;?&quot;,&quot;?&quot;]}} ] } } ] } }}</td></tr> <tr><td>Near</td> <td>findByStoreNear</td> <td>Not Supported Yet !ï¼ˆä¸æ”¯æŒäº†ï¼‰</td></tr> <tr><td>True</td> <td>findByAvailableTrue</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;true&quot;, &quot;fields&quot; : [ &quot;available&quot; ] } } ] } }}</td></tr> <tr><td>False</td> <td>findByAvailableFalse</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;false&quot;, &quot;fields&quot; : [ &quot;available&quot; ] } } ] } }}</td></tr> <tr><td>OrderBy</td> <td>findByAvailableTrueOrderByNameDesc</td> <td>{ &quot;query&quot; : { &quot;bool&quot; : { &quot;must&quot; : [ { &quot;query_string&quot; : { &quot;query&quot; : &quot;true&quot;, &quot;fields&quot; : [ &quot;available&quot; ] } } ] } }, &quot;sort&quot;:[{&quot;name&quot;:{&quot;order&quot;:&quot;desc&quot;}}] }</td></tr></tbody></table> <p>çœ‹ä¸æ‡‚ä»€ä¹ˆæ„æ€å—ï¼Ÿä¸‹é¢æ¥çœ‹çœ‹ç¤ºä¾‹ï¼Œç„¶åå›å¤´çœ‹è¡¨æ ¼å°±æ˜ç™½äº†ã€‚</p> <blockquote><p><strong>éœ€æ±‚ 1ï¼šä¸æƒ³é€šè¿‡ id æŸ¥è¯¢ æ•°æ®ï¼Œæƒ³é€šè¿‡å…¶ä»–å­—æ®µå¦‚ category æŸ¥è¯¢æ•°æ®</strong></p></blockquote> <blockquote><p><strong>éœ€æ±‚2ï¼šæ—¢æƒ³æŸ¥è¯¢å•†å“åˆ†ç±»å categoryï¼Œåˆæƒ³æŸ¥è¯¢å•†å“ä»·æ ¼ price çš„æ•°æ®</strong></p></blockquote> <p>é¦–å…ˆåœ¨è‡ªå®šä¹‰çš„ <code>Repository</code> ç±»ä»£ç æŒ‰ç…§è§„èŒƒå†™ä»£ç ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">// éœ€æ±‚ 1</span>
   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> <span class="token function">findProductByCategory</span><span class="token punctuation">(</span><span class="token class-name">String</span> category<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// éœ€æ±‚ 2</span>
   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> <span class="token function">findProductByCategoryAndPrice</span><span class="token punctuation">(</span><span class="token class-name">String</span> category<span class="token punctuation">,</span> <span class="token class-name">Double</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¯ä»¥çœ‹å‡ºæ ¹æ®è§„èŒƒï¼Œæœ‰ findXxxByXxxã€findXxxByXxxAndXxxã€findXxxByXxxOrXxxç­‰æ ¼å¼ï¼Œå…¶å®ç”¨ Ideal å·¥å…·ï¼Œè¾“å…¥ findï¼Œå®ƒå°±ä¼šå¼¹å‡ºå¾ˆå¤šçš„æç¤ºä¿¡æ¯ã€‚</p> <div class="custom-block note"><p class="custom-block-title">ç¬”è®°</p> <p>åªéœ€è¦å†™æ¥å£æ–¹æ³•ï¼Œä¸éœ€è¦å†™è¿™äº›æ–¹æ³•å®ç°ï¼Œå› ä¸º ES å·²ç»å†™å¥½äº†ï¼Œåªä¸è¿‡æ²¡æœ‰æ”¾åœ¨ <code>ElasticsearchRepository</code> æ¥å£ï¼Œåªéœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰å†™å‡ºæ¥ã€‚</p> <div class="custom-block right"><p>2021-11-17 @Jonas Wolfxin</p></div></div> <p>æµ‹è¯•ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kbt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">ProductRepository</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 19:07
 * @description ES è‡ªå®šä¹‰ Repository æµ‹è¯•ç±»
 */</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ESSearchTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductRepository</span> productRepository<span class="token punctuation">;</span>

    <span class="token comment">/**
     * é€šè¿‡æŸä¸ªå­—æ®µæŸ¥è¯¢æ•°æ®
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">docQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> productList <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findProductByCategory</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> product <span class="token operator">:</span> productList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * term æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> productList <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findProductByCategoryAndPrice</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span> <span class="token number">2004.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> p <span class="token operator">:</span> productList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h3> <p>å°è£…ç±»çš„é€»è¾‘æ›´è¶‹å‘äºåŸç”Ÿ APIï¼Œéœ€è¦è¿‡ç¡¬çš„é€»è¾‘æ­¥éª¤å»å®Œæˆ ES æ“ä½œã€‚</p> <p>Repository ç±»å®Œå…¨ä¾èµ–æ¡†æ¶ï¼Œç®€å•çš„ä»£ç å°±å¯ä»¥å®ç°ä¸°å¯Œçš„æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰è¿‡å¤šçš„é€»è¾‘ï¼Œå®¹æ˜“å˜æˆ CURD å·¥ç¨‹å¸ˆï¼Œå³æ ¹æœ¬ä¸çŸ¥é“å†…éƒ¨çš„é€»è¾‘å’ŒåŸç†ã€‚</p> <h2 id="spring-bootæ¡†æ¶é›†æˆ"><a href="#spring-bootæ¡†æ¶é›†æˆ" class="header-anchor">#</a> Spring Bootæ¡†æ¶é›†æˆ</h2> <h3 id="spring-bootä»‹ç»"><a href="#spring-bootä»‹ç»" class="header-anchor">#</a> Spring Bootä»‹ç»</h3> <p>Spring æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼ŒSpring æ˜¯äº 2003 å¹´å…´èµ·çš„ä¸€ä¸ªè½»é‡çº§çš„ Java å¼€å‘æ¡†æ¶ï¼Œç”± Rod Johnson åœ¨å…¶è‘—ä½œã€ŠExpert One-On-One J2EE Development and Designã€‹ã€‚Spring æ˜¯ä¸ºäº†è§£å†³ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ï¼Œä½¿ç”¨ Spring å¯ä»¥è®©ç®€å•çš„ JavaBean å®ç°ä¹‹å‰åªæœ‰ EJB æ‰èƒ½å®Œæˆçš„äº‹æƒ…ã€‚ä½†æ˜¯ Spring ä¸ä»…ä»…å±€é™äºæœåŠ¡å™¨ç«¯å¼€å‘ï¼Œä»»ä½• Java åº”ç”¨éƒ½èƒ½åœ¨ç®€å•æ€§ã€å¯æµ‹è¯•æ€§å’Œæ¾è€¦åˆæ€§ç­‰æ–¹é¢ä» Spring ä¸­è·ç›Šã€‚</p> <p>Spring Boot æ˜¯æ‰€æœ‰åŸºäº Spring å¼€å‘çš„é¡¹ç›®çš„èµ·ç‚¹ã€‚Spring Boot çš„è®¾è®¡æ˜¯ä¸ºäº†è®©ä½ å°½å¯èƒ½å¿«çš„è·‘èµ·æ¥ Spring åº”ç”¨ç¨‹åºå¹¶ä¸”å°½å¯èƒ½å‡å°‘ä½ çš„é…ç½®æ–‡ä»¶ã€‚ç®€å•æ¥è¯´å°±æ˜¯ Spring Boot å…¶å®ä¸æ˜¯ä»€ä¹ˆæ–°çš„æ¡†æ¶ï¼Œå®ƒé»˜è®¤é…ç½®äº†å¾ˆå¤šæ¡†æ¶çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±åƒ Maven æ•´åˆäº†å¤§éƒ¨åˆ†çš„ jar åŒ…ï¼ŒSpring Boot æ•´åˆäº†å¤§éƒ¨åˆ†çš„æ¡†æ¶</p> <h3 id="springbootçš„ç‰¹ç‚¹"><a href="#springbootçš„ç‰¹ç‚¹" class="header-anchor">#</a> SpringBootçš„ç‰¹ç‚¹</h3> <ul><li><p>ä¸ºåŸºäº Spring çš„å¼€å‘æä¾›æ›´å¿«çš„å…¥é—¨ä½“éªŒ</p></li> <li><p>å¼€ç®±å³ç”¨ï¼Œæ²¡æœ‰ä»£ç ç”Ÿæˆï¼Œä¹Ÿæ— éœ€ XML é…ç½®ã€‚åŒæ—¶ä¹Ÿå¯ä»¥ä¿®æ”¹é»˜è®¤å€¼æ¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚</p></li> <li><p>æä¾›äº†ä¸€äº›å¤§å‹é¡¹ç›®ä¸­å¸¸è§çš„éåŠŸèƒ½æ€§ç‰¹æ€§ï¼Œå¦‚åµŒå…¥å¼æœåŠ¡å™¨ã€å®‰å…¨ã€æŒ‡æ ‡ï¼Œå¥åº·æ£€æµ‹ã€å¤–éƒ¨é…ç½®ç­‰</p></li> <li><p>SpringBoot ä¸æ˜¯å¯¹ Spring åŠŸèƒ½ä¸Šçš„å¢å¼ºï¼Œè€Œæ˜¯æä¾›äº†ä¸€ç§å¿«é€Ÿä½¿ç”¨ Spring çš„æ–¹å¼</p></li></ul> <h3 id="dataæ¡†æ¶å’Œbootæ¡†æ¶é›†æˆåŒºåˆ«"><a href="#dataæ¡†æ¶å’Œbootæ¡†æ¶é›†æˆåŒºåˆ«" class="header-anchor">#</a> Dataæ¡†æ¶å’ŒBootæ¡†æ¶é›†æˆåŒºåˆ«</h3> <p>å…¶å®  <a href="#spring-data%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90">Spring Data æ¡†æ¶é›†æˆ</a> ä¸­ï¼Œå·²ç»ä½¿ç”¨äº† Spring Bootï¼Œæœ¬å†…å®¹çš„æ¡†æ¶é›†æˆæŒ‡çš„æ˜¯å•çº¯å°† Spring Bootå’Œ ElasticSearch æ•´åˆï¼Œæ²¡æœ‰ç”¨åˆ° Spring Data æ¡†æ¶çš„ Repository ä»¥åŠ ElasticsearchOperations æ¥å£ã€‚</p> <p>ä¸¤ä¸ªæ¡†æ¶é›†æˆçš„ <strong>åŒºåˆ«</strong> å°±åœ¨äº Spring Data å¯¹äº ES çš„æ“ä½œå°è£…æ›´åŠ å½»åº•ï¼Œå®ä½“ç±»å¯ä»¥å†™æ³¨è§£è¿›è¡Œæ˜ å°„å’Œé…ç½®ç´¢å¼•åç­‰ï¼Œå¹¶ä¸”æ”¯æŒ Spring Bootã€‚è€Œ Spring Boot æ¡†æ¶é›†æˆåˆ™æ˜¯å°† Spring Boot æ¡†æ¶å’Œ ES çš„ Java API è¿›è¡Œé›†æˆã€‚ä¸æ‡‚ Java API çš„å¯ä»¥å»çœ‹ <a href="/es/java-curd/">ElasticSearch - Javaæ“ä½œ</a></p> <p>ä¸¤ä¸ªæ¡†æ¶é›†æˆçš„ <strong>é€‰æ‹©</strong> å»ºè®®é€‰æ‹© Spring Data æ¡†æ¶é›†æˆï¼Œå®ƒå°è£…çš„æ›´åŠ å½»åº•ï¼Œè®©ä½ å‡ è¡Œä»£ç å°±èƒ½æ‰§è¡Œ ES çš„å¤§éƒ¨åˆ†æ“ä½œï¼Œå½“ç„¶ï¼Œå› ä¸ºæ“ä½œè¿‡äºç®€å•ï¼Œå®ƒç‰ºç‰²äº†æ­¥éª¤é€»è¾‘ã€‚å¦‚æœæƒ³äº†è§£æ­¥éª¤é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ Spring Boot æ¡†æ¶é›†æˆï¼Œè™½ç„¶ä½¿ç”¨ç¹çï¼Œä»£ç æ­¥éª¤é‡å¤ï¼Œä½†æ˜¯æ“ä½œèµ·æ¥å’Œ Kibana ã€ Postman çš„æ“ä½œé€»è¾‘æ›´åŠ å»åˆã€‚</p> <p><strong>æ€»ç»“</strong>ï¼šSpring Data æ¡†æ¶é›†æˆæ“ä½œç®€å•ï¼Œå¿«é€Ÿå¼€å‘ï¼Œç‰ºç‰²æ­¥éª¤é€»è¾‘ï¼Œå¯ä½¿ç”¨ Spring Boot æ¡†æ¶é›†æˆè¿›è¡Œè¾…åŠ©å¼€å‘ï¼Œç±»ä¼¼äº <code>Mybatis</code>ï¼›Spring Boot æ¡†æ¶é›†æˆæ“ä½œç¹çï¼Œé€»è¾‘æ­¥éª¤é‡å¤ï¼Œç±»ä¼¼äº<code>åŸç”Ÿ JDBC</code>ã€‚</p> <h3 id="æ¡†æ¶æ­å»º-2"><a href="#æ¡†æ¶æ­å»º-2" class="header-anchor">#</a> æ¡†æ¶æ­å»º</h3> <ul><li><p>æ–°å»ºä¸€ä¸ª Maven é¡¹ç›®</p></li> <li><p>ä¿®æ”¹ pom æ–‡ä»¶ï¼Œå¢åŠ ä¾èµ–</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--ES å®¢æˆ·ç«¯--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.15.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.15.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.9.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>ES å®¢æˆ·ç«¯çš„ä¾èµ–ç‰ˆæœ¬è¦å’Œ ES æœåŠ¡å™¨ç‰ˆæœ¬ä¸€è‡´</p></li> <li><p>æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œåœ¨ resources ç›®å½•ä¸­å¢åŠ  application.yml æ–‡ä»¶</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> es<span class="token punctuation">-</span>springboot
<span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
  <span class="token key atrule">host-list</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">9200</span>  <span class="token comment"># å¤šä¸ªèŠ‚ç‚¹ç”¨é€—å·åˆ†éš”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>ES é…ç½®ç±»ï¼Œè¿›è¡Œåœ°å€å’Œç«¯å£çš„é…ç½®</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kbt<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/17 17:33
 * @description ElasticSearch é…ç½®ç±»
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ElasticSearchConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.host-list}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> hostList<span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­æ•°æ®æº</span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>destroyMethod <span class="token operator">=</span> <span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// éå†è·å– application.yml æ–‡ä»¶çš„åœ°å€ç«¯å£ï¼Œé€—å·éš”å¼€</span>
    <span class="token keyword">public</span> <span class="token class-name">RestHighLevelClient</span> <span class="token function">restHighLevelClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> hostList<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HttpHost</span><span class="token punctuation">[</span><span class="token punctuation">]</span> httpHostsArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">[</span>split<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> split<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> item <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            httpHostsArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span><span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>httpHostsArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div></li></ul> <div class="custom-block note"><p class="custom-block-title">ä¸¤ä¸ªæ¡†æ¶æ­å»ºåŒºåˆ«</p> <p>å¢åŠ  application.yml æ–‡ä»¶å’Œæ·»åŠ  ES é…ç½®ç±»å®Œå…¨å¯ä»¥æŒ‰ç…§ Spring Data æ¡†æ¶é›†æˆçš„è¿›è¡Œæ­å»ºï¼Œå®ƒçš„ ES åœ°å€å’Œç«¯å£åœ¨é…ç½®ç±»è¿›è¡Œé…ç½®ï¼Œä¸æ¶‰åŠ application.yml æ–‡ä»¶ã€‚</p> <p>è¿™é‡Œä¸»è¦æ¼”ç¤ºåœ¨ application.yml æ–‡ä»¶æ·»åŠ  ES åœ°å€å’Œç«¯å£ï¼Œç„¶ååœ¨ ES é…ç½®ç±»è¿›è¡Œéå†è·å–ã€‚</p> <p>ä¸¤ä¸ªæ­å»ºæ ¹æ®éœ€æ±‚è‡ªè¡Œé€‰æ‹©ã€‚</p> <div class="custom-block right"><p>2021-11-18 @Jonas Wolfxin</p></div></div> <ul><li><p>æ·»åŠ å®ä½“ç±»ï¼Œæ²¡æœ‰é›†æˆ Spring Data æ¡†æ¶ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨æ³¨è§£è¿›è¡Œæ˜ å°„è®¾ç½®ï¼Œåªèƒ½åœ¨å‘é€è¯·æ±‚ç»™ ES æ—¶ï¼Œè¿›è¡Œæ˜ å°„è®¾ç½®</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * ç”¨æˆ·å
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token comment">/**
     * å¹´é¾„
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token comment">/**
     * æ€§åˆ«
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token class-name">String</span> sex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// set</span>
    <span class="token comment">// get</span>
    <span class="token comment">// toString</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>è¯·åŠ å…¥ Set å’Œ Get å’Œ toString æ–¹æ³•ï¼ŒtoString æ–¹æ³•æ˜¯ä¸ºäº†æµ‹è¯•æœŸé—´ç›´æ¥æ‰“å°åœ¨æ§åˆ¶å°ã€‚</p></li></ul> <h3 id="è¿æ¥æµ‹è¯•"><a href="#è¿æ¥æµ‹è¯•" class="header-anchor">#</a> è¿æ¥æµ‹è¯•</h3> <p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦æˆåŠŸè¿æ¥äº† ES æœåŠ¡å™¨</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author Jonas Wolfxin
 * @date 2021/11/18 12:41
 * @description æ˜¯å¦è¿æ¥ ES å®¢æˆ·ç«¯æµ‹è¯•ç±»
 */</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ESClientTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testESClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å¦‚æœè¿”å› <code>RestHighLevelClient</code> çš„åœ°å€ï¼Œåˆ™è¯´æ˜æˆåŠŸï¼Œå¦‚ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span>RestHighLevelClient</span><span class="token annotation punctuation">@7a904f32</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ç´¢å¼•æµ‹è¯•"><a href="#ç´¢å¼•æµ‹è¯•" class="header-anchor">#</a> ç´¢å¼•æµ‹è¯•</h3> <p>ç´¢å¼•çš„ CRD ä»£ç å¦‚ä¸‹ï¼š</p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ›å»ºç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>createIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>CreateIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>CreateIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>CreateIndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>create</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>boolean</span> acknowledged <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isAcknowledged</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºç´¢å¼•çŠ¶æ€ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> acknowledged<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     *æŸ¥çœ‹ç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>GetIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>GetIndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•åˆ«åï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getAliases</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•æ˜ å°„ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMappings</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•é…ç½®ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSettings</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤ç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>deleteIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>AcknowledgedResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ é™¤çŠ¶æ€ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isAcknowledged</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ›å»ºç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>createIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>CreateIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>CreateIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>CreateIndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>create</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>boolean</span> acknowledged <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isAcknowledged</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºç´¢å¼•çŠ¶æ€ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> acknowledged<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     *æŸ¥çœ‹ç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>GetIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>GetIndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•åˆ«åï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getAliases</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•æ˜ å°„ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMappings</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç´¢å¼•é…ç½®ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSettings</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤ç´¢å¼•
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>deleteIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºç´¢å¼•çš„è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteIndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteIndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>AcknowledgedResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ é™¤çŠ¶æ€ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isAcknowledged</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <h3 id="æ–‡æ¡£æµ‹è¯•"><a href="#æ–‡æ¡£æµ‹è¯•" class="header-anchor">#</a> æ–‡æ¡£æµ‹è¯•</h3> <p>å…³äºæ–‡æ¡£çš„ CURD ä»£ç å¦‚ä¸‹ï¼š</p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ’å…¥æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>createDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>User</span> user <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setUsername</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å¯ä¹&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setAge</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>18</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setSex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span> objectMapper <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span> userJsonStr <span class="token operator" data-v-4f1e9d0c>=</span> objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span>user<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ·»åŠ æ–‡æ¡£æ•°æ®ï¼Œæ•°æ®æ ¼å¼ä¸º Json æ ¼å¼</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>userJsonStr<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getResult</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>deleteDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”å†…å®¹ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>toString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * æ‰¹é‡åˆ é™¤æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>batchDeleteDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1002&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1003&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1004&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1005&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>bulk</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//æ‰“å°ç»“æœä¿¡æ¯</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´:&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºè¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>GetRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * ä¿®æ”¹æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>upadateDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>UpdateRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>UpdateRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//  è®¾ç½®è¯·æ±‚ä½“ï¼Œå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>doc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;sex&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>UpdateResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>update</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ä¿®æ”¹çš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getResult</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>42</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>43</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>44</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>45</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>46</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>47</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>48</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>49</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>50</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>51</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>52</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>53</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>54</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>55</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>56</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>57</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>58</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>59</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>60</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>61</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>62</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>63</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>64</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>65</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>66</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>67</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>68</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>69</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>70</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>71</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>72</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>73</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>74</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>75</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>76</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>77</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>78</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>79</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>80</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>81</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>82</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>83</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>84</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>85</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>86</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ’å…¥æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>createDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>User</span> user <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setUsername</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å¯ä¹&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setAge</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>18</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        user<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>setSex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span> objectMapper <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span> userJsonStr <span class="token operator" data-v-4f1e9d0c>=</span> objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span>user<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ·»åŠ æ–‡æ¡£æ•°æ®ï¼Œæ•°æ®æ ¼å¼ä¸º Json æ ¼å¼</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>userJsonStr<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>IndexResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getResult</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ‰¹é‡æ·»åŠ æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>batchCreateDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span> objectMapper <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>ObjectMapper</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæ•°æ®å¯¹è±¡</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å¯ä¹&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>18</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1002&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å†°ç³–&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>20</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;å¥³&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1003&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;é›ªæ¢¨&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>22</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;å¥³&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1004&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;é…¸æ©™&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>24</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>IndexRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1005&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>objectMapper<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>writeValueAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>User</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;èœœæ¡ƒ&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token number" data-v-4f1e9d0c>30</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;å¥³&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>bulk</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„å†…å®¹ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> <span class="token class-name" data-v-4f1e9d0c>Arrays</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>toString</span><span class="token punctuation" data-v-4f1e9d0c>(</span>response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getItems</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ é™¤æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>deleteDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>DeleteResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>delete</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”å†…å®¹ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>toString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ‰¹é‡åˆ é™¤æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>batchDeleteDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>BulkRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1002&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1003&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1004&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>add</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>DeleteRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1005&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>BulkResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>bulk</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//æ‰“å°ç»“æœä¿¡æ¯</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´:&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºè¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>GetRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>GetResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>get</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æŸ¥è¯¢çš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * ä¿®æ”¹æ–‡æ¡£æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>upadateDoc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>UpdateRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>UpdateRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// é…ç½®ä¿®æ”¹å‚æ•°</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>index</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>id</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;1001&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//  è®¾ç½®è¯·æ±‚ä½“ï¼Œå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>doc</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>XContentType</span><span class="token punctuation" data-v-4f1e9d0c>.</span>JSON<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;sex&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>UpdateResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>update</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ç´¢å¼•ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getIndex</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;åˆ›å»ºçš„ idï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getId</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ä¿®æ”¹çš„ç»“æœï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getResult</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <h3 id="é«˜çº§æŸ¥è¯¢æµ‹è¯•"><a href="#é«˜çº§æŸ¥è¯¢æµ‹è¯•" class="header-anchor">#</a> é«˜çº§æŸ¥è¯¢æµ‹è¯•</h3> <p>é«˜çº§æŸ¥è¯¢ä»£ç å¦‚ä¸‹ï¼š</p> <div class="theme-code-group" data-v-2f5f1757><div class="theme-code-group__nav" data-v-2f5f1757><ul class="theme-code-group__ul" data-v-2f5f1757></ul></div> <div class="theme-code-block theme-code-block__active" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * term æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>termQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>termsQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;20&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;22&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ‰€æœ‰æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
		<span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èŒƒå›´æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>rangeQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
		<span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>RangeQueryBuilder</span> rangeQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>rangeQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¤§äºç­‰äº</span>
        rangeQuery<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>gte</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å°äºç­‰äº</span>
        rangeQuery<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>lte</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;24&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span>rangeQuery<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>pageQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ†é¡µæŸ¥è¯¢</span>
        <span class="token comment" data-v-4f1e9d0c>// å½“å‰é¡µå…¶å®ç´¢å¼•(ç¬¬ä¸€æ¡æ•°æ®çš„é¡ºåºå·)ï¼Œfrom</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>from</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡ size</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>size</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * è¿‡æ»¤æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>filterQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//æŸ¥è¯¢å­—æ®µè¿‡æ»¤</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>[</span><span class="token punctuation" data-v-4f1e9d0c>]</span> excludes <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token punctuation" data-v-4f1e9d0c>{</span><span class="token punctuation" data-v-4f1e9d0c>}</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>[</span><span class="token punctuation" data-v-4f1e9d0c>]</span> includes <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token punctuation" data-v-4f1e9d0c>{</span><span class="token string" data-v-4f1e9d0c>&quot;username&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>}</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fetchSource</span><span class="token punctuation" data-v-4f1e9d0c>(</span>includes<span class="token punctuation" data-v-4f1e9d0c>,</span> excludes<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * Bool æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>boolQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>BoolQueryBuilder</span> boolQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>boolQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¿…é¡»åŒ…å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>must</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;30&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// ä¸€å®šä¸å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>mustNot</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;username&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;å¯ä¹&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¯èƒ½åŒ…å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>should</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;sex&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span>boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ¨¡ç³ŠæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>fuzzyQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fuzzyQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token number" data-v-4f1e9d0c>2</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fuzziness</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Fuzziness</span><span class="token punctuation" data-v-4f1e9d0c>.</span>ONE<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>heightQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
 		<span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 2.åˆ›å»ºæŸ¥è¯¢è¯·æ±‚ä½“æ„å»ºå™¨</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢æ–¹å¼ï¼šé«˜äº®æŸ¥è¯¢</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>termsQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;20&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºé«˜äº®å­—æ®µ</span>
        <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span> highlightBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>preTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;font color='red'&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®æ ‡ç­¾å‰ç¼€</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>postTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;/font&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®æ ‡ç­¾åç¼€</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®é«˜äº®å­—æ®µ</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®é«˜äº®æ„å»ºå¯¹è±¡</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>highlighter</span><span class="token punctuation" data-v-4f1e9d0c>(</span>highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>String</span> sourceAsString <span class="token operator" data-v-4f1e9d0c>=</span> hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceAsString<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token comment" data-v-4f1e9d0c>// æ‰“å°é«˜äº®ç»“æœ</span>
            <span class="token class-name" data-v-4f1e9d0c>Map</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>HighlightField</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> highlightFields <span class="token operator" data-v-4f1e9d0c>=</span> hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHighlightFields</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>highlightFields<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * æ’åºæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>sortQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ’åº</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>sort</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>SortOrder</span><span class="token punctuation" data-v-4f1e9d0c>.</span>ASC<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
     <span class="token comment" data-v-4f1e9d0c>/**
     * èšåˆæŸ¥è¯¢
     * æœ€å¤§å¹´é¾„
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>arrgQuery1</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æœ€å¤§å¹´é¾„</span>
        <span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>aggregation</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>AggregationBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>max</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;maxAge&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>response<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èšåˆæŸ¥è¯¢
     * åˆ†ç»„ç»Ÿè®¡
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>arrgQuery2</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ†ç»„ç»Ÿè®¡</span>
        <span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>aggregation</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>AggregationBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>terms</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ageGroupby&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>response<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>42</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>43</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>44</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>45</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>46</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>47</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>48</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>49</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>50</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>51</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>52</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>53</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>54</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>55</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>56</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>57</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>58</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>59</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>60</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>61</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>62</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>63</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>64</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>65</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>66</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>67</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>68</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>69</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>70</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>71</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>72</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>73</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>74</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>75</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>76</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>77</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>78</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>79</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>80</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>81</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>82</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>83</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>84</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>85</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>86</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>87</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>88</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>89</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>90</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>91</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>92</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>93</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>94</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>95</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>96</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>97</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>98</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>99</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>100</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>101</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>102</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>103</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>104</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>105</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>106</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>107</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>108</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>109</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>110</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>111</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>112</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>113</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>114</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>115</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>116</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>117</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>118</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>119</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>120</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>121</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>122</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>123</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>124</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>125</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>126</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>127</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>128</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>129</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>130</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>131</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>132</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>133</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>134</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>135</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>136</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>137</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>138</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>139</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>140</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>141</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>142</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>143</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>144</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>145</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>146</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>147</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>148</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>149</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>150</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>151</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>152</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>153</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>154</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>155</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>156</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>157</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>158</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>159</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>160</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>161</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>162</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>163</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>164</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>165</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>166</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>167</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>168</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>169</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>170</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>171</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>172</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>173</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>174</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>175</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>176</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>177</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>178</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>179</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>180</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>181</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>182</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>183</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>184</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>185</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>186</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>187</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>188</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>189</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>190</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>191</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>192</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>193</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>194</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>195</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>196</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>197</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>198</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>199</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>200</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>201</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>202</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>203</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>204</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>205</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>206</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>207</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>208</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>209</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>210</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>211</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>212</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>213</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>214</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>215</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>216</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>217</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>218</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>219</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>220</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>221</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>222</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>223</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>224</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>225</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>226</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>227</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>228</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>229</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>230</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>231</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>232</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>233</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>234</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>235</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>236</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>237</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>238</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>239</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>240</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>241</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>242</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>243</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>244</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>245</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>246</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>247</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>248</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>249</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>250</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>251</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>252</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>253</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>254</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>255</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>256</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>257</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>258</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>259</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>260</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>261</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>262</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>263</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>264</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>265</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>266</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>267</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>268</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>269</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>270</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>271</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>272</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>273</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>274</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>275</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>276</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>277</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>278</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>279</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>280</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>281</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>282</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>283</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>284</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>285</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>286</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>287</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>288</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>289</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>290</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>291</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>292</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>293</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * term æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>termQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>termsQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;20&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;22&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æŸ¥è¯¢æ‰€æœ‰æ•°æ®
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>queryAll</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
		<span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èŒƒå›´æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>rangeQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
		<span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>RangeQueryBuilder</span> rangeQuery <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>rangeQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¤§äºç­‰äº</span>
        rangeQuery<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>gte</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å°äºç­‰äº</span>
        rangeQuery<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>lte</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;24&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span>rangeQuery<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * åˆ†é¡µæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>pageQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ†é¡µæŸ¥è¯¢</span>
        <span class="token comment" data-v-4f1e9d0c>// å½“å‰é¡µå…¶å®ç´¢å¼•(ç¬¬ä¸€æ¡æ•°æ®çš„é¡ºåºå·)ï¼Œfrom</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>from</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>0</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡ size</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>size</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token number" data-v-4f1e9d0c>2</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * è¿‡æ»¤æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>filterQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//æŸ¥è¯¢å­—æ®µè¿‡æ»¤</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>[</span><span class="token punctuation" data-v-4f1e9d0c>]</span> excludes <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token punctuation" data-v-4f1e9d0c>{</span><span class="token punctuation" data-v-4f1e9d0c>}</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>[</span><span class="token punctuation" data-v-4f1e9d0c>]</span> includes <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token punctuation" data-v-4f1e9d0c>{</span><span class="token string" data-v-4f1e9d0c>&quot;username&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>}</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fetchSource</span><span class="token punctuation" data-v-4f1e9d0c>(</span>includes<span class="token punctuation" data-v-4f1e9d0c>,</span> excludes<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * Bool æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>boolQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>BoolQueryBuilder</span> boolQueryBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>boolQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¿…é¡»åŒ…å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>must</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;30&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// ä¸€å®šä¸å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>mustNot</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;username&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;å¯ä¹&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// å¯èƒ½åŒ…å«</span>
        boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>should</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;sex&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token string" data-v-4f1e9d0c>&quot;ç”·&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span>boolQueryBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ¨¡ç³ŠæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>fuzzyQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fuzzyQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token number" data-v-4f1e9d0c>2</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>fuzziness</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>Fuzziness</span><span class="token punctuation" data-v-4f1e9d0c>.</span>ONE<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>heightQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
 		<span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 2.åˆ›å»ºæŸ¥è¯¢è¯·æ±‚ä½“æ„å»ºå™¨</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢æ–¹å¼ï¼šé«˜äº®æŸ¥è¯¢</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>termsQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;18&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span><span class="token string" data-v-4f1e9d0c>&quot;20&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºé«˜äº®å­—æ®µ</span>
        <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span> highlightBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>HighlightBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>preTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;font color='red'&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®æ ‡ç­¾å‰ç¼€</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>postTags</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;&lt;/font&gt;&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®æ ‡ç­¾åç¼€</span>
        highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span><span class="token comment" data-v-4f1e9d0c>// è®¾ç½®é«˜äº®å­—æ®µ</span>
        <span class="token comment" data-v-4f1e9d0c>//è®¾ç½®é«˜äº®æ„å»ºå¯¹è±¡</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>highlighter</span><span class="token punctuation" data-v-4f1e9d0c>(</span>highlightBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>//4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
            <span class="token class-name" data-v-4f1e9d0c>String</span> sourceAsString <span class="token operator" data-v-4f1e9d0c>=</span> hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceAsString<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token comment" data-v-4f1e9d0c>// æ‰“å°é«˜äº®ç»“æœ</span>
            <span class="token class-name" data-v-4f1e9d0c>Map</span><span class="token generics" data-v-4f1e9d0c><span class="token punctuation" data-v-4f1e9d0c>&lt;</span><span class="token class-name" data-v-4f1e9d0c>String</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>HighlightField</span><span class="token punctuation" data-v-4f1e9d0c>&gt;</span></span> highlightFields <span class="token operator" data-v-4f1e9d0c>=</span> hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHighlightFields</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>highlightFields<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * æ’åºæŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>sortQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ›å»ºæœç´¢è¯·æ±‚å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ„å»ºæŸ¥è¯¢çš„è¯·æ±‚ä½“</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>query</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>QueryBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>matchAllQuery</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æ’åº</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>sort</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>SortOrder</span><span class="token punctuation" data-v-4f1e9d0c>.</span>ASC<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// æŸ¥è¯¢åŒ¹é…</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å“åº”æ—¶é—´ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTook</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;æ˜¯å¦è¶…æ—¶ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>isTimedOut</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;å‘½ä¸­æ•°é‡ï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getTotalHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;MaxScoreï¼š&quot;</span> <span class="token operator" data-v-4f1e9d0c>+</span> hits<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getMaxScore</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;è¯¦ç»†æ•°æ®ï¼š&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token keyword" data-v-4f1e9d0c>for</span> <span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>SearchHit</span> hit <span class="token operator" data-v-4f1e9d0c>:</span> hits<span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// è¾“å‡ºæ¯æ¡æŸ¥è¯¢çš„ç»“æœä¿¡æ¯</span>
            <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>hit<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getSourceAsString</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token punctuation" data-v-4f1e9d0c>}</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c></div></div></div> <div class="theme-code-block" data-v-4f1e9d0c><div class="language-java line-numbers-mode" data-v-4f1e9d0c><pre class="language-java" data-v-4f1e9d0c><code data-v-4f1e9d0c><span class="token annotation punctuation" data-v-4f1e9d0c>@SpringBootTest</span>
<span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>class</span> <span class="token class-name" data-v-4f1e9d0c>ESIndexTest</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
    
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Autowired</span>
    <span class="token keyword" data-v-4f1e9d0c>private</span> <span class="token class-name" data-v-4f1e9d0c>RestHighLevelClient</span> esClient<span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token comment" data-v-4f1e9d0c>/**
     * èšåˆæŸ¥è¯¢
     * æœ€å¤§å¹´é¾„
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>arrgQuery1</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// æœ€å¤§å¹´é¾„</span>
        <span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>aggregation</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>AggregationBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>max</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;maxAge&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>response<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
    
    <span class="token comment" data-v-4f1e9d0c>/**
     * èšåˆæŸ¥è¯¢
     * åˆ†ç»„ç»Ÿè®¡
     * é«˜äº®æŸ¥è¯¢
     */</span>
    <span class="token annotation punctuation" data-v-4f1e9d0c>@Test</span>
    <span class="token keyword" data-v-4f1e9d0c>public</span> <span class="token keyword" data-v-4f1e9d0c>void</span> <span class="token function" data-v-4f1e9d0c>arrgQuery2</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span> <span class="token keyword" data-v-4f1e9d0c>throws</span> <span class="token class-name" data-v-4f1e9d0c>IOException</span> <span class="token punctuation" data-v-4f1e9d0c>{</span>
        <span class="token comment" data-v-4f1e9d0c>// åˆ†ç»„ç»Ÿè®¡</span>
        <span class="token comment" data-v-4f1e9d0c>// é«˜äº®æŸ¥è¯¢</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span> request <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchRequest</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>indices</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;user&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span> sourceBuilder <span class="token operator" data-v-4f1e9d0c>=</span> <span class="token keyword" data-v-4f1e9d0c>new</span> <span class="token class-name" data-v-4f1e9d0c>SearchSourceBuilder</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>aggregation</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token class-name" data-v-4f1e9d0c>AggregationBuilders</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>terms</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;ageGroupby&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>field</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token string" data-v-4f1e9d0c>&quot;age&quot;</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchResponse</span> response <span class="token operator" data-v-4f1e9d0c>=</span> esClient<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>search</span><span class="token punctuation" data-v-4f1e9d0c>(</span>request<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>source</span><span class="token punctuation" data-v-4f1e9d0c>(</span>sourceBuilder<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>,</span> <span class="token class-name" data-v-4f1e9d0c>RequestOptions</span><span class="token punctuation" data-v-4f1e9d0c>.</span>DEFAULT<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token comment" data-v-4f1e9d0c>// 4.æ‰“å°å“åº”ç»“æœ</span>
        <span class="token class-name" data-v-4f1e9d0c>SearchHits</span> hits <span class="token operator" data-v-4f1e9d0c>=</span> response<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>getHits</span><span class="token punctuation" data-v-4f1e9d0c>(</span><span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
        <span class="token class-name" data-v-4f1e9d0c>System</span><span class="token punctuation" data-v-4f1e9d0c>.</span>out<span class="token punctuation" data-v-4f1e9d0c>.</span><span class="token function" data-v-4f1e9d0c>println</span><span class="token punctuation" data-v-4f1e9d0c>(</span>response<span class="token punctuation" data-v-4f1e9d0c>)</span><span class="token punctuation" data-v-4f1e9d0c>;</span>
    <span class="token punctuation" data-v-4f1e9d0c>}</span>
<span class="token punctuation" data-v-4f1e9d0c>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>1</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>2</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>3</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>4</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>5</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>6</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>7</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>8</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>9</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>10</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>11</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>12</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>13</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>14</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>15</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>16</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>17</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>18</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>19</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>20</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>21</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>22</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>23</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>24</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>25</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>26</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>27</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>28</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>29</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>30</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>31</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>32</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>33</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>34</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>35</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>36</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>37</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>38</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>39</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>40</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>41</span><br data-v-4f1e9d0c><span class="line-number" data-v-4f1e9d0c>42</span><br data-v-4f1e9d0c></div></div></div> <pre class="pre-blank" data-v-2f5f1757>// Make sure to add code blocks to your code group</pre></div> <h2 id="spark-streamingæ¡†æ¶é›†æˆ"><a href="#spark-streamingæ¡†æ¶é›†æˆ" class="header-anchor">#</a> Spark Streamingæ¡†æ¶é›†æˆ</h2> <h3 id="spark-streamingæ¡†æ¶ä»‹ç»"><a href="#spark-streamingæ¡†æ¶ä»‹ç»" class="header-anchor">#</a> Spark Streamingæ¡†æ¶ä»‹ç»</h3> <p>Spark Streaming æ˜¯ Spark core API çš„æ‰©å±•ï¼Œæ”¯æŒå®æ—¶æ•°æ®æµçš„å¤„ç†ï¼Œå¹¶ä¸”å…·æœ‰å¯æ‰©å±•ï¼Œé«˜ååé‡ï¼Œå®¹é”™çš„ç‰¹ç‚¹ã€‚æ•°æ®å¯ä»¥ä»è®¸å¤šæ¥æºè·å–ï¼Œå¦‚ Kafkaï¼ŒFlumeï¼ŒKinesis æˆ– TCP socketsï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å¤æ‚çš„ç®—æ³•è¿›è¡Œå¤„ç†ï¼Œè¿™äº›ç®—æ³•ä½¿ç”¨è¯¸å¦‚ mapï¼Œreduceï¼Œjoin å’Œ window ç­‰é«˜çº§å‡½æ•°è¡¨ç¤ºã€‚æœ€åï¼Œå¤„ç†åçš„æ•°æ®å¯ä»¥æ¨é€åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œæ•°æ®åº“ç­‰ã€‚å®é™…ä¸Šï¼Œæ‚¨å¯ä»¥å°† Spark çš„æœºå™¨å­¦ä¹ å’Œå›¾å½¢å¤„ç†ç®—æ³•åº”ç”¨äºæ•°æ®æµã€‚</p> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211118011932.png" alt="image-20211118011930702"></p> <h3 id="æ¡†æ¶æ­å»º-3"><a href="#æ¡†æ¶æ­å»º-3" class="header-anchor">#</a> æ¡†æ¶æ­å»º</h3> <ul><li><p>åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®</p></li> <li><p>ä¿®æ”¹ pom æ–‡ä»¶ï¼Œå¢åŠ ä¾èµ–</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-streaming_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.15.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- elasticsearch çš„å®¢æˆ·ç«¯ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.15.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- elasticsearch ä¾èµ– 2.x çš„ log4j --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- &lt;dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;version&gt;2.11.1&lt;/version&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;/dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &amp;lt;!&amp;ndash; junit å•å…ƒæµ‹è¯• &amp;ndash;&amp;gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;groupId&gt;junit&lt;/groupId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;artifactId&gt;junit&lt;/artifactId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;version&gt;4.12&lt;/version&gt;--&gt;</span>
    <span class="token comment">&lt;!-- &lt;/dependency&gt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div></li></ul> <h3 id="åŠŸèƒ½å®ç°"><a href="#åŠŸèƒ½å®ç°" class="header-anchor">#</a> åŠŸèƒ½å®ç°</h3> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpHost
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span></span>SparkConf
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>dstream<span class="token punctuation">.</span></span>ReceiverInputDStream
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span></span><span class="token punctuation">{</span>Seconds<span class="token punctuation">,</span> StreamingContext<span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span>IndexRequest
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span>CreateIndexRequest
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token punctuation">{</span>RequestOptions<span class="token punctuation">,</span> RestClient<span class="token punctuation">,</span> 
                                 RestHighLevelClient<span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>xcontent<span class="token punctuation">.</span></span>XContentType
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date
<span class="token keyword">object</span> SparkStreamingESTest <span class="token punctuation">{</span>
    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> sparkConf <span class="token operator">=</span> <span class="token keyword">new</span> 
        SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;ESTest&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> ssc <span class="token operator">=</span> <span class="token keyword">new</span> StreamingContext<span class="token punctuation">(</span>sparkConf<span class="token punctuation">,</span> Seconds<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> ds<span class="token operator">:</span> ReceiverInputDStream<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> ssc<span class="token punctuation">.</span>socketTextStream<span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span>
        ds<span class="token punctuation">.</span>foreachRDD<span class="token punctuation">(</span>
            rdd <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
                println<span class="token punctuation">(</span><span class="token string">&quot;*************** &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> Date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                rdd<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>
                    data <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">val</span> client <span class="token operator">=</span> <span class="token keyword">new</span> RestHighLevelClient<span class="token punctuation">(</span>
                            RestClient<span class="token punctuation">.</span>builder<span class="token punctuation">(</span><span class="token keyword">new</span> HttpHost<span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// æ–°å¢æ–‡æ¡£ - è¯·æ±‚å¯¹è±¡</span>
                        <span class="token keyword">val</span> request <span class="token operator">=</span> <span class="token keyword">new</span> IndexRequest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// è®¾ç½®ç´¢å¼•åŠå”¯ä¸€æ€§æ ‡è¯†</span>
                        <span class="token keyword">val</span> ss <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
                        println<span class="token punctuation">(</span><span class="token string">&quot;ss = &quot;</span> <span class="token operator">+</span> ss<span class="token punctuation">.</span>mkString<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        request<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">&quot;sparkstreaming&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">(</span>ss<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">val</span> productJson <span class="token operator">=</span> <span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;&quot;&quot; | { &quot;data&quot;:&quot;</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">ss<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">&quot; } |&quot;&quot;&quot;</span></span><span class="token punctuation">.</span>stripMargin<span class="token punctuation">;</span>
                        <span class="token comment">// æ·»åŠ æ–‡æ¡£æ•°æ®ï¼Œæ•°æ®æ ¼å¼ä¸º JSON æ ¼å¼</span>
                        request<span class="token punctuation">.</span>source<span class="token punctuation">(</span>productJson<span class="token punctuation">,</span>XContentType<span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè·å–å“åº”å¯¹è±¡</span>
                        <span class="token keyword">val</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span>index<span class="token punctuation">(</span>request<span class="token punctuation">,</span> RequestOptions<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token string">&quot;_index:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span>getIndex<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token string">&quot;_id:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span>getId<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token string">&quot;_result:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span>getResult<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        ssc<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ssc<span class="token punctuation">.</span>awaitTermination<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="flinkæ¡†æ¶é›†æˆ"><a href="#flinkæ¡†æ¶é›†æˆ" class="header-anchor">#</a> Flinkæ¡†æ¶é›†æˆ</h2> <h3 id="flinkæ¡†æ¶ä»‹ç»"><a href="#flinkæ¡†æ¶ä»‹ç»" class="header-anchor">#</a> Flinkæ¡†æ¶ä»‹ç»</h3> <p><img src="https://fastly.jsdelivr.net/gh/Kele-Bingtang/static/img/ElasticSearch/20211118012417.png" alt="image-20211118012416374"></p> <p>Apache Spark æ˜¯ä¸€ç§åŸºäºå†…å­˜çš„å¿«é€Ÿã€é€šç”¨ã€å¯æ‰©å±•çš„å¤§æ•°æ®åˆ†æè®¡ç®—å¼•æ“ã€‚</p> <p>Apache Spark æ€å¼€äº†å†…å­˜è®¡ç®—çš„å…ˆæ²³ï¼Œä»¥å†…å­˜ä½œä¸ºèµŒæ³¨ï¼Œèµ¢å¾—äº†å†…å­˜è®¡ç®—çš„é£é€Ÿå‘å±•ã€‚ä½†æ˜¯åœ¨å…¶ç«çƒ­çš„åŒæ—¶ï¼Œå¼€å‘äººå‘˜å‘ç°ï¼Œåœ¨ Spark ä¸­ï¼Œè®¡ç®—æ¡†æ¶æ™®éå­˜åœ¨çš„ç¼ºç‚¹å’Œä¸è¶³ä¾ç„¶æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œè€Œè¿™äº›é—®é¢˜éšç€ 5G æ—¶ä»£çš„æ¥ä¸´ä»¥åŠå†³ç­–è€…å¯¹å®æ—¶æ•°æ®åˆ†æç»“æœçš„è¿«åˆ‡éœ€è¦è€Œå‡¸æ˜¾çš„æ›´åŠ æ˜æ˜¾ï¼š</p> <ul><li>æ•°æ®ç²¾å‡†ä¸€æ¬¡æ€§å¤„ç†ï¼ˆExactly-Onceï¼‰</li> <li>ä¹±åºæ•°æ®ï¼Œè¿Ÿåˆ°æ•°æ®</li> <li>ä½å»¶è¿Ÿï¼Œé«˜ååï¼Œå‡†ç¡®æ€§</li> <li>å®¹é”™æ€§</li></ul> <p>Apache Flink æ˜¯ä¸€ä¸ªæ¡†æ¶å’Œåˆ†å¸ƒå¼å¤„ç†å¼•æ“ï¼Œç”¨äºå¯¹æ— ç•Œå’Œæœ‰ç•Œæ•°æ®æµè¿›è¡Œæœ‰çŠ¶æ€è®¡ç®—ã€‚åœ¨ Spark ç«çƒ­çš„åŒæ—¶ï¼Œä¹Ÿé»˜é»˜åœ°å‘å±•è‡ªå·±ï¼Œå¹¶å°è¯•ç€è§£å†³å…¶ä»–è®¡ç®—æ¡†æ¶çš„é—®é¢˜ã€‚</p> <p>æ…¢æ…¢åœ°ï¼Œéšç€è¿™äº›é—®é¢˜çš„è§£å†³ï¼ŒFlink æ…¢æ…¢è¢«ç»å¤§æ•°ç¨‹åºå‘˜æ‰€ç†ŸçŸ¥å¹¶è¿›è¡Œå¤§åŠ›æ¨å¹¿ï¼Œé˜¿é‡Œå…¬å¸åœ¨ 2015 å¹´æ”¹è¿› Flinkï¼Œå¹¶åˆ›å»ºäº†å†…éƒ¨åˆ†æ”¯ Blinkï¼Œç›®å‰æœåŠ¡äºé˜¿é‡Œé›†å›¢å†…éƒ¨æœç´¢ã€æ¨èã€å¹¿å‘Šå’Œèš‚èšç­‰å¤§é‡æ ¸å¿ƒå®æ—¶ä¸šåŠ¡ã€‚</p> <h3 id="æ¡†æ¶æ­å»º-4"><a href="#æ¡†æ¶æ­å»º-4" class="header-anchor">#</a> æ¡†æ¶æ­å»º</h3> <ul><li><p>åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®</p></li> <li><p>ä¿®æ”¹ pom æ–‡ä»¶ï¼Œå¢åŠ ç›¸å…³ä¾èµ–</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-scala_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-streaming-scala_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-clients_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-connector-elasticsearch7_2.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- jackson --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.11.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li></ul> <h3 id="åŠŸèƒ½å®ç°-2"><a href="#åŠŸèƒ½å®ç°-2" class="header-anchor">#</a> åŠŸèƒ½å®ç°</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>api<span class="token punctuation">.</span>common<span class="token punctuation">.</span>functions<span class="token punctuation">.</span></span><span class="token class-name">RuntimeContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>datastream<span class="token punctuation">.</span></span><span class="token class-name">DataStreamSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>environment<span class="token punctuation">.</span></span><span class="token class-name">StreamExecutionEnvironment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> 
<span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchSinkFunctio</span>
n<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token class-name">RequestIndexer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> 
<span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch7<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchSink</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Requests</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlinkElasticsearchSinkTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">StreamExecutionEnvironment</span> env <span class="token operator">=</span> 
        <span class="token class-name">StreamExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataStreamSource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> source <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">socketTextStream</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> 
                                                               <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpHost</span><span class="token punctuation">&gt;</span></span> httpHosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        httpHosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//httpHosts.add(new HttpHost(&quot;10.2.3.1&quot;, 9200, &quot;http&quot;));</span>
        <span class="token comment">// use a ElasticsearchSink.Builder to create an ElasticsearchSink</span>
        <span class="token class-name">ElasticsearchSink<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> esSinkBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchSink<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>httpHosts<span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">ElasticsearchSinkFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">public</span> <span class="token class-name">IndexRequest</span> <span class="token function">createIndexRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token class-name">Requests</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;my-index&quot;</span><span class="token punctuation">)</span>
                    <span class="token comment">//.type(&quot;my-type&quot;)</span>
                    <span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">String</span> element<span class="token punctuation">,</span> <span class="token class-name">RuntimeContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">RequestIndexer</span> indexer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    indexer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">createIndexRequest</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// configuration for the bulk requests; this instructs the sink to emit after </span>
        every element<span class="token punctuation">,</span> otherwise they would be buffered esSinkBuilder<span class="token punctuation">.</span><span class="token function">setBulkFlushMaxActions</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// provide a RestClientFactory for custom configuration on the internally created REST client</span>
        <span class="token comment">// esSinkBuilder.setRestClientFactory(</span>
            <span class="token comment">// restClientBuilder -&gt; {</span>
                <span class="token comment">// restClientBuilder.setDefaultHeaders(...)</span>
                <span class="token comment">// restClientBuilder.setMaxRetryTimeoutMillis(...)</span>
                <span class="token comment">// restClientBuilder.setPathPrefix(...)</span>
                <span class="token comment">// restClientBuilder.setHttpClientConfigCallback(...)</span>
        	<span class="token comment">// }</span>
        <span class="token comment">// );</span>
        source<span class="token punctuation">.</span><span class="token function">addSink</span><span class="token punctuation">(</span>esSinkBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;flink-es&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Jonas-Wolfxin/Jonas-Wolfxin.github.io/edit/main/docs/20.æ•°æ®åº“/15.æœç´¢æ•°æ®åº“ - ElasticSearch/12. ElasticSearch - å¤šæ¡†æ¶é›†æˆ.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=%E6%90%9C%E7%B4%A2%E6%95%B0%E6%8D%AE%E5%BA%93" title="æ ‡ç­¾">#æœç´¢æ•°æ®åº“</a></div> <div class="last-updated"><span class="prefix">last Updated:</span> <span class="time">2022/06/10, 15:06:32</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/es/java-curd/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">ElasticSearch - Javaæ“ä½œ</div></a> <a href="/es/cluster/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">ElasticSearch - æ­å»ºé›†ç¾¤</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/es/java-curd/" class="prev">ElasticSearch - Javaæ“ä½œ</a></span> <span class="next"><a href="/es/cluster/">ElasticSearch - æ­å»ºé›†ç¾¤</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/32db2d/"><div>
            Layer 3 Forwarding
            <!----></div></a> <span class="date">06-07</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/6b8f16/"><div>
            Layer 2 Forwarding
            <!----></div></a> <span class="date">06-06</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/fe5ceb/"><div>
            Virtual Routing and Forwarding
            <!----></div></a> <span class="date">05-16</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/Jonas-Wolfxin" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/Jonas-Wolfxin" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/202206100005451.jpg" title="Wechat: @Jonas_Wolfxin" target="_blank" class="iconfont icon-weixin"></a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1914303043&amp;site=qq&amp;menu=yes" title="QQ: 1914303043" target="_blank" class="iconfont icon-QQ"></a><a href="mailto:wolfxin@outlook.com" title="è”ç³»æˆ‘" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2021-2023
    <span>Jonas Wolfxin's Blog</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div></div><div></div><div></div><!----><!----><APlayer audio="" fixed="true" mini="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div></div></div></div>
    <script src="/assets/js/app.d858ddbb.js" defer></script><script src="/assets/js/2.309e711a.js" defer></script><script src="/assets/js/102.d5a6dfd2.js" defer></script><script src="/assets/js/16.acd3428d.js" defer></script><script src="/assets/js/8.5b4b6c67.js" defer></script><script src="/assets/js/10.58f97cc7.js" defer></script><script src="/assets/js/17.0b7a5267.js" defer></script>
  </body>
</html>
