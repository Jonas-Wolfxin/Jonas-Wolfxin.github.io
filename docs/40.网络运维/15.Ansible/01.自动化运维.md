---
title: 自动化运维
date: 2023-03-28 03:13:28
permalink: /pages/21317e/
categories:
  - 网络运维
  - Ansible
tags:
  - 
---



## 主要内容

- [ ] 运维自动化发展历程及技术应用

- [ ] Ansible命令使用

- [ ] Ansible常用模块详解

- [ ] YAML语法简介

- [ ] Ansible playbook基础

- [ ] Playbook变量、tags、handlers使用

- [ ] Playbook模板templates

- [ ] Playbook条件判断 when

- [ ] Playbook字典 with_items

- [ ] Ansible Roles

## 自动化运维简介

### 运维自动化发展历程及技术应用

![image-20230325073842320](https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250738547.png)

### 运维工程师的职能

![image-20230325081150072](https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250811286.png)

<img src="https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250813438.png" alt="image-20230325081345244" style="zoom: 100%;" />

### 企业实际应用场景

>##### Dev开发环境
>
> - 使用者：程序员
> - 功能：程序员开发软件，测试BUG的环境
> - 管理者：程序员
>
>
>
>##### 测试环境
>
> - 使用者：QA测试工程师
>
> - 功能：测试经过Dev环境测试通过的软件的功能
>
> - 管理者：运维
>
> - 说明：测试环境往往有多套,测试环境满足测试功能即可，不宜过多
>
>       1. 测试人员希望测试环境有多套,公司的产品多产品线并发，即多个版本，意味着多个版本同步测试
>       2. 通常测试环境有多少套和产品线数量保持一样
>
>
>
>##### 发布环境
>
> - 代码发布机，有些公司为堡垒机（安全屏障）
> - 使用者：运维
> - 功能：发布代码至生产环境
> - 管理者：运维（有经验）
> - 发布机：往往需要有2台（主备）
>
>
>
>##### 生产环境
>
> - 使用者：运维，少数情况开放权限给核心开发人员，极少数公司将权限完全开放给开发人员并其维护
> - 功能：对用户提供公司产品的服务
> - 管理者：只能是运维
> - 生产环境服务器数量：一般比较多，且应用非常重要。往往需要自动化工具协助部署配置应用。
>
>
>
>##### 灰度环境（生产环境的Beta版）
>
> - 使用者：运维
> - 功能：在全量发布代码前将代码的功能面向少量精准用户发布的环境,可基于主机或用户执行灰度发布；
> - 案例：共100台生产服务器，先发布其中的10台服务器，这10台服务器就是灰度服务器；
> - 管理者：运维
> - 灰度环境：往往该版本功能变更较大，为保险起见特意先让一部分用户优化体验该功能，待这部分用户使用没有重大问题的时候，再全量发布至所有服务器

### 程序发布

> - 程序发布要求：
>
>   - 不能导致系统故障或造成系统完全不可用
>   - 不能影响用户体验
>
> - 预发布验证：
>
>   - 新版本的代码先发布到服务器（跟线上环境配置完全相同，只是未接入到调度器）
>
> - 灰度发布：
>
>   - 基于主机/用户/业务/地区等
>
> - 发布路径：
>       /webapp/tuangou
>       /webapp/tuangou-1.1
>       /webapp/tuangou-1.2
>
> - 发布过程：
>
>       通过**调度器**下线一批主机(标记为maintanance状态) -> 关闭服务 -> 部署新版本的应用程序 -> 启动服务 -> 在调度器上启用这一批服务器
>
> - 自动化灰度发布：脚本、发布软件

![img](https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250735567.png)

### 自动化运维应用场景

- 数据备份
- 应用部署
- 配置管理
- 任务流编排

### 常用自动化运维工具

> - Ansible：python，Agentless，中小型应用环境
> - Saltstack：python，一般需部署agent，执行效率更高
> - Puppet：ruby, 功能强大，配置复杂，重型,适合大型环境
> - Fabric：python，agentless
> - Chef：ruby，国内应用少
> - Cfengine
> - func
>
> ![image](https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250845567.png)

##
