(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{771:function(s,n,a){"use strict";a.r(n);var t=a(14),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible"}},[s._v("#")]),s._v(" Ansible")]),s._v(" "),a("h3",{attrs:{id:"ansible发展史"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible发展史"}},[s._v("#")]),s._v(" Ansible发展史")]),s._v(" "),a("blockquote",[a("ul",[a("li",[a("p",[s._v("创始人: Michael DeHaan（ Cobbler 与 Func 作者）")])]),s._v(" "),a("li",[a("p",[s._v("2012-03-09，发布0.0.1版，2015-10-17，Red Hat宣布收购")])]),s._v(" "),a("li",[a("p",[s._v("官网："),a("a",{attrs:{href:"https://www.ansible.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.ansible.com/"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("官方文档："),a("a",{attrs:{href:"https://docs.ansible.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.ansible.com/"),a("OutboundLink")],1)])])])]),s._v(" "),a("h3",{attrs:{id:"特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[s._v("#")]),s._v(" 特性")]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("模块化：调用特定的模块，完成特定任务")]),s._v(" "),a("li",[s._v("Paramiko（python对ssh的实现），PyYAML，Jinja2（模板语言）三个关键模块")]),s._v(" "),a("li",[s._v("支持自定义模块")]),s._v(" "),a("li",[s._v("基于Python语言实现")]),s._v(" "),a("li",[s._v("部署简单，基于python和SSH(默认已安装)，")]),s._v(" "),a("li",[s._v("安全，基于OpenSSH")]),s._v(" "),a("li",[s._v("支持playbook编排任务")]),s._v(" "),a("li",[s._v("幂等性：一个任务执行1遍和执行n遍效果一样，不因重复执行带来意外情况")]),s._v(" "),a("li",[s._v("Agentless, 无需代理不依赖PKI（无需ssl）")]),s._v(" "),a("li",[s._v("可使用任何编程语言写模块")]),s._v(" "),a("li",[s._v("YAML格式，编排任务，支持丰富的数据结构")]),s._v(" "),a("li",[s._v("较强大的多层解决方案")])])]),s._v(" "),a("h3",{attrs:{id:"ansible架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible架构"}},[s._v("#")]),s._v(" Ansible架构")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250850003.png",alt:"image-20230325085030757"}})]),s._v(" "),a("blockquote",[a("h4",{attrs:{id:"ansible简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible简介"}},[s._v("#")]),s._v(" ansible简介")]),s._v(" "),a("p",[s._v("ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于模块工作的，本身没有批量部署的能力。\n真正具有批量部署的是ansible所运行的模块，ansible只是提供一种框架。主要包括：\n(1)、连接插件connection plugins：负责和被监控端实现通信；\n(2)、host inventory：指定操作的主机，是一个配置文件里面定义监控的主机；\n(3)、各种模块核心模块、command模块、自定义模块；\n(4)、借助于插件完成记录日志邮件等功能；\n(5)、playbook：剧本执行多个任务时，非必需可以让节点一次性运行多个任务。")]),s._v(" "),a("p",[s._v("2、ansible的工作原理：连接其他主机默认使用ssh协议")])]),s._v(" "),a("h3",{attrs:{id:"ansible主要组成部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible主要组成部分"}},[s._v("#")]),s._v(" Ansible主要组成部分")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250853554.png",alt:"image-20230325085303372"}}),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("ANSIBLE PLAYBOOKS：任务剧本（任务集），编排定义Ansible任务集的配置文件，由Ansible顺序依次执行，通常是JSON格式的YAML文件")]),s._v(" "),a("li",[s._v("INVENTORY：Ansible管理主机的清单  /etc/ansible/hosts")]),s._v(" "),a("li",[s._v("MODULES：  Ansible执行命令的功能模块，多数为内置核心模块，也可自定义")]),s._v(" "),a("li",[s._v("PLUGINS：  模块功能的补充，如连接类型插件、循环插件、变量插件、过滤插件等，该功能不常用")]),s._v(" "),a("li",[s._v("API：      供第三方程序调用的应用程序编程接口")]),s._v(" "),a("li",[s._v("ANSIBLE：  组合INVENTORY、API、MODULES、PLUGINS的绿框，可以理解为是ansible命令工具，其为核心执行工具")])])]),s._v(" "),a("blockquote",[a("h4",{attrs:{id:"ansible命令执行来源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible命令执行来源"}},[s._v("#")]),s._v(" Ansible命令执行来源")]),s._v(" "),a("ul",[a("li",[s._v("USERs/SYSTEM ADMINISTRATOR")]),s._v(" "),a("li",[s._v("CMDB（配置管理数据库） API 调用")]),s._v(" "),a("li",[s._v("PUBLIC/PRIVATE CLOUD API调用  (公有私有云的API接口调用)")]),s._v(" "),a("li",[s._v("USER-> Ansible Playbook -> Ansibile")])]),s._v(" "),a("h4",{attrs:{id:"利用ansible实现管理的方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用ansible实现管理的方式"}},[s._v("#")]),s._v(" 利用ansible实现管理的方式")]),s._v(" "),a("ul",[a("li",[s._v("Ad-Hoc 即ansible单条命令，主要用于临时命令使用场景")]),s._v(" "),a("li",[s._v("Ansible-playbook 主要用于长期规划好的，大型项目的场景，需要有前期的规划过程")])])]),s._v(" "),a("blockquote",[a("h4",{attrs:{id:"ansible-playbook-剧本-执行过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-playbook-剧本-执行过程"}},[s._v("#")]),s._v(" Ansible-playbook（剧本）执行过程")]),s._v(" "),a("ol",[a("li",[s._v("将已有编排好的任务集写入Ansible-Playbook")]),s._v(" "),a("li",[s._v("通过ansible-playbook命令分拆任务集至逐条ansible命令，按预定规则逐条执行")])]),s._v(" "),a("h4",{attrs:{id:"ansible主要操作对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible主要操作对象"}},[s._v("#")]),s._v(" Ansible主要操作对象")]),s._v(" "),a("ul",[a("li",[s._v("HOSTS主机")]),s._v(" "),a("li",[s._v("NETWORKING网络设备")])]),s._v(" "),a("h5",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),a("ul",[a("li",[s._v("执行ansible的主机一般称为主控端，中控，master或堡垒机")]),s._v(" "),a("li",[s._v("主控端Python版本需要2.6或以上")]),s._v(" "),a("li",[s._v("被控端Python版本小于2.4需要安装python-simplejson")]),s._v(" "),a("li",[s._v("被控端如开启SELinux, 需要安装libselinux-python")]),s._v(" "),a("li",[s._v("windows不能做为主控端")]),s._v(" "),a("li",[s._v("ansible不是服务,不会一直启动,只是需要的时候启动")])])]),s._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("rpm包安装: EPEL源")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("yum info ansible\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ansible\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("The procedure to enable EPEL repository for a CentOS/RHEL 7.x server is as follows:")]),s._v(" "),a("ol",[a("li",[s._v("Open a shell prompt.")]),s._v(" "),a("li",[s._v("Or login to a host called server1 using ssh client. Run "),a("code",[s._v("su -")]),s._v(" or "),a("code",[s._v("sudo -i")]),s._v(" to gain root access.")]),s._v(" "),a("li",[s._v("First, update CentOS/RHEL repos by running "),a("code",[s._v("yum -y update")]),s._v(".")]),s._v(" "),a("li",[s._v("Install epel repository using: "),a("code",[s._v("yum -y install epel-release")]),s._v(".")]),s._v(" "),a("li",[s._v("Refresh epel repo by typing: "),a("code",[s._v("yum repolist")]),s._v(".")]),s._v(" "),a("li",[s._v("Install packages from epel repo : "),a("code",[s._v("yum install pkg1")]),s._v(".")])]),s._v(" "),a("hr"),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" epel-release-latest-7.noarch.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum repolist\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("ul",[a("li",[s._v("编译安装:")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("yum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python-jinja2 PyYAML python-paramiko python-babel\npython-crypto\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf ansible-1.5.4.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ansible-1.5.4\npython setup.py build\npython setup.py "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/ansible\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r examples/* /etc/ansible\t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("Git方式:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone git://github.com/ansible/ansible.git --recursive\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ./ansible\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ./hacking/env-setup\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("pip安装： pip是安装Python包的管理器，类似yum")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python-pip python-devel\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc glibc-devel zibl-devel rpm-bulid openssl-devel\npip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --upgrade pip\npip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ansible --upgrade\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("p",[s._v("确认安装：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible --version")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible --help")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"相关文件和命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关文件和命令"}},[s._v("#")]),s._v(" 相关文件和命令")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -ql ansible | less")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /usr/bin/ansible")]),s._v("\nlrwxrwxrwx. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":53 /usr/bin/ansible -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/bin/ansible-2.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[a("p",[a("strong",[s._v("配置文件目录: /etc/ansible/")])]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("/etc/ansible/ansible.cfg")]),s._v("  主配置文件,配置ansible工作特性(一般无需修改)")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/etc/ansible/hosts")]),s._v("        inventory 主机清单(将被管理的主机放到此文件)")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/etc/ansible/roles/")]),s._v("       存放角色的目录")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("可执行程序所在目录: /usr/bin/")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("/usr/bin/ansible")]),s._v("          主程序，临时命令执行工具")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-doc")]),s._v("      查看配置文档，模块功能查看工具")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-galaxy")]),s._v("   下载/上传优秀代码或Roles模块的官网平台")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-playbook")]),s._v(" 定制自动化任务，编排剧本工具")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-pull")]),s._v("     远程执行命令的工具")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-vault")]),s._v("    文件加密工具")]),s._v(" "),a("li",[a("code",[s._v("/usr/bin/ansible-console")]),s._v("  基于Console界面与用户交互的执行工具")])])])])]),s._v(" "),a("h3",{attrs:{id:"主机清单inventory"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机清单inventory"}},[s._v("#")]),s._v(" 主机清单inventory")]),s._v(" "),a("blockquote",[a("ul",[a("li",[a("p",[s._v("主要用于受控机的批量管理，为了便捷地使用其中的部分主机，可以在inventory file中将其分组命名;")])]),s._v(" "),a("li",[a("p",[s._v("默认的inventory file: "),a("code",[s._v("/etc/ansible/hosts")])])]),s._v(" "),a("li",[a("p",[s._v("inventory file可以有多个，且也可以通过Dynamic Inventory来动态生成;")])]),s._v(" "),a("li",[a("p",[s._v("文件格式:")]),s._v(" "),a("ul",[a("li",[s._v("inventory文件遵循INI文件风格，[]中的字符为组名。")]),s._v(" "),a("li",[s._v("可以将同一个主机同时归并到多个不同的组中；")]),s._v(" "),a("li",[s._v("此外，当如若目标主机使用了非默认的SSH端口，还可以在主机名称之后使用冒号加端口号来标明")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/ansible/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This is the default ansible 'hosts' file.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# It should live in /etc/ansible/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   - Comments begin with the '#' character")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   - Blank lines are ignored")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   - Groups of hosts are delimited by [header] elements")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   - You can enter hostnames or ip addresses")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   - A hostname/ip can be a member of multiple groups")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ex 1: Ungrouped hosts, specify before any group headers.")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## green.example.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 192.168.100.1")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ex 2: A collection of hosts belonging to the 'webservers' group")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## [webservers]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## alpha.example.org")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 192.168.1.100")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netnodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 192.168.30.10[1:3]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.101\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.102:22  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh端口号,可以修改")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.103\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netso"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If you have multiple hosts following a pattern you can specify")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# them like this:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## www[001:006].example.com")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ex 3: A collection of database servers in the 'dbservers' group")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## [dbservers]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## db01.intranet.mydomain.net")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## db02.intranet.mydomain.net")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 10.25.1.56  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 10.25.1.57")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Here's another example of host ranges, this time there are no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# leading 0s:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## db-[90:101]-node.example.com")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果主机名称遵循相似的命名模式，还可以使用列表的方式标识各主机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("websrvs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nwww"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":100"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".example.com   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip: 1-100")]),s._v("\n        \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dbsrvs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndb-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("a:f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".example.com     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dba-dbff")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])])])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -k 使用密码的方式验证连通性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible -m ping -k 192.168.30.101 ")]),s._v("\n\nansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -k netnodes \n\nansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -k all \n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" .ssh/known_hosts\n\nansible all -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang用户执行ping存活检测")]),s._v("\nansible all -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k -b "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至root执行ping存活检测")]),s._v("\nansible all -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k -b --become-user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mage  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至mage用户执行ping存活检测")]),s._v("\nansible all -m "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -u wang -a "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls /root'")]),s._v(" -b --become-user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -k -K  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至root用户执行")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"ansible-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-配置文件"}},[s._v("#")]),s._v(" ansible 配置文件")]),s._v(" "),a("p",[s._v("Ansible 配置文件: /etc/ansible/ansible.cfg （一般保持默认）")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# config file for ansible -- https://ansible.com/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ===============================================")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nearly all parameters can be overridden in ansible-playbook")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or with command line flags. ansible will read ANSIBLE_CONFIG,")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible.cfg in the current working directory, .ansible.cfg in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the home directory or /etc/ansible/ansible.cfg, whichever it")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# finds first")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# some basic default values...")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#inventory      = /etc/ansible/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#library        = /usr/share/my_modules/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#module_utils   = /usr/share/my_module_utils/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#remote_tmp     = ~/.ansible/tmp")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#local_tmp      = ~/.ansible/tmp")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#plugin_filters_cfg = /etc/ansible/plugin_filters.yml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#forks          = 5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#poll_interval  = 15")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sudo_user      = root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ask_sudo_pass = True")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ask_pass      = True")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#transport      = smart")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#remote_port    = 22")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#module_lang    = C")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#module_set_locale = False")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# plays will gather facts by default, which contain information about")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#....")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uncomment this to disable SSH key host checking")]),s._v("\nhost_key_checking "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" False "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消注释后, 就可以直接使用 ansible [主机列表] -m ping -k 测试连通性, 而不需要提前使用 ssh 访问一次 ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# logging is off by default unless this path is defined")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# if so defined, consider logrotate")]),s._v("\nlog_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/ansible.log    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启Ansible日志功能")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试,  host_key_checking = False 配置是否生效了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm .ssh/known_hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible netnodes -m ping -k")]),s._v("\nSSH password: \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.101 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.103 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试, Ansible 日志功能是否开启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /var/log/ansible.log ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h3",{attrs:{id:"ansible系列命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible系列命令"}},[s._v("#")]),s._v(" ansible系列命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible")]),s._v("\nansible               ansible-console       ansible-doc-2.7       ansible-playbook      ansible-pull-2.7\nansible-2             ansible-console-2     ansible-galaxy        ansible-playbook-2    ansible-vault\nansible-2.7           ansible-console-2.7   ansible-galaxy-2      ansible-playbook-2.7  ansible-vault-2\nansible-config        ansible-doc           ansible-galaxy-2.7    ansible-pull          ansible-vault-2.7\nansible-connection    ansible-doc-2         ansible-inventory     ansible-pull-2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"ansible-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-2"}},[s._v("#")]),s._v(" "),a("code",[s._v("ansible")])]),s._v(" "),a("p",[s._v("ansible通过ssh实现配置管理、应用部署、任务执行等功能，建议配置ansible端能基于密钥/密码认证的方式联系各被管理节点")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible -h -s")]),s._v("\nansible "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host-pattern"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-m module_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-a args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n --version              显示版本\n    -m MODULE_NAME         指定模块，默认为command\n    -a MODULE_ARGS     输入指定模块的参数\n    \n    -v                     详细过程, –vv -vvv更详细\n    --list-hosts           显示主机列表，可简写 --list\n    -k, --ask-pass         提示输入ssh连接密码, 默认Key验证\n    -C, --check            检查，并不执行\n    -T, --timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("TIMEOUT  执行命令的超时时间,默认10s\n    -u, --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("REMOTE_USER 执行远程执行的用户\n    -b, --become           代替旧版的sudo切换\n        --become-user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("USERNAME   指定sudo的runas用户,默认为root\n    -K, --ask-become-pass     提示输入sudo时的口令\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all --list   # 列出所有主机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible netnodes --list  # 列出指定 inventory group 的主机")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m command -a'cat /etc/shadow' -k     # 通过ansible, 让远程主机执行指令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m command -a'cat /etc/shadow' -k -u jonaswolfxin -b -K")]),s._v("\n发现错误, 这是因为jonaswolfxin 没有权限 执行sudo\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("jonaswolfxin@node2 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/shadow\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" jonaswolfxin: \njonaswolfxin is not "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the sudoers file.  This incident will be reported.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("p",[s._v("在所有远程主机上执行命令, 将普通用户添加进 wheel 用户组, 即赋予 sudo权限")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# visudo ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allows people in group wheel to run all commands")]),s._v("\n%wheel  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保这一行是生效的")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# usermod -aG wheel jonaswolfxin  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -a 保留原来的用户组, -G 添加用户到新的用户组")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m command -a'cat /etc/shadow' -k -u jonaswolfxin -b -K")]),s._v("\nSSH password: \nBECOME password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("defaults to SSH password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.102 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 成功!")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("设置 vim 为默认的编辑器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo export EDITOR=vim >> /etc/profile.d/env.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source /etc/profile.d/env.sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# visudo   # 你会发现,该文档变为colorful呈现的了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("设置 ssh 密钥对验证方式:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-keygen")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.30.101")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.30.102")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.30.103")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"ansible-doc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-doc"}},[s._v("#")]),s._v(" "),a("code",[s._v("ansible-doc")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc -h  # 显示模块帮助")]),s._v("\n -l, --list            List available plugins\n -s, --snippet         Show playbook snippet "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" specified plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# snippet(片段)")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc -l | wc -l  # 统计模块数量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3387")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc -s ping  # 查看ping模块的语法, -s 简洁形式")]),s._v("\n- name: Try to connect to host, verify a usable python and "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("pong' on success\n  ping:\n      data:                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Data to return for the ")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' return value. If this parameter is set to `crash'")]),s._v(",\n                               the module will cause an exception.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("blockquote",[a("ul",[a("li",[a("p",[s._v("ping模块: 通过SSH协议检测所有主机的连通性, 探测网络中被管理主机是否能够正常使用; 如果对方主机网络正常,返回pong;")]),s._v(" "),a("ul",[a("li",[s._v("默认情况下连接被管理的主机是ssh基于key验证,如果没有配置key,权限将会被拒绝; 因此需要指定以谁的身份连接,输入用户密码,必须保证被管理主机用户密码一致; "),a("code",[s._v("ansible all -m ping -u jonaswolfxin -k")]),s._v(", 默认是 root 用户身份")])])]),s._v(" "),a("li",[a("p",[s._v("者实现基于key验证 将公钥ssh-copy-id到被管理的主机上, 实现免密登录")])])])]),s._v(" "),a("h4",{attrs:{id:"ansible-galaxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-galaxy"}},[s._v("#")]),s._v(" "),a("code",[s._v("ansible-galaxy")])]),s._v(" "),a("p",[s._v("可以通过网上写好的 "),a("a",{attrs:{href:"https://galaxy.ansible.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://galaxy.ansible.com"),a("OutboundLink")],1),s._v(", 下载相应的roles(角色)")]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ansible-galaxy list  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出所有已安装的galaxy")]),s._v("\n\nansible-galaxy "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" geerlingguy.redis  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装")]),s._v("\n\nansible-galaxy remove geerlingguy.redis  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("h4",{attrs:{id:"ansible-pull"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-pull"}},[s._v("#")]),s._v(" ansible-pull")]),s._v(" "),a("p",[s._v("推送命令至远程，效率无限提升，对运维要求较高")]),s._v(" "),a("h4",{attrs:{id:"ansible-playbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-playbook"}},[s._v("#")]),s._v(" ansible-playbook")]),s._v(" "),a("p",[s._v("可以引用按照标准的yml语言写的脚本")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ansible-playbook --help")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir ansible")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ansible/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ansible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim hello.yml")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ansible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-playbook ./hello.yml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hello.yml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" netnodes\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hello\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hostname\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"ansible-vault"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-vault"}},[s._v("#")]),s._v(" ansible-vault")]),s._v(" "),a("p",[s._v("功能：加密解密yml文件")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ansible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-vault --help")]),s._v("\nansible-vault "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("create"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("decrypt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("edit"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("encrypt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("rekey"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nansible-vault encrypt ./hello.yml "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加密")]),s._v("\nansible-vault decrypt ./hello.yml "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解密")]),s._v("\nansible-vault view ./hello.yml    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看")]),s._v("\nansible-vault edit ./hello.yml    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编辑加密文件")]),s._v("\nansible-vault rekey ./hello.yml   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改口令")]),s._v("\nansible-vault create ./new.yml    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建新文件")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"ansible-console"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-console"}},[s._v("#")]),s._v(" Ansible-console")]),s._v(" "),a("blockquote",[a("p",[s._v("2.0+新增，可交互执行命令，支持tab补全  (了解)")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-console")]),s._v("\nWelcome to the ansible console.\nType "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" or ? to list commands.\n\nroot@all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ \nroot@all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ forks "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置并发数为10")]),s._v("\nroot@all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" netnodes  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换inventory的主机组：")]),s._v("\nroot@netnodes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ list    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出当前组主机列表：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.101\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".30.103\nroot@all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ?  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出所有的内置命令： ?或help")]),s._v("\nroot@netnodes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("httpd "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\nroot@netnodes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("httpd "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("started\nroot@netnodes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"ansible的host-pattern"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible的host-pattern"}},[s._v("#")]),s._v(" ansible的Host-pattern")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible –m ping [Host-pattern]")]),s._v("\n all ：表示所有Inventory中的所有主机"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    * 通配符\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("*表示所有主机"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.1.10*'")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'net*'")]),s._v("\n        \n    逻辑或 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'netnodes:netso'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在netnodes组 或者 在netso组中的主机")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.30.101:192.168.30.103'")]),s._v("\n        \n    逻辑与 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'netnodes:&netso'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在netnodes组 并且 在netso组中的主机")]),s._v("\n        \n    逻辑非 :"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'netnodes:!netso'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  在netnodes组，但不在netso组中的主机")]),s._v("\n        \n    综合逻辑\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'websrvs:dbsrvs:&appsrvs:!ftpsrvs'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从左往右运算")]),s._v("\n        \n    正则表达式\n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~(web|db).*\\.magedu\\.com'")]),s._v(" \n        ansible -m "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~(netn|nets).*'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h3",{attrs:{id:"ansible命令执行过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible命令执行过程"}},[s._v("#")]),s._v(" ansible命令执行过程")]),s._v(" "),a("blockquote",[a("h4",{attrs:{id:"ansible命令执行过程-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible命令执行过程-2"}},[s._v("#")]),s._v(" ansible命令执行过程")]),s._v(" "),a("ol",[a("li",[s._v("主控机上加载配置文件, 默认为 /etc/ansible/ansible.cfg")]),s._v(" "),a("li",[s._v("主控机上加载对应的模块，如command")]),s._v(" "),a("li",[s._v("主控机通过ansible将模块或命令转译为对应的临时.py文件，并将该文件传输至远程服务器的对应的执行用户$HOME/.ansible/tmp/ansible-tmp-数字/XXX.PY文件")]),s._v(" "),a("li",[s._v("在受控机上, 给文件+x添加执行权限")]),s._v(" "),a("li",[s._v("在受控机上执行并返回结果到主控机")]),s._v(" "),a("li",[s._v("受控机删除临时.py文件，sleep 0退出")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 指令执行过程的 details")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible -m ping '192.168.30.101' -vvv")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"执行状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行状态"}},[s._v("#")]),s._v(" 执行状态")]),s._v(" "),a("ul",[a("li",[s._v("绿色：执行成功并且未对受控机更改的操作")]),s._v(" "),a("li",[s._v("黄色：执行成功并且对受控机做变更")]),s._v(" "),a("li",[s._v("红色：执行失败")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303260554640.png",alt:"image-20230326055445399"}})]),s._v(" "),a("h5",{attrs:{id:"查看配置文件里-所有颜色的含义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看配置文件里-所有颜色的含义"}},[s._v("#")]),s._v(" 查看配置文件里 所有颜色的含义")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Ansible ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# more /etc/ansible/ansible.cfg")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("colors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#highlight = white")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#verbose = blue")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#warn = bright purple")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error = red")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#debug = dark gray")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#deprecate = purple")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip = cyan")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#unreachable = red")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ok = green")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#changed = yellow")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#diff_add = green")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#diff_remove = red")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#diff_lines = cyan")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])])])])}),[],!1,null,null,null);n.default=e.exports}}]);