(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{734:function(t,s,e){"use strict";e.r(s);var a=e(14),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"stp-rstp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp-rstp"}},[t._v("#")]),t._v(" STP & RSTP")]),t._v(" "),e("h2",{attrs:{id:"comparison-of-stp-versions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#comparison-of-stp-versions"}},[t._v("#")]),t._v(" Comparison of STP versions")]),t._v(" "),e("h3",{attrs:{id:"ieee-standard-vs-cisco"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ieee-standard-vs-cisco"}},[t._v("#")]),t._v(" IEEE standard vs Cisco")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290734988.png",alt:"image-20230329073416467"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("IEEE industry standards:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("STP(802.1D)")])]),t._v(" "),e("li",[e("strong",[t._v("RSTP(802.1W)")])]),t._v(" "),e("li",[e("strong",[t._v("MSTP(802.1s)")]),t._v("(Multiple Spanning Tree Protocol):\n"),e("ul",[e("li",[t._v("it uses modified RSTP mechanics;")]),t._v(" "),e("li",[t._v("the main improvement is that it can group multiple VLANs into different instances, for example if there are 10 VLANs, VLANs 1 to 5 in instance 1, and VLANs 6 to 10 in instance 2, to perform "),e("strong",[t._v("load balancing")]),t._v(".")]),t._v(" "),e("li",[t._v("Finally an industry standard version of STP that allows load balancing , and actually it's superior to Cisco’s rapid-PVST+.")])])])])]),t._v(" "),e("li",[e("p",[t._v("Cisco versions of "),e("strong",[t._v("Per_VLAN")]),t._v(" feature:")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("PVST+")]),t._v(": operates the same as "),e("strong",[t._v("STP(802.1D)")]),t._v(", but with the addition of a separate instance for each VLAN.")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("PVST(Per-VLAN Spanning Tree): only supported ISL trunk encapsulation(without dot1q); "),e("strong",[t._v("Deprecated!")])]),t._v(" "),e("li",[t._v("The pvst and rapid-PVST in Cisco IOS are actually the "),e("strong",[t._v("plus")]),e("code",[t._v("+")]),t._v(" version")])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Rapid PVST+")]),t._v(": operates the same as "),e("strong",[t._v("RSTP(802.1W)")]),t._v(", but with the addition of a separate instance for each VLAN.")])])])])])]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"why-is-mstp-superior-to-cisco-s-rapid-pvst"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#why-is-mstp-superior-to-cisco-s-rapid-pvst"}},[t._v("#")]),t._v(" Why is MSTP superior to Cisco’s rapid-PVST+?")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("If you have many VLANs, let’s say 200, in your network, configuring primary and secondary root bridges in each VLAN is a lot of work. However, with MSTP, all you have to do is assign VLANs 1 to 100 to instance 1, and VLANs 101 to 200 to instance 2, and then configure the primary and secondary root bridges for instance 1 and instance 2, so its much easier to configure and manage.")])]),t._v(" "),e("li",[e("p",[t._v("Actually, Cisco hasn’t developed their own version of MSTP, Cisco devices simply run the industry standard 802.1s. "),e("em",[t._v("Rapid-PVST+ is the default on modern Cisco switches")]),t._v(".")]),t._v(" "),e("img",{staticStyle:{zoom:"43%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290908684.png",alt:"image-20230329090851508"}})]),t._v(" "),e("li",[e("p",[t._v("For large networks, it’s best to use MSTP, however for small to medium networks without a huge number of VLANs, Cisco’s Rapid PVST+ is what you’ll probably run on your switches.")])])])]),t._v(" "),e("h3",{attrs:{id:"stp-vs-rstp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp-vs-rstp"}},[t._v("#")]),t._v(" STP Vs RSTP")]),t._v(" "),e("h4",{attrs:{id:"similarities-between-stp-and-rstp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#similarities-between-stp-and-rstp"}},[t._v("#")]),t._v(" Similarities between STP and RSTP:")]),t._v(" "),e("ul",[e("li",[t._v("RSTP serves the same purpose as STP, blocking specific ports to prevent Layer 2 loops.")]),t._v(" "),e("li",[t._v("RSTP elects a root bridge with the same rules as STP.\n"),e("ul",[e("li",[t._v("lowest "),e("strong",[t._v("Bridge ID")])])])]),t._v(" "),e("li",[t._v("RSTP elects root ports with the same rules as STP.\n"),e("ol",[e("li",[t._v("lowest "),e("em",[t._v("Root Cost")])]),t._v(" "),e("li",[t._v("lowest "),e("strong",[t._v("neighbor Bridge ID")])]),t._v(" "),e("li",[t._v("lowest "),e("strong",[t._v("neighbor Port ID")])])])]),t._v(" "),e("li",[t._v("RSTP elects designated ports with the same rules as STP.\n"),e("ol",[e("li",[t._v("lowest "),e("em",[t._v("Root Cost")])]),t._v(" "),e("li",[t._v("lowest "),e("strong",[t._v("Bridge ID")])])])])]),t._v(" "),e("h4",{attrs:{id:"evolution-from-stp-to-rstp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#evolution-from-stp-to-rstp"}},[t._v("#")]),t._v(" Evolution from STP to RSTP")]),t._v(" "),e("blockquote",[e("p",[t._v("Cisco has said that RSTP isn’t a ‘revolution’ of STP, just an ‘evolution’. It made some major improvements to speed up STP, but it didn’t change it completely.")]),t._v(" "),e("ul",[e("li",[t._v("To accommodate for faster speeds, RSTP’s "),e("strong",[t._v("Cost")]),t._v(" values were expanded.")]),t._v(" "),e("li",[t._v("RSTP simplifies the port states "),e("em",[t._v("from 5 states to 3 states")]),t._v(": ("),e("strong",[t._v("Discarding, Learning, Forwarding")]),t._v(")")]),t._v(" "),e("li",[t._v("Port Roles remain the "),e("strong",[t._v("almost same")]),t._v(" as STP ("),e("strong",[t._v("Root, Designated, Alternate, Backup")]),t._v(")")]),t._v(" "),e("li",[t._v("BPDUs: In RSTP, all switches originate and send their own BPDUs(with a different format with STP) from their Designated Ports.")]),t._v(" "),e("li",[t._v("RSTP Link Types: "),e("em",[t._v("Edge, P2P, Shared")])])])]),t._v(" "),e("h5",{attrs:{id:"cost"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cost"}},[t._v("#")]),t._v(" Cost:")]),t._v(" "),e("img",{staticStyle:{zoom:"28%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290800579.png",alt:"image-20230329080003359"}}),t._v(" "),e("h5",{attrs:{id:"port-states"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-states"}},[t._v("#")]),t._v(" Port states:")]),t._v(" "),e("img",{staticStyle:{zoom:"30%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290808370.png",alt:"image-20230329080830011"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("the "),e("strong",[t._v("Blocking")]),t._v(" and "),e("strong",[t._v("Disabled")]),t._v(" port states were combined into "),e("strong",[t._v("Discarding")]),t._v(" state;")]),t._v(" "),e("li",[t._v("the "),e("strong",[t._v("Listening")]),t._v(" state is simply not used.")])])]),t._v(" "),e("img",{staticStyle:{zoom:"30%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290811198.png",alt:"image-20230329081136856"}}),t._v(" "),e("h5",{attrs:{id:"port-roles"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-roles"}},[t._v("#")]),t._v(" Port Roles:")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("The "),e("strong",[t._v("Root Port")]),t._v(" role remains "),e("em",[t._v("unchanged")]),t._v(" in RSTP.")]),t._v(" "),e("li",[t._v("The "),e("strong",[t._v("Designated Port")]),t._v(" role remains "),e("em",[t._v("unchanged")]),t._v(" in RSTP.")]),t._v(" "),e("li",[t._v("The "),e("strong",[t._v("Non-designated port")]),t._v(" role is split into two separate roles in RSTP:\n"),e("ul",[e("li",[e("strong",[t._v("Alternate Port")]),t._v(" role")]),t._v(" "),e("li",[e("strong",[t._v("Backup Port")]),t._v(" role")])])])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"stp-pvst"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp-pvst"}},[t._v("#")]),t._v(" STP & PVST+")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("STP(802.1D) & PVST+:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("classic "),e("strong",[t._v("Spanning Tree Protocol")]),t._v(" is "),e("strong",[t._v("IEEE 802.1D")]),t._v(";")])]),t._v(" "),e("li",[e("p",[t._v("Cisco's version of STP called ["),e("strong",[t._v("PVST+ (Per-Vlan Spanning Tree plus)")]),t._v("], which runs a separate spanning tree instance in each VLAN.")]),t._v(" "),e("ul",[e("li",[t._v("Cisco's older version of PVST+ is "),e("strong",[t._v("PVST")]),t._v(", which doesn't support 802.1Q(only support cisco's ISL), so "),e("strong",[t._v("it's Deprecated! Forget it!")])])])])])]),t._v(" "),e("li",[e("p",[t._v("Switches from ALL vendors run STP by default;")])]),t._v(" "),e("li",[e("p",[t._v("STP prevents Layer 2 loops by placing redundant ports in a "),e("strong",[t._v("blocking state")]),t._v(", "),e("em",[t._v("essentially disabling the interface")]),t._v("; "),e("em",[t._v("Interfaces in a blocking state only send or receive STP messages (called BPDUs = Bridge Protocol Data Units)")]),t._v(".")]),t._v(" "),e("blockquote",[e("p",[t._v("Spanning Tree Protocol still uses the term ‘"),e("strong",[t._v("bridge")]),t._v("’. However, when we use the term ‘bridge’, we really mean ‘"),e("strong",[t._v("switch")]),t._v("’. Bridges are not used in modern networks.")])])]),t._v(" "),e("li",[e("p",[t._v("These interfaces act as "),e("strong",[t._v("backups")]),t._v(" that can enter a forwarding state if an active (=currently forwarding) interface fails.")])]),t._v(" "),e("li",[e("p",[t._v("Interfaces in a "),e("strong",[t._v("forwarding state")]),t._v(" behave normally. They send and receive all normal traffic.")])])])]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"stp的主要功能是"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp的主要功能是"}},[t._v("#")]),t._v(" STP的主要功能是")]),t._v(" "),e("ul",[e("li",[t._v("Spanning tree is a Layer 2 protocol by the way, it enables redundant layer 2 networks;")]),t._v(" "),e("li",[t._v("同时防止在第2层网络中因交换机之间的物理链路冗余而导致网络环路。它警惕地监视着网络以找出所有可用链路，并关闭任何冗余链路以确保不会出现环路。STP首先使用 生成树算法(STA) 创建一个拓扑数据库，然后找出并关闭冗余链路。运行STP后，数据帧就只能在STP选定的最优链路上进行转发。")])])]),t._v(" "),e("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/202207081848217.png",alt:"image-20220708184828063"}}),t._v(" "),e("h3",{attrs:{id:"存在问题的网络拓扑设计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#存在问题的网络拓扑设计"}},[t._v("#")]),t._v(" 存在问题的网络拓扑设计")]),t._v(" "),e("h4",{attrs:{id:"单点故障的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#单点故障的问题"}},[t._v("#")]),t._v(" "),e("strong",[t._v("单点故障")]),t._v("的问题")]),t._v(" "),e("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303240251662.png",alt:"image-20230324025124362"}}),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"network-redundancy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#network-redundancy"}},[t._v("#")]),t._v(" Network Redundancy")]),t._v(" "),e("p",[t._v("to make sure that that infrastructure is resilient to failures as much as possible.")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Redundancy is an essential part of network design;")])]),t._v(" "),e("li",[e("p",[t._v("Modern networks are expected to run 24/7/365. Even a short downtime can be disastrous for a business;")])]),t._v(" "),e("li",[e("p",[t._v("If one network component fails, you must ensure that other components will take over with little or no downtime;")])]),t._v(" "),e("li",[e("p",[t._v("As much as possible, you must implement redundancy at every possible point in the network.")]),t._v(" "),e("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303240252593.png",alt:"image-20230324025212222"}}),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("NOTE:")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Most PCs like shown in the picture only have a single Network Interface Card (NIC), so they can only be plugged into a single switch.")])]),t._v(" "),e("li",[e("p",[t._v("However, important servers typically have multiple NICs, so they can be plugged into multiple switches for redundancy.")])])])])])])]),t._v(" "),e("h4",{attrs:{id:"冗余拓扑的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#冗余拓扑的问题"}},[t._v("#")]),t._v(" ==冗余拓扑的问题==")]),t._v(" "),e("blockquote",[e("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241312921.png",alt:"image-20230324131213628"}}),t._v(" "),e("h5",{attrs:{id:"broadcast-storm-广播风暴"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broadcast-storm-广播风暴"}},[t._v("#")]),t._v(" Broadcast Storm 广播风暴")]),t._v(" "),e("p",[t._v("The Ethernet header doesn’t have a TTL field. These broadcast frames will loop around the network indefinitely. If enough of these looped broadcasts accumulate in the network, the network will be too congested for legitimate traffic to use the network. This is called a "),e("strong",[t._v("broadcast storm")]),t._v(".")]),t._v(" "),e("h5",{attrs:{id:"mac-address-flapping-不稳定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mac-address-flapping-不稳定"}},[t._v("#")]),t._v(" MAC Address Flapping(不稳定)")]),t._v(" "),e("p",[t._v("Network congestion isn’t the only problem. Each time a frame arrives on a switchport, the switch uses the source MAC address field to ‘learn’ the MAC address and update its MAC address table. When frames with the same source MAC address repeatedly arrive on different interfaces, the switch is continuously updating the interface in its MAC address table. This is known as "),e("strong",[t._v("MAC Address Flapping")]),t._v(".")]),t._v(" "),e("p",[t._v("In shorts, When a switch rapidly and continuously updates a MAC address in its MAC address table, alternating between different interfaces, this is known as ["),e("strong",[t._v("MAC Address Flapping")]),t._v("].")]),t._v(" "),e("h5",{attrs:{id:"多帧复制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#多帧复制"}},[t._v("#")]),t._v(" 多帧复制")]),t._v(" "),e("p",[t._v("End-hosts would receive so many copied frame")])]),t._v(" "),e("p",[t._v("由此, STP协议默认是开启的, 因为一旦存在二层环路的网络运转起来，要想找出问题的根源会超级困难!")]),t._v(" "),e("h3",{attrs:{id:"spanning-tree-terms"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spanning-tree-terms"}},[t._v("#")]),t._v(" Spanning Tree Terms")]),t._v(" "),e("h4",{attrs:{id:"bpdu"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bpdu"}},[t._v("#")]),t._v(" BPDU")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("Classic STP (not Cisco’s PVST+) uses a destination MAC address of "),e("code",[t._v("0180.c200.0000")]),t._v(";")]),t._v(" "),e("li",[t._v("Cisco’s "),e("strong",[t._v("PVST+")]),t._v(" uses the "),e("strong",[t._v("destination MAC address")]),t._v(" of "),e("code",[t._v("0100.0ccc.cccd")]),t._v(" for its BPDUs.\n"),e("ul",[e("li",[e("strong",[t._v("PVST")]),t._v(" = Only support "),e("strong",[t._v("ISL")]),t._v(" trunk encapsulation;")]),t._v(" "),e("li",[e("strong",[t._v("PVST+")]),t._v(" = Supports 802.1Q;")])])]),t._v(" "),e("li",[t._v("When a switch is powered on, it assumes it is the root bridge, So all switches send BPDUs. Each switch compares the parameters in the "),e("strong",[t._v("Bridge Protocol Data Unit (BPDU)")]),t._v(" that it sends to one neighbor with the ones that it receives from other neighbors.\n"),e("ul",[e("li",[t._v("It will only give up its position if it receives a ‘superior’ BPDU (lower bridge ID).")]),t._v(" "),e("li",[e("em",[t._v("Once the topology has converged and all switches agree on the root bridge, only the root bridge sends BPDUs.")])]),t._v(" "),e("li",[t._v("Other switches in the network will forward these BPDUs only on the Designated Ports, but will not generate their own original BPDUs.")])])]),t._v(" "),e("li",[t._v("BPDU frame format: "),e("a",{attrs:{href:"https://www.ii.pwr.edu.pl/~kano/course/module4/4.1.2.5/4.1.2.5.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.ii.pwr.edu.pl/~kano/course/module4/4.1.2.5/4.1.2.5.html"),e("OutboundLink")],1)])]),t._v(" "),e("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202304030742481.png",alt:"image-20230403074208324"}}),t._v(" "),e("ul",[e("li",[e("p",[t._v("The first three fields are the")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("Protocol IDentifier")]),t._v(", which is always 0x0000 for spanning tree;")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Version")]),t._v(": set to 0 for classic STP; set to 22 for RSTP;")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("BPDU type")]),t._v(" is hexadecimal 00 for what’s called a ‘"),e("strong",[t._v("configuration BPDU")]),t._v("’.")]),t._v(" "),e("blockquote",[e("p",[t._v("There are other types of BPDUs, but we don’t need to go that in depth for the CCNA.")])])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Flags")]),t._v(": used to signal topology changes to other switches.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Root ID")]),t._v(": Bridge ID of Root Bridge of the broadcast domain.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Root path cost")]),t._v(": Root Cost to the "),e("strong",[t._v("Root Bridge")]),t._v(", 0 means "),e("strong",[t._v("Root Bridge")]),t._v(" itself;")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Bridge ID")]),t._v(":")]),t._v(" "),e("p",[t._v("= 4 bits "),e("strong",[t._v("Bridge Priority")]),t._v(" + 12 bits "),e("strong",[t._v("Extended System ID(VLAN ID)")]),t._v(" + 48 bits "),e("strong",[t._v("MAC Address")]),t._v(".")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Port ID")]),t._v(": 0x8002 can be divided and translated to decimal 128 & 2(128.2)")]),t._v(" "),e("ul",[e("li",[t._v("80 in hexadecimal is equivalent to 128, which is the default priority;")]),t._v(" "),e("li",[t._v("02 in hexadecimal is the serial number of the port itself.")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Message Age")]),t._v(": it starts at "),e("strong",[t._v("0")]),t._v(" at the root bridge and is increased by "),e("strong",[t._v("1")]),t._v(" each time it is forwarded by another switch. It is subtracted from the max age when a switch receives the BPDU, so for example if the BPDU is passed through 5 switches, when it reaches the 6th bridge it will immediately reduce its max age timer to 15, meaning each time it receives a BPDU its max age will reset to 15 instead of 20, even though the max age timer is 20.")])])]),t._v(" "),e("hr"),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Max Age")]),t._v(": defines How long(20s by default) an interface will wait after ceasing(停止) to receive Hello BDPUs to change the STP topology.\n"),e("ul",[e("li",[e("p",[t._v("If another BPDU is received before the max age timer counts down to 0, the time will reset to 20 seconds and no changes will occur.")])]),t._v(" "),e("li",[e("p",[t._v("If another BPDU is not received, the max age timer counts down to 0 and the switch will reevaluate its STP choices, including root bridge, and local root, designated, and non-designated ports.")])]),t._v(" "),e("li",[e("p",[t._v("If a non-designated port is selected to become a designated or root port, it will transition from the blocking state to the listening state (15 seconds), learning state (15 seconds), and then finally the forwarding state. So, it can take "),e("strong",[t._v("a total of 50 seconds")]),t._v(" for a blocking interface to transition to forwarding.")])])])]),t._v(" "),e("li",[e("strong",[t._v("Hello time")]),t._v(": the Hello BPDUs will be sent every 2 seconds by default;")]),t._v(" "),e("li",[e("strong",[t._v("Forward delay")]),t._v(" means the time it takes to transition a port from listening to learning mode (also from learning to forwarding mode), which is set to 15 seconds by default and can be seen in the "),e("code",[t._v("show spanning-tree")]),t._v(" output.")])]),t._v(" "),e("blockquote",[e("p",[e("em",[t._v("The STP timers on the ["),e("strong",[t._v("Root Bridge")]),t._v("] determine the timers used for all switches in the network!")])])])]),t._v(" "),e("h4",{attrs:{id:"bridge-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bridge-id"}},[t._v("#")]),t._v(" Bridge ID")]),t._v(" "),e("blockquote",[e("p",[t._v("It is determined by a combination of the "),e("strong",[t._v("Bridge Priority")]),t._v(" (32768 by default on all Cisco switches) and "),e("strong",[t._v("the MAC address")]),t._v(" of each Switchport.")]),t._v(" "),e("img",{staticStyle:{zoom:"29%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241338276.png",alt:"image-20230324133815007"}}),t._v(" "),e("h6",{attrs:{id:"详解-bridge-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#详解-bridge-id"}},[t._v("#")]),t._v(" 详解 Bridge ID")]),t._v(" "),e("img",{staticStyle:{zoom:"29%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241342149.png",alt:"image-20230324134238878"}}),t._v(" "),e("img",{staticStyle:{zoom:"30%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241345376.png",alt:"image-20230324134536110"}}),t._v(" "),e("ul",[e("li",[t._v("The "),e("strong",[t._v("bridge priority")]),t._v(" + "),e("strong",[t._v("extended system ID")]),t._v(" is a single field of the bridge ID, however the extended system ID is set and cannot be changed (because it is determined by the VLAN ID.\n"),e("ul",[e("li",[e("strong",[t._v("Therefore, the STP bridge priority can only be changed in units of 4096")]),t._v(". The valid values you can configure are: 0, 4096, 8192, 12288, 16384, 20480, 24576, 28672, 32768, 36864, 40960, 45056, 49152, 53248, 57344, or 61440.")]),t._v(" "),e("li",[t._v("The Extended System ID will then be added to this number to make the total bridge priority.")])])])])]),t._v(" "),e("h4",{attrs:{id:"roles-of-switch-in-stp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#roles-of-switch-in-stp"}},[t._v("#")]),t._v(" Roles of switch in STP")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("code",[t._v("Root bridge")]),t._v(":\n"),e("ul",[e("li",[e("strong",[t._v("The switch with the lowest Bridge ID becomes the root bridge.")])]),t._v(" "),e("li",[e("strong",[t._v("ALL ports on the root bridge are "),e("code",[t._v("Designated Port")]),t._v(" put in a forwarding state, and other switches in the topology must have a path to reach the root bridge")]),t._v(".")]),t._v(" "),e("li",[t._v("All other decisions in the network, such as which port is to be blocked and which port is to be put in forwarding mode are made from the perspective of this root bridge. Once a root bridge is elected on the network, all other bridges must make a single path to this root bridge. The port with the lowest-cost path to the root bridge is called the "),e("strong",[t._v("root port")]),t._v(".")])])]),t._v(" "),e("li",[e("code",[t._v("Non-root bridges")]),t._v(" These are all bridges that are not the root bridge. Non-root bridges exchange BPDUs with all bridges and update the STP topology database on all switches, preventing loops and providing a measure of defense against link failures.")])])]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"configure-the-root-bridge"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-root-bridge"}},[t._v("#")]),t._v(" Configure the Root Bridge:")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("SW1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 ?")]),t._v("\n priority  Set the bridge priority "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" the spanning tree\n root      Configure switch as root\n "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\nSW1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 root ?")]),t._v("\n primary    Configure this switch as primary root "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this spanning tree\n secondary  Configure switch as secondary root\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("ul",[e("li",[t._v("The "),e("code",[t._v("spanning-tree vlan VLAN_ID root primary")]),t._v(" command sets the STP priority to ["),e("strong",[t._v("24576")]),t._v("], or ["),e("strong",[t._v("4096 less than the current root's priority")]),t._v("} "),e("code",[t._v("at one time")]),t._v(".")]),t._v(" "),e("li",[t._v("The "),e("code",[t._v("spanning-tree vlan VLAN_ID root secondary")]),t._v(" command sets the STP priority to a "),e("em",[t._v("fixed value")]),t._v(" of ["),e("strong",[t._v("28672")]),t._v("], which can let the switch with the second-lowest priority("),e("strong",[t._v("32678 by default -> "),e("code",[t._v("root primary")]),t._v(": 24576; "),e("code",[t._v("root secondary")]),t._v(": 28672")]),t._v("), which allows the switch to be next in line to become the root bridge if the current Root Bridge fails.")])])]),t._v(" "),e("h4",{attrs:{id:"port-cost-port-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-cost-port-id"}},[t._v("#")]),t._v(" Port Cost & Port ID")]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"port-cost"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-cost"}},[t._v("#")]),t._v(" "),e("code",[t._v("Port cost")])]),t._v(" "),e("ul",[e("li",[t._v("Port cost determines the best path when multiple links are used between two switches.")]),t._v(" "),e("li",[e("strong",[t._v("Root Cost")]),t._v(" = "),e("strong",[t._v("port_cost")]),t._v(" + "),e("strong",[t._v("path_cost_to_root")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Port_cost")]),t._v(" is a fixed value assigned to each port on a switch, and it is based on the speed of the port.")]),t._v(" "),e("li",[e("strong",[t._v("Path_cost_to_root")]),t._v(' is the sum of the port costs on the path from the switch to the root bridge. This value is determined by the STP algorithm and can be viewed using the "show spanning-tree" command on a Cisco switch. '),e("em",[t._v("The cost of a link is determined by the bandwidth of the link.")])])])])]),t._v(" "),e("img",{staticStyle:{zoom:"28%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303291053426.png",alt:"image-20230324141422589"}}),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303291053710.png",alt:"image-20230325060559199"}}),t._v(" "),e("blockquote",[e("p",[t._v("The ports connected to "),e("em",[t._v("another switch’s Root Port")]),t._v(" MUST be "),e("strong",[t._v("Designated Port")]),t._v(". Because the "),e("strong",[t._v("Root Port is the switch’s path to the root bridge")]),t._v(", another switch must not block it.")])]),t._v(" "),e("h5",{attrs:{id:"port-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-id"}},[t._v("#")]),t._v(" "),e("code",[t._v("Port ID")]),t._v(":")]),t._v(" "),e("p",[e("code",[t._v("= Port Priority(default 128) + Port Number")]),t._v(". Notice the column title is "),e("em",[t._v("Prio dot number")]),t._v(", So, each port has a "),e("strong",[t._v("default priority of 128")]),t._v(", and then a "),e("strong",[t._v("unique port number")]),t._v(", 1 for G0/0, 2 for G0/1, etc on this switch.")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241508858.png",alt:"image-20230324150853533"}})]),t._v(" "),e("h4",{attrs:{id:"port-roles-in-stp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-roles-in-stp"}},[t._v("#")]),t._v(" Port roles in STP")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[e("code",[t._v("Root port")]),t._v(" The root port is always the "),e("em",[t._v("interface directly connected to the root bridge")]),t._v(", or "),e("em",[t._v("the lowest path cost to the root bridge")]),t._v(". "),e("a",{attrs:{href:"#STP%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B:"}},[t._v("Click to see the whole Selection process")])]),t._v(" "),e("ul",[e("li",[t._v("Any Non-Root Bridge has only one Root Port.")])])]),t._v(" "),e("li",[e("p",[e("code",[t._v("Designated port")]),t._v(":")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("All interfaces on the root bridge are designated ports.")])])]),t._v(" "),e("li",[e("p",[t._v("A designated port is one that has been determined as "),e("strong",[t._v("having the best (lowest) cost to the root bridge via its root port")]),t._v(".")])]),t._v(" "),e("li",[e("p",[t._v("A stable designated port will be marked as a forwarding port.")])]),t._v(" "),e("li",[e("p",[t._v("After STP convergence, The switches will "),e("strong",[t._v("only forward BPDUs on their DESIGNATED PORTs")]),t._v(".")])])])])]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250107855.png",alt:"image-20230325010741565"}}),t._v(" "),e("ul",[e("li",[e("code",[t._v("Non-designated port")]),t._v(" A non-designated port is one with a higher cost than the designated port. They are what’s left over after the root ports and designated ports have been determined. Non-designated ports are put in blocking mode, they are not forwarding ports.")])])]),t._v(" "),e("h3",{attrs:{id:"versions-of-stp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#versions-of-stp"}},[t._v("#")]),t._v(" Versions of STP")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree ? ")]),t._v("\n  mode      Spanning tree operating mode  \n  portfast  Spanning tree portfast options\n  vlan      VLAN Switch Spanning Tree\n  \nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree mode ?")]),t._v("\n  mst \t\t  Multiple spanning tree mode\n  pvst\t\t  Per-VLAN spanning tree mode\n  rapid-pvst  Per-VLAN rapid spanning tree mode\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("blockquote",[e("ul",[e("li",[e("strong",[t._v("mst")]),t._v(": Multiple spanning tree (not for CCNA)")]),t._v(" "),e("li",[e("strong",[t._v("pvst")]),t._v(" is the classic spanning tree but with Cisco’s per-vlan addition;")]),t._v(" "),e("li",[e("strong",[t._v("rapid-pvst")]),t._v(": is an improved version. Modern Cisco switches run "),e("strong",[t._v("rapid-PVST by default")]),t._v(", and usually there is no reason to change it.")])])]),t._v(" "),e("h3",{attrs:{id:"stp的机制和执行过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp的机制和执行过程"}},[t._v("#")]),t._v(" STP的机制和执行过程")]),t._v(" "),e("h4",{attrs:{id:"stp机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp机制"}},[t._v("#")]),t._v(" STP机制")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("By selecting which ports are forwarding and which ports are blocking, STP creates a single path to/from each point in the network. This prevents Layer 2 loops.")])]),t._v(" "),e("li",[e("p",[e("em",[t._v("STP-enabled switches send/receive Hello BPDUs out of all interfaces, the default timer is 2 seconds")]),t._v(" (the switch will send a Hello BPDU out of every interface, once every 2 seconds).")])]),t._v(" "),e("li",[e("p",[t._v("If a switch receives a Hello BPDU on an interface, it knows that interface is connected to another switch (routers, PCs, etc. do not run STP, so they do not send Hello BPDUs).")]),t._v(" "),e("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241328145.png",alt:"image-20230324132801870"}})]),t._v(" "),e("li",[e("p",[t._v("一旦所有的交换机都同意将某台交换机选为根桥，每个网桥就必须找出属于它自己的一个并且也是唯一一个分派的根端口。任意两台交换机之间的链路必须要有一个且只能有一个指定端口，该端口位于能够提供到根桥最大带宽的链路上(lowest Root Cost)。注意，一个网桥可以通过多个其他网桥到达根桥，也就是说这一路径可能不是物理上的最短路径，但一定是最快(具有最大带宽)路径;")])]),t._v(" "),e("li",[e("p",[t._v("Every collision domain has a single STP designated port.")])]),t._v(" "),e("li",[e("p",[t._v("那些既不是根端口也不是指定端口的端口，也就是那些非根端口和非指定端口，全部被设置为阻塞状态，这样就避免了交换环路的形成。")])])])]),t._v(" "),e("h4",{attrs:{id:"stp执行过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp执行过程"}},[t._v("#")]),t._v(" STP执行过程")]),t._v(" "),e("blockquote",[e("ol",[e("li",[e("p",[t._v("All switches exchange BPDUs after power on. The switch with the "),e("strong",[t._v("lowest Bridge ID")]),t._v(" is elected as the "),e("strong",[t._v("Root Bridge")]),t._v(". "),e("strong",[t._v("All ports on the root bridge are designated ports")]),t._v("(forwarding state).")])]),t._v(" "),e("li",[e("p",[t._v("Each remaining switch will select "),e("strong",[t._v("ONE")]),t._v(" of its interfaces to be its unique "),e("strong",[t._v("Root Port")]),t._v("(also in forwarding state).")]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("Root Port selection:")])]),t._v(" "),e("ol",[e("li",[e("p",[t._v("The interface with the lowest "),e("strong",[t._v("Root Cost")]),t._v(" will be the root port.")])]),t._v(" "),e("li",[e("p",[t._v("if the Root Cost of several ports are equal, then the port with lowest "),e("strong",[t._v("neighbor Bridge ID")]),t._v(" will be Root Port.")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241440308.png",alt:"image-20230324144054077"}})]),t._v(" "),e("li",[e("p",[t._v("if two switches have two connections between them, so both the root cost and the neighbor bridge ID are the same, the interface connected to "),e("strong",[t._v("the interface on the neighbor switch with the lowest port ID")]),t._v(" will become the root port.")])])]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250527243.png",alt:"image-20230324154202907"}})])]),t._v(" "),e("li",[e("p",[t._v("Each remaining collision domain will select ONE interface to be a "),e("strong",[t._v("Designated Port")]),t._v(" (forwarding state). The other port in the collision domain will be non-designated (blocking).")]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("Designated Port selection:")])]),t._v(" "),e("ol",[e("li",[e("em",[t._v("The switch")]),t._v(" with the lowest "),e("strong",[t._v("Root Cost")]),t._v(" will make its port designated.")]),t._v(" "),e("li",[t._v("If the root cost is the same, "),e("em",[t._v("the switch")]),t._v(" with the lowest "),e("strong",[t._v("Bridge ID")]),t._v(" will make its port designated.")])])])])]),t._v(" "),e("h5",{attrs:{id:"summary"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[t._v("#")]),t._v(" Summary")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241553669.png",alt:"image-20230324155324280"}}),t._v(" "),e("h5",{attrs:{id:"quiz"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quiz"}},[t._v("#")]),t._v(" Quiz")]),t._v(" "),e("h6",{attrs:{id:"quiz-1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quiz-1"}},[t._v("#")]),t._v(" Quiz 1")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241602980.png",alt:"image-20230324160225671"}}),t._v(" "),e("h6",{attrs:{id:"quiz-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quiz-2"}},[t._v("#")]),t._v(" Quiz 2")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303241612303.png",alt:"image-20230324161233056"}})]),t._v(" "),e("h3",{attrs:{id:"lab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lab"}},[t._v("#")]),t._v(" Lab")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("SW2"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#show spanning-tree ?")]),t._v("\n  active             Report on active interfaces only\n  detail             Detailed information\n  inconsistentports  Show inconsistent ports\n  interface          Spanning Tree interface status and configuration\n  summary            Summary of port states\n  vlan               VLAN Switch Spanning Trees\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\nSW2"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#show spanning-tree ")]),t._v("\nVLAN0001\n  Spanning tree enabled protocol ieee  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# it’s Cisco’s PVST, but this means it’s in ‘classic’ mode rather than than the newer rapid spanning tree")]),t._v("\n  Root ID    Priority    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("24577")]),t._v("\n             Address     00E0.F9E6.44A5\n             Cost        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cost of root path")]),t._v("\n             Port        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GigabitEthernet0/1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n             Hello Time  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" sec  Max Age "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" sec  Forward Delay "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" sec\n\n  Bridge ID  Priority    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("28673")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("priority "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("28672")]),t._v(" sys-id-ext "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n             Address     0002.16D6.D0B8\n             Hello Time  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" sec  Max Age "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" sec  Forward Delay "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" sec\n             Aging Time  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Port path cost, which means the cost of each node-to-node Link")]),t._v("\nInterface        Role Sts Cost      Prio.Nbr Type\n---------------- ---- --- --------- -------- --------------------------------\nFa0/4            Desg FWD "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.4")]),t._v("    P2p       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Desg 为 Designed Port")]),t._v("\nFa0/1            Desg FWD "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.1")]),t._v("    P2p\nFa0/2            Desg FWD "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.2")]),t._v("    P2p       \nFa0/3            Altn BLK "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.3")]),t._v("    P2p       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Altn 为 Blocking State")]),t._v("\nGi0/1            Root FWD "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.25")]),t._v("   P2p       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Root 为 Root Port")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br")])]),e("h4",{attrs:{id:"每个广播域选举一个根桥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#每个广播域选举一个根桥"}},[t._v("#")]),t._v(" 每个广播域选举一个根桥")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("具有最低的Bridge ID的交换机被选为Root Bridge")]),t._v(" "),e("li",[e("em",[t._v("all the interfaces on Root Bridge")]),t._v(" are "),e("strong",[t._v("Designated Port")]),t._v(";")])])]),t._v(" "),e("img",{staticStyle:{zoom:"40%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/image-20220622000654205.png",alt:"image-20220622000654205"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("交换机向广播域内每隔2秒互相发出一个BPDU报文;")])]),t._v(" "),e("li",[e("p",[t._v("BPDU报文中的 Bridge ID最小的被选为 Root Bridge;")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Bridge ID 由 2 Bytes的Priority 和 6 Bytes的MAC地址组成; 而默认的优先级为 32678;")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# show spanning-tree brief")]),t._v("\n                                                       Hello  Max  Fwd\n    Vlan                         Bridge ID              Time  Age  Dly  Protocol\n    ---------------- --------------------------------- -----  ---  ---  --------\n    VLAN0001         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32769")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32768")]),t._v(",   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" aabb.cc00.2000    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("  rstp        \n    VLAN0002         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32770")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32768")]),t._v(",   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" aabb.cc00.2000    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("  rstp  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里的 Bridge ID 实际上是由交换机和 VLAN ID 构成的生成树桥ID的信息， VLAN 1 被表示为VLAN0001，注意每个VLAN 都可以有不同的根桥。")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])])]),t._v(" "),e("li",[e("p",[t._v("如果两个交换机的Priority值不加以修改, 则 MAC地址将决定 哪个交换机具有最低的Bridge ID;")])]),t._v(" "),e("li",[e("p",[t._v("Priority的取值是分散的, 以 4096 为间隔递增:")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  在当前的交换机上, 设置在指定 VLAN 的生成树的 Priority值")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 priority 9182")]),t._v("\n% Bridge Priority must be "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" increments of "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(".\n% Allowed values are: \n  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("12288")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("16384")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20480")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("24576")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("28672")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32768")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("36864")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("40960")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("45056")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("49152")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("53248")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("57344")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("61440")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])])])])])])]),t._v(" "),e("blockquote",[e("p",[t._v("也可以直接设置指定交换机为根桥:")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("S1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 root ?")]),t._v("\n   primary Configure this switch as primary root "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this spanning tree\n   secondary Configure switch as secondary root\nS1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 root primary")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])]),t._v(" "),e("h4",{attrs:{id:"在所有非根桥的交换机上选择出唯一的-root-port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在所有非根桥的交换机上选择出唯一的-root-port"}},[t._v("#")]),t._v(" 在所有非根桥的交换机上选择出唯一的 Root Port")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("Root Port selection:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("到达Root Bridge的lowest root cost的交换机接口;")])]),t._v(" "),e("li",[e("p",[t._v("若Root Cost相等, 则比较"),e("code",[t._v("上一个BPDU发送者的Bridge ID")]),t._v(";")])]),t._v(" "),e("li",[e("p",[t._v("如果一致, 则比较"),e("code",[t._v("上一个BPDU发送者的Port ID")]),t._v("(包含了 "),e("em",[t._v("port priority")]),t._v("和 "),e("em",[t._v("物理口编号")]),t._v(")")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 交换机端口的 Port-priority值, 取值是离散的: 0, 64, 128, 192")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#int e0/1")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 port-priority ?")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("-19"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("  port priority "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" increments of "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])])])]),t._v(" "),e("li",[e("p",[t._v("Root Port的链路的另一端必定是 "),e("strong",[t._v("Designated Port")]),t._v(";")])])])]),t._v(" "),e("img",{staticStyle:{zoom:"47%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/image-20220622005432148.png",alt:"image-20220622005432148"}}),t._v(" "),e("h4",{attrs:{id:"在non-root-port的链路上选出一个-designated-port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在non-root-port的链路上选出一个-designated-port"}},[t._v("#")]),t._v(" 在Non-Root_Port的链路上选出一个 Designated Port")]),t._v(" "),e("blockquote",[e("ol",[e("li",[e("strong",[t._v("The switch with the lowest Root Cost")]),t._v(" will make its port designated.")]),t._v(" "),e("li",[t._v("If the root cost is the same, "),e("strong",[t._v("the switch with the lowest Bridge ID")]),t._v(" will make its port designated.")])])]),t._v(" "),e("h4",{attrs:{id:"阻塞其他端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#阻塞其他端口"}},[t._v("#")]),t._v(" 阻塞其他端口")]),t._v(" "),e("p",[t._v("Non-Designed Port为阻塞端口(Blocking state)")]),t._v(" "),e("h3",{attrs:{id:"four-port-states-of-stp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#four-port-states-of-stp"}},[t._v("#")]),t._v(" Four Port States of STP")]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"stp-convergence-收敛"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp-convergence-收敛"}},[t._v("#")]),t._v(" STP Convergence(收敛)")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Convergence occurs when all ports on bridges and switches have transitioned to either forwarding or blocking states. No data will be forwarded until convergence is complete. Yes—you read that right: When STP is converging, all host data stops transmitting!")])]),t._v(" "),e("li",[e("p",[t._v("By creating your physical switch design in a hierarchical manner, as shown in Figure, you can make your Core switch the STP root, which will then make STP convergence time nice and quick.")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/202207092051674.png",alt:"image-20220709164505688"}})]),t._v(" "),e("hr"),t._v(" "),e("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Wolfxin/MyPicGo/img/image-20220622021653187.png",alt:"image-20220622021653187"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("A forwarding interface can move directly to a blocking state (there is no worry about creating a loop by blocking an interface).")]),t._v(" "),e("li",[t._v("A blocking interface cannot move directly to forwarding state. It must go through the listening and learning states.")])])]),t._v(" "),e("h5",{attrs:{id:"blocking-stable-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#blocking-stable-state"}},[t._v("#")]),t._v(" "),e("code",[t._v("Blocking")]),t._v(": "),e("strong",[t._v("stable")]),t._v(" state")]),t._v(" "),e("ul",[e("li",[t._v("The purpose of the blocking state is to prevent loops at Layer-2 Data Link layer;")]),t._v(" "),e("li",[t._v("Only "),e("strong",[t._v("receive")]),t._v(" BPDUs, and "),e("strong",[t._v("does NOT forward")]),t._v(" regular network traffic;")]),t._v(" "),e("li",[t._v("DO NOT learn MAC address from regular traffic that arrives on the interface but just DROP it;")]),t._v(" "),e("li",[t._v("All ports are in "),e("em",[t._v("blocking state by default")]),t._v(" when the switch is powered up;")]),t._v(" "),e("li",[t._v("Non-designated ports remain stable in a Blocking state.")])]),t._v(" "),e("h5",{attrs:{id:"listening-transitional-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listening-transitional-state"}},[t._v("#")]),t._v(" "),e("code",[t._v("Listening")]),t._v(": "),e("strong",[t._v("transitional")]),t._v(" state")]),t._v(" "),e("ul",[e("li",[t._v("After the Blocking state, "),e("strong",[t._v("Only interfaces with the Designated or Root role")]),t._v(" enter the Listening state. (Non-designated ports always remain Blocking).")]),t._v(" "),e("li",[t._v("The Listening state is "),e("em",[t._v("15 seconds long by default")]),t._v(". This is determined by the "),e("strong",[t._v("Forward delay")]),t._v(" timer.")]),t._v(" "),e("li",[t._v("ONLY "),e("strong",[t._v("forwards")]),t._v(" STP BPDUs, and "),e("strong",[t._v("does NOT forward")]),t._v(" regular traffic;")]),t._v(" "),e("li",[e("strong",[t._v("DO NOT learn MAC")]),t._v(" address from regular traffic that arrives on the interface but just DROP it;")])]),t._v(" "),e("h5",{attrs:{id:"learning-transitional-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#learning-transitional-state"}},[t._v("#")]),t._v(" "),e("code",[t._v("Learning")]),t._v(": "),e("strong",[t._v("transitional")]),t._v(" state")]),t._v(" "),e("ul",[e("li",[t._v("After the Listening state, Designated or Root ports will enter the Learning state.")]),t._v(" "),e("li",[t._v("The Learning state is "),e("strong",[t._v("15 seconds long by default")]),t._v(". This is also determined by the "),e("strong",[t._v("Forward delay")]),t._v(" timer (the same timer is used for both the Listening and Learning states)")]),t._v(" "),e("li",[t._v("ONLY "),e("strong",[t._v("forwards")]),t._v(" STP BPDUs and "),e("strong",[t._v("does NOT forward")]),t._v(" regular traffic.")]),t._v(" "),e("li",[t._v("However, A port in learning state populates the MAC address table but "),e("em",[t._v("still doesn’t forward data frames")]),t._v(".")])]),t._v(" "),e("h5",{attrs:{id:"forwarding-stable-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#forwarding-stable-state"}},[t._v("#")]),t._v(" "),e("code",[t._v("Forwarding")]),t._v(": "),e("strong",[t._v("stable")]),t._v(" state")]),t._v(" "),e("ul",[e("li",[t._v("After the Learning state, "),e("em",[t._v("Root/Designated ports remain stable in a Forwarding state.")])]),t._v(" "),e("li",[t._v("A port in the Forwarding state operate as normal:")]),t._v(" "),e("li",[e("strong",[t._v("forwards")]),t._v(" BPDUs;")]),t._v(" "),e("li",[e("strong",[t._v("forwards")]),t._v(" regular network traffic;")]),t._v(" "),e("li",[t._v("learns MAC addresses;")])]),t._v(" "),e("hr"),t._v(" "),e("ul",[e("li",[e("strong",[t._v("disabled")]),t._v(" state means the interface is shutdown, doesn't play any role in STP.")])]),t._v(" "),e("h5",{attrs:{id:"summary-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#summary-2"}},[t._v("#")]),t._v(" Summary")]),t._v(" "),e("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202306280610706.png",alt:"image-20230628061031571"}})]),t._v(" "),e("h3",{attrs:{id:"交换机的端口安全"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#交换机的端口安全"}},[t._v("#")]),t._v(" 交换机的端口安全")]),t._v(" "),e("blockquote",[e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#config t")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#int f0/1")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport mode access")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security ?")]),t._v("\naging Port-security aging commands\nmac-address Secure mac address\nmaximum Max secure addresses\nviolation Security violation mode\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("ul",[e("li",[t._v("Since all Cisco’s latest switches ship with the ports in "),e("strong",[t._v("desirable mode")]),t._v(" "),e("em",[t._v("(the port desires to trunk if it senses another switch just connected)")]),t._v(", we must first change the port from desirable mode to "),e("code",[t._v("access mode")]),t._v(" or we cannot configure port security. Once that is done, we can continue on with our port-security commands.")]),t._v(" "),e("li",[t._v("You can see clearly in the preceding output that the switch port port-security command can be used with four options:")]),t._v(" "),e("li",[e("code",[t._v("switchport port-security mac-address")]),t._v(": to assign individual MAC addresses to each switch port, but if you choose to go there, you’d better have a lot of time on your hands!")]),t._v(" "),e("li",[t._v("如果需要将交换机的端口设置为，每个端口只允许接入一台主机，并且当有人破坏这一规则时，端口就会关闭，那么，完成这样的配置可以使用下列命令:")])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security maximum 1")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security violation shutdown")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("blockquote",[e("p",[t._v("一旦这种情况发生，只能在交换机上手工使用"),e("code",[t._v("no shutdown")]),t._v("命令来恢复端口的启用。")])]),t._v(" "),e("ul",[e("li",[t._v('接入"stick" 端口的前两个地址被认定为静态地址，并且不管在aging命令中设置了多长时间，它们一直会是静态地址。为什么这里要将它设置为2 呢?这是因为其中一个地址将用于PC机，而另一个用于电话机。')])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security maximum 2")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security mac-address sticky")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#switchport port-security violation shutdown")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])])]),t._v(" "),e("h3",{attrs:{id:"stp-optional-features-toolkit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stp-optional-features-toolkit"}},[t._v("#")]),t._v(" STP Optional Features(Toolkit)")]),t._v(" "),e("h4",{attrs:{id:"portfast"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#portfast"}},[t._v("#")]),t._v(" Portfast")]),t._v(" "),e("blockquote",[e("p",[t._v("在交换机端口上，从"),e("code",[t._v("Blocking状态")]),t._v("到"),e("code",[t._v("Forwarding状态")]),t._v("的Classic STP 拓扑的收敛时间通常需要"),e("strong",[t._v("50秒")]),t._v("(20s的Max Age + 30s state-changing from Blocking to Forwarding(Listening -15s-> Learing -15s-> Forwarding))，这样在服务器或主机上就会引发超时的问题，比如，在重启交换机的时候。")]),t._v(" "),e("ul",[e("li",[t._v("针对这样的问题，可以在Access Layer交换机的"),e("strong",[t._v("Access端口(connected to End Hosts)"),e("strong",[t._v("上开启"),e("code",[t._v("Portfast")]),t._v("来")]),t._v("禁用STP协议")]),t._v("。 在端口上开启此功能之后,插入终端设备可以bypass "),e("em",[t._v("Listening")]),t._v("和"),e("em",[t._v("Learning")]),t._v(" 阶段, 只需要 1s 左右就可以从 Blocking 直接进入 Forwarding state.")]),t._v(" "),e("li",[t._v("You can still configure portfast on a trunk port, it just won’t take effect.")]),t._v(" "),e("li",[t._v("However, if another switch is connected to the interface within Portfast mode of one switch, it still can cause Broadcast Storm and other problems. -> "),e("code",[t._v("BPDU Guard")])])])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置所有的Access接口为 Portfast")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree portfast ? ")]),t._v("\n  bpduguard  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enable portfast bpdu guard on this switch")]),t._v("\n  default    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enable portfast by default on all access ports")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree portfast default")]),t._v("\n  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置指定接口为 portfast")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#int range fastEthernet 0/1 - 12")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree portfast ?")]),t._v("\n    disable Disable portfast "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this interface\n    trunk Enable portfast on the interface even "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" trunk mode\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if-range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree portfast")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("h4",{attrs:{id:"safeguard"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#safeguard"}},[t._v("#")]),t._v(" SafeGuard")]),t._v(" "),e("p",[t._v("Two kinds of SafeGuard working with Portfast")]),t._v(" "),e("h6",{attrs:{id:"bpdu-guard"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bpdu-guard"}},[t._v("#")]),t._v(" BPDU guard")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#You can also enable BPDU Guard with the following command: ")]),t._v("\nSW3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree portfast ?")]),t._v("\n  bpduguard  Enable portfast bpdu guard on this switch\n  default    Enable portfast by default on all access ports\nSW1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# spanning-tree portfast bpduguard default   ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This enables BPDU Guard on all Portfast-enabled interfaces.")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在指定接口上开启 BPDU Guard")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#int f0/3")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree bpduguard ?")]),t._v("\n\tdisable  Disable BPDU guard "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this interface\n\t"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("   Enable BPDU guard "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this interface\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree bpduguard enable")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("blockquote",[e("p",[t._v("If an interface with BPDU Guard enabled receives a BPDU from another switch, the interface will be shut down to prevent a loop from forming. 当交换机的Portfast接口开启 BPDUguard 后, 当此接口插入交换机(接收到BPDU报文)就会变成``err-disable`状态.")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250231151.png",alt:"image-20230325023132938"}}),t._v(" "),e("h6",{attrs:{id:"how-to-reactive-the-port-after-remove-the-connection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-reactive-the-port-after-remove-the-connection"}},[t._v("#")]),t._v(" How to reactive the port after remove the connection?")]),t._v(" "),e("p",[e("code",[t._v("shutdown")]),t._v(" the interface, and then "),e("code",[t._v("no shutdown")]),t._v(":")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250233455.png",alt:"image-20230325023316288"}})]),t._v(" "),e("h6",{attrs:{id:"bpdu-filter"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bpdu-filter"}},[t._v("#")]),t._v(" BPDU Filter")]),t._v(" "),e("blockquote",[e("p",[t._v("当access layer的交换机的指定接口开启 bpdufilter 之后, 如果BPDU Filter 接收到了一个BPDU ，它会立即关闭端口的PortFast，并迫使端口重新成为STP拓扑的一部分.")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree bpdufilter ?")]),t._v("\n \tdisable  Disable BPDU filtering "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this interface\n \t"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("   Enable BPDU filtering "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this interface\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])])]),t._v(" "),e("h4",{attrs:{id:"root-loop-guard"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#root-loop-guard"}},[t._v("#")]),t._v(" Root & Loop Guard")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250238835.png",alt:"image-20230325023832577"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[e("strong",[t._v("Root Guard")]),t._v(": helps maintain the spanning tree topology if someone plugs another switch into the network either with bad intent, or perhaps without knowing the impact of their action.")]),t._v(" "),e("li",[e("strong",[t._v("Loop Guard")]),t._v(": This prevents loops that can happen if an interface fails only in one direction, causing what is called a ‘unidirectional link’ that can’t receive data, but is still able to forward it, or the opposite.")])])]),t._v(" "),e("hr"),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("UplinkFast and BackboneFast are two optional features in classic STP. They must be configured to operate on the switch (not necessary to know for CCNA).")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Both features are built into RSTP")]),t._v(", so you do not have to configure them. They operate by default.")])]),t._v(" "),e("li",[e("p",[t._v("You do not need to have a detailed understanding of them for the CCNA. Know their names and their basic purpose ("),e("em",[t._v("to help blocking/discarding ports rapidly move to forwarding")]),t._v(").")])]),t._v(" "),e("li",[e("p",[t._v("If you want to learn more, do a Google search for ‘spanning tree uplinkfast’ or ‘spanning tree backbonefast’.")])])])]),t._v(" "),e("h4",{attrs:{id:"uplinkfast"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#uplinkfast"}},[t._v("#")]),t._v(" UplinkFast")]),t._v(" "),e("blockquote",[e("p",[t._v("UplinkFast 是思科产品特有的特性，两个交换机之间有多条直连物理链路, 当主链路失效时, 在备份链路的阻塞端口可以立即工作, 就不必再等待通常STP收敛所需要的50秒的时间。")]),t._v(" "),e("ul",[e("li",[t._v("only configured on "),e("em",[t._v("Access layer switches")]),t._v(" or "),e("em",[t._v("switches with redundant links and at least one link in blocking state")]),t._v(";")]),t._v(" "),e("li",[t._v("used to determine and quickly fix link failures on the local switch")])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("S2"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#config t")]),t._v("\nS2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree uplinkfast")]),t._v("\nS1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#do show spanning-tree uplinkfast")]),t._v("\nUplinkFast is enabled\nStation update rate "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" to "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("150")]),t._v(" packets/sec.\nUplinkFast statistics\n-----------------------\nNumber of transitions via uplinkFast "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nNumber of proxy multicast addresses transmitted "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\nName Interface List\n-------------------- ------------------------------------\nVLAN0001 Fa0/1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fwd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", Fa0/2\nS1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])])]),t._v(" "),e("h4",{attrs:{id:"backbonefast"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#backbonefast"}},[t._v("#")]),t._v(" BackboneFast")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("Another Cisco-proprietary STP extension called BackboneFast\n"),e("ul",[e("li",[t._v("used for speeding up convergence when a link "),e("em",[t._v("that’s not directly connected to the switch")]),t._v(" fails. If a switch running BackboneFast receives an "),e("strong",[t._v("inferior BPDU")]),t._v(" from its designated bridge, it knows that a link on that switch to the Root Bridge has failed.")])])]),t._v(" "),e("li",[t._v("BackboneFast should be enabled on "),e("strong",[t._v("all Catalyst switches")]),t._v(" to allow for detection of indirect link failures.")]),t._v(" "),e("li",[t._v("Enabling BackboneFast is also beneficial because it starts the spanning tree reconfiguration more quickly — it can save 20 seconds on the default 50-seconds STP convergence time.")])])]),t._v(" "),e("h5",{attrs:{id:"机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#机制"}},[t._v("#")]),t._v(" 机制:")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290836597.png",alt:"image-20230329083602398"}}),t._v(" "),e("blockquote",[e("ol",[e("li",[t._v("Let’s say SW2’s root port is cut off, so it stops receiving BPDUs from the Root Bridge SW1;")]),t._v(" "),e("li",[t._v("SW2 will then assume it is the root bridge, so it will send it’s own BPDUs to SW3;")]),t._v(" "),e("li",[t._v("However, SW3 is now receiving BPDUs from both SW1 and SW2, but SW2’s BPDUs are "),e("strong",[t._v("inferior")]),t._v(", they have a higher bridge ID than SW3's.\n"),e("ul",[e("li",[t._v("Without this backbonefast functionality, SW3 would just ignore these BPDUs from SW2 until its non-designated port, in classic STP, finally changes to a forwarding state and forwards the superior BPDUs to SW2, which then accepts SW1 as its root bridge again.")])])]),t._v(" "),e("li",[t._v("However, BackboneFast allows SW3 to expire the max age timer on that interface and rapidly forward the superior BPDUs to SW2.")])])]),t._v(" "),e("h5",{attrs:{id:"configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[t._v("#")]),t._v(" Configuration:")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("默认情况下， BackboneFast 会将默认优先级提高到49152。")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("S1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree backbonefast")]),t._v("\nS2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree backbonefast")]),t._v("\nCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree backbonefast")]),t._v("\nS2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#do show spanning-tree backbonefast")]),t._v("\n   BackboneFast is enabled\n    BackboneFast statistics\n    -----------------------\n    Number of transition via backboneFast "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    Number of inferior BPDUs received "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    Number of RLQ request PDUs received "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    Number of RLQ response PDUs received "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    Number of RLQ request PDUs sent "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    Number of RLQ response PDUs sent "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("all VLANs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nS2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])])])]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("与配置UplinkFast不同，对网络中的所有交换机都进行BackboneFast配置，而不只限于接入层交换机。")])]),t._v(" "),e("li",[e("p",[t._v("记住，BackboneFast 用来确定neighbor switch与Root Bridge的链路失效，这与UplinkFast不同，")])]),t._v(" "),e("li",[e("p",[t._v("UplinkFast可以确定并快速修复本地交换机的链路失效。")])])])])]),t._v(" "),e("h3",{attrs:{id:"pvst-load-balancing"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pvst-load-balancing"}},[t._v("#")]),t._v(" PVST Load-Balancing")]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("If you have multiple VLANs in your network, blocking the same interface in each VLAN is a waste of interface bandwidth.")]),t._v(" "),e("li",[t._v("However, if you configure a different root bridge for different VLANs, different VLANs will disable different interfaces.")])])]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250320806.png",alt:"image-20230325032037567"}}),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# spanning-tree vlan 10 root primary")]),t._v("\nSwitch1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# spanning-tree vlan 20 root secondary")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303250321987.png",alt:"image-20230325032103750"}}),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# spanning-tree vlan 20 root primary")]),t._v("\nSwitch2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# spanning-tree vlan 10 root secondary")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h3",{attrs:{id:"configure-stp-port-settings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configure-stp-port-settings"}},[t._v("#")]),t._v(" Configure STP Port Settings")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("SW1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree ?")]),t._v("\n  bpduguard  Don"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'t accept BPDUs on this interface\n  cost       Change an interface'")]),t._v("s spanning tree port path cost\n  guard      Change an interface"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s spanning tree guard mode\n  link-type  Specify a link type for spanning tree protocol use\n  portfast   Enable an interface to move directly to forwarding on link up\n  vlan       VLAN Switch Spanning Tree\n  \nSW1(config-if)#spanning-tree vlan 1 ?\n  cost           Change an interface'")]),t._v("s spanning tree port path cost\n  port-priority  Change an interface"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s spanning tree port priority\n\nSW1(config-if)#spanning-tree vlan 1 cost ?\n  <1-200000000>  Change an interface'")]),t._v("s per VLAN spanning tree path cost\n\nSW1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree vlan 1 port-priority ?")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("-24"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v("  port priority "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" increments of "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br")])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"rstp-802-1w-rapid-pvst"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rstp-802-1w-rapid-pvst"}},[t._v("#")]),t._v(" RSTP(802.1W) & rapid-PVST+")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("RSTP (Rapid Spanning Tree Protocol) "),e("strong",[t._v("802.1w")])])]),t._v(" "),e("li",[e("p",[t._v("More specifically, we’ll be looking at Cisco’s version, "),e("strong",[t._v("rapid-pvst+")]),t._v(".")])]),t._v(" "),e("li",[e("p",[t._v('思科创建了PortFast 、UplinkFast 和BackboneFast 来"修补" IEEE 802.1d 标准中的漏洞和缺陷。但这些改进特性的不足之处在于，它们都是思科专用的，还需要进行额外的配置。')])]),t._v(" "),e("li",[e("p",[t._v("但新的802.1w 标准(RSTP) 将所有这些功能都集成了，你需要做的就只是打开RSTP. 有一点很重要，即必须确保网络中所有的交换机都能正确地运行 "),e("em",[t._v("RSTP(802.1w)")]),t._v(" 协议。")])]),t._v(" "),e("li",[e("p",[t._v("Rapid STP is compatible with Classic STP. The interface(s) on the RSTP-enabled switch connected to the Classic STP-enabled switch will operate in Classic STP mode (timers, blocking — listening = learning — forwarding process, etc).")]),t._v(" "),e("blockquote",[e("img",{staticStyle:{zoom:"43%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290926146.png",alt:"image-20230329092620975"}}),t._v(" "),e("ul",[e("li",[t._v("In the network diagram, if SW4 was running classic STP,\n"),e("ul",[e("li",[t._v("SW2 and SW3 would make these interfaces run in classic STP mode;")]),t._v(" "),e("li",[t._v("but their interfaces connected to SW1 would remain in rapid STP mode.")])])])])])])])]),t._v(" "),e("blockquote",[e("h5",{attrs:{id:"summary-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#summary-3"}},[t._v("#")]),t._v(" Summary:")]),t._v(" "),e("ul",[e("li",[t._v("RSTP is "),e("strong",[t._v("not a timer-based")]),t._v(" spanning tree algorithm like 802.1D. Therefore, RSTP offers an improvement over the 30 seconds or more that 802.1D takes to move a link to forwarding.")]),t._v(" "),e("li",[t._v("The heart of the protocol is a new bridge-bridge handshake mechanism, which "),e("em",[t._v("allows switches to actively negotiate with other switches")]),t._v(" and move ports "),e("strong",[t._v("immediately")]),t._v(" to the forwarding state if appropriate.")]),t._v(" "),e("li",[t._v("Cisco has said that RSTP isn’t a ‘revolution’ of STP, just an ‘evolution’. It made some major improvements to speed up STP, but it didn’t change it completely.\n"),e("ul",[e("li",[t._v("To accommodate for faster speeds, RSTP’s "),e("strong",[t._v("Cost")]),t._v(" values were expanded.")]),t._v(" "),e("li",[t._v("RSTP simplifies the port states "),e("strong",[t._v("from 5 states to 3 states")]),t._v("😦"),e("strong",[t._v("Discarding, Learning, Forwarding")]),t._v(")")]),t._v(" "),e("li",[t._v("Port Roles remain the "),e("strong",[t._v("almost same")]),t._v(" as STP ("),e("strong",[t._v("Root, Designated, Alternate, Backup")]),t._v(")")]),t._v(" "),e("li",[t._v("BPDUs: In RSTP, all switches originate and send their own BPDUs(with a different format with STP) from their Designated Ports.")]),t._v(" "),e("li",[t._v("RSTP Link Types: "),e("em",[t._v("Edge, P2P, Shared")])])])])])]),t._v(" "),e("h3",{attrs:{id:"cost-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cost-2"}},[t._v("#")]),t._v(" Cost:")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290800579.png",alt:"image-20230329080003359"}}),t._v(" "),e("h3",{attrs:{id:"port-states-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-states-2"}},[t._v("#")]),t._v(" Port states:")]),t._v(" "),e("img",{staticStyle:{zoom:"65%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202306280610706.png",alt:"image-20230628061031571"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("the "),e("strong",[t._v("Blocking")]),t._v(" and "),e("strong",[t._v("Disabled")]),t._v(" port states were combined into "),e("strong",[t._v("Discarding")]),t._v(" state;")]),t._v(" "),e("li",[t._v("the "),e("strong",[t._v("Listening")]),t._v(" state is simply not used.")])])]),t._v(" "),e("img",{staticStyle:{zoom:"28%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290811198.png",alt:"image-20230329081136856"}}),t._v(" "),e("blockquote",[e("p",[t._v("However, the Discarding state is also shown as "),e("strong",[t._v("BLK")]),t._v(" (Bloking state) in Cisco IOS:")]),t._v(" "),e("img",{staticStyle:{zoom:"43%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290921315.png",alt:"image-20230329092136059"}})]),t._v(" "),e("h3",{attrs:{id:"port-roles-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-roles-2"}},[t._v("#")]),t._v(" Port Roles:")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("The "),e("strong",[t._v("Root Port")]),t._v(" role remains "),e("em",[t._v("unchanged")]),t._v(" in RSTP.")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("The port with the lowest "),e("strong",[t._v("Root Cost")]),t._v(" to the root bridge becomes the root port for the Non-Root switch.")])]),t._v(" "),e("li",[e("p",[t._v("The "),e("em",[t._v("Root Bridge")]),t._v(" is the only switch that doesn’t have a Root Port.")])])])]),t._v(" "),e("li",[e("p",[t._v("The "),e("strong",[t._v("Designated Port")]),t._v(" role remains "),e("em",[t._v("unchanged")]),t._v(" in RSTP.")]),t._v(" "),e("ul",[e("li",[t._v("The port on a segment (collision domain) that sends the best BPDU is that segment’s designated port (only one per segment);")]),t._v(" "),e("li",[t._v("All the ports of the root bridge are "),e("strong",[t._v("Designated Port")]),t._v("s.")])])]),t._v(" "),e("li",[e("p",[t._v("The "),e("strong",[t._v("Non-designated port")]),t._v(" role is split into two separate roles in RSTP:")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("Alternate Port")]),t._v(" role:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("is a "),e("strong",[t._v("Discarding port")]),t._v(" that "),e("em",[t._v("receives a superior BPDU from another switch")]),t._v(";")])]),t._v(" "),e("li",[e("p",[t._v("same as what you’ve learned about "),e("strong",[t._v("Blocking")]),t._v(" ports in classic STP.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("functions as a backup to the root port.")]),t._v(" If the root port fails, the switch can immediately move its best Alternate port to forwarding.")]),t._v(" "),e("blockquote",[e("p",[t._v("This immediate move to forwarding state functions like a classic STP optional feature called "),e("strong",[t._v("UplinkFast")]),t._v(". Because it is built into RSTP, you do not need to activate UplinkFast when using RSTP/Rapid PVST+.")])])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Backup Port")]),t._v(" role")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("function as a backup for its one designated port. If SW2’s designated port fails, its backup port immediately begins forwarding traffic as a designated port.")])]),t._v(" "),e("li",[e("p",[t._v("The interface with the "),e("em",[t._v("lowest Port ID")]),t._v(" will be selected as the designated port, and the other will be the backup port.")])]),t._v(" "),e("li",[e("p",[t._v("is a discarding port that receives a superior BPDU from another interface on the same switch. This only happens when two interfaces are connected to the same collision domain, via a hub. However, I’ve already told you that hubs are not used in modern networks, so you will probably not encounter an RSTP backup port.")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290858354.png",alt:"image-20230329085846156"}}),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290903261.png",alt:"image-20230329090305045"}})])])])])])])]),t._v(" "),e("h3",{attrs:{id:"bpdus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bpdus"}},[t._v("#")]),t._v(" BPDUs")]),t._v(" "),e("h4",{attrs:{id:"major-difference"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#major-difference"}},[t._v("#")]),t._v(" Major Difference")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("In classic STP, only the root bridge originated BPDUs, and other switches just forwarded the BPDUs they received.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("In Rapid-STP, ALL switches originate and send their own BPDUs from their designated ports!")])])])])]),t._v(" "),e("h4",{attrs:{id:"bpdu-format"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bpdu-format"}},[t._v("#")]),t._v(" BPDU format")]),t._v(" "),e("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290929858.png",alt:"image-20230329092944367"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[t._v("classic STP has a Protocol Version Identifier of "),e("strong",[t._v("0")]),t._v(", whereas RSTP BPDU has a protocol version of "),e("strong",[t._v("2")]),t._v(";")])]),t._v(" "),e("li",[e("p",[t._v("classic STP has a BPDU type of 0, whereas the rapid STP BPDU also has a BPDU type of 2;")])]),t._v(" "),e("li",[e("p",[t._v("The classic STP BPDU uses only 2 bits of the BPDU flags, the "),e("em",[t._v("1st bit and the 8th bit")]),t._v(";  the rapid STP BPDU uses all 8 bits. These flags are used in the negotiation process that allows rapid STP to converge much faster.")])]),t._v(" "),e("li",[e("p",[t._v("All switches running Rapid STP send "),e("strong",[t._v("their own")]),t._v(" BPDUs every hello time ("),e("em",[t._v("2 seconds")]),t._v(").")])]),t._v(" "),e("li",[e("p",[t._v("Switches ‘age’ the BPDU information much more quickly. In classic STP, a switch waits 10 hello intervals (20 seconds). In rapid STP, a switch considers a neighbor lost if it misses 3 BPDUs (6 seconds). It will then "),e("code",[t._v("flush(delete)")]),t._v(" all MAC addresses learned "),e("em",[t._v("on that interface")]),t._v(".")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303290953833.png",alt:"image-20230329095358592"}}),t._v(" "),e("blockquote",[e("p",[t._v("If you want to go on to get your CCNP and CCIE, you’ll definitely have to study these processes more in depth.")])])])])]),t._v(" "),e("h3",{attrs:{id:"rstp-link-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rstp-link-types"}},[t._v("#")]),t._v(" RSTP Link Types")]),t._v(" "),e("p",[t._v("RSTP distinguishes between 3 different ‘link types’.")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("Edge")]),t._v(": a port that is connected to an end host. Moves directly to forwarding, without negotiation.(Same as Portfast in STP)")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Point-to-point")]),t._v(": a direct connection "),e("em",[t._v("operates in Full-duplex")]),t._v(" between two switches.")]),t._v(" "),e("blockquote",[e("p",[t._v("You don’t need to configure the interface as point-to-point, the switch should be able to detect that it is connected directly to another switch and will operate in full-duplex as a point-to-point port. However, if you want to explicitly configure the point-to-point link type, use this command:")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("SW3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree link-type ?")]),t._v("\n  point-to-point  Consider the interface as point-to-point\n  shared          Consider the interface as shared\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Shared")]),t._v(": a connection to a hub. Must "),e("em",[t._v("operate in half-duplex mode")]),t._v(".")])])]),t._v(" "),e("h5",{attrs:{id:"quiz-1-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quiz-1-2"}},[t._v("#")]),t._v(" Quiz 1:")]),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303291018561.png",alt:"image-20230329101826252"}}),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("Although "),e("code",[t._v("edge")]),t._v(" is a link type in RSTP, you don’t use the spanning-tree link-type command to configure it, and the command doesn’t even include the word "),e("strong",[t._v("edge")]),t._v(".")]),t._v(" "),e("li",[t._v("To configure an RSTP edge port, simply configure portfast on the interface with the command "),e("code",[t._v("spanning-tree portfast")])])])]),t._v(" "),e("h5",{attrs:{id:"quiz-2-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quiz-2-2"}},[t._v("#")]),t._v(" Quiz 2:")]),t._v(" "),e("img",{staticStyle:{zoom:"37%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303291023203.png",alt:"image-20230329102311880"}}),t._v(" "),e("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Jonas-Wolfxin/MyPicgo/img/202303291022727.png",alt:"image-20230329102237449"}}),t._v(" "),e("h3",{attrs:{id:"configuration-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration-2"}},[t._v("#")]),t._v(" Configuration")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Core"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#config t")]),t._v("\nCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree mode ?")]),t._v("\n    mst \tMultiple spanning tree mode\n    pvst \tPer-Vlan spanning tree mode\n    rapid-pvst \tPer-Vlan rapid spanning tree mode\nCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#spanning-tree mode rapid-pvst")]),t._v("\nCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n    1d02h: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1,\n    changed state to down\n    1d02h: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1,\n    changed state to up\n\nCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#do show spanning-tree")]),t._v("\nVLAN0001\n Spanning tree enabled protocol rstp  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rapid-pvst+")]),t._v("\n Root ID Priority "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32769")]),t._v("\n        Address 000d.29bd.4b80\n        This bridge is the root\n        Hello Time "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" sec Max Age "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" sec Forward Delay "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" sec\n    Bridge ID Priority "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32769")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("priority "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32768")]),t._v(" sys-id-ext "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        Address 000d.29bd.4b80\n        Hello Time "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" sec Max Age "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" sec Forward Delay "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" sec\n        Aging Time "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("\n\n    Interface  Role Sts  Cost Prio.Nbr  Type\n    ---------------- ---- --- --------- -------- ------------\n    Fa0/5   Desg FWD  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.5")]),t._v("   P2p Peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Fa0/6   Desg FWD  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.6")]),t._v("   P2p Peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Fa0/7   Desg FWD  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.7")]),t._v("   P2p Peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Fa0/8   Desg FWD  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128.8")]),t._v("   P2p Peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br")])]),e("h2",{attrs:{id:"验证思科交换机的配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#验证思科交换机的配置"}},[t._v("#")]),t._v(" 验证思科交换机的配置")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("show running-config   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 路由器或者交换机上都可以使用, 可以了解整个设备的运行配置")]),t._v("\nshow mac address-table  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 显示转发过滤表")]),t._v("\nshow spanning-tree  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以了解到根桥的MAC地址，以及每个VLAN所设置的优先级。")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#show spanning-tree ?    ")]),t._v("\n  WORD               bridge group list, example "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1,3")]),t._v("-5,7,9\n  active             Report on active interfaces only\n  backbonefast       Show spanning tree backbonefast status\n  blockedports       Show blocked ports\n  bridge             Status and configuration of this bridge\n  detail             Detailed information\n  inconsistentports  Show inconsistent ports\n  interface          Spanning Tree interface status and configuration\n  mst                Multiple spanning trees\n  pathcost           Show Spanning pathcost options\n  root               Status and configuration of the root bridge\n  summary            Summary of port states\n  uplinkfast         Show spanning tree uplinkfast status\n  vlan               VLAN Switch Spanning Trees\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("                  Output modifiers\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#show spanning-tree summary ")]),t._v("\n    Switch is "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" rapid-pvst mode\n    Root bridge for: VLAN0001-VLAN0005\n    Extended system ID                      is enabled\n    Portfast Default                        is disabled\n    Portfast Edge BPDU Guard Default        is disabled\n    Portfast Edge BPDU Filter Default       is disabled\n    Loopguard Default                       is disabled\n    PVST Simulation Default                 is enabled but inactive "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" rapid-pvst mode\n    Bridge Assurance                        is enabled\n    EtherChannel misconfig guard            is enabled\n    Configured Pathcost method used is short\n    UplinkFast                              is disabled\n    BackboneFast                            is disabled\n\n    Name                   Blocking Listening Learning Forwarding STP Active\n    ---------------------- -------- --------- -------- ---------- ----------\n    VLAN0001                     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n    VLAN0002                     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    VLAN0003                     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    VLAN0004                     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    VLAN0005                     "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置静态的MAC地址条目")]),t._v("\nS1"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#config t")]),t._v("\nS1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#mac-address-table static aaaa.bbbb.cccc vlan 1 int fa0/5")]),t._v("\nS1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#do show mac address-table")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("blockquote",[e("p",[t._v("如果需要在局域网外部对交换机进行管理, 则应该在交换机上设置网关, 就像在主机上完成的默认网关设置一样:")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("Switch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ip default-gateway 192.168.10.254")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#int vlan 1")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ip address 192.168.10.252 255.255.255.0")]),t._v("\nSwitch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config-if"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#no shut")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])]),t._v(" "),e("hr")])}),[],!1,null,null,null);s.default=n.exports}}]);